function lamejs(){function a(a){return new Int8Array(a)}function b(a){return new Int16Array(a)}function c(a){return new Int32Array(a)}function d(a){return new Float32Array(a)}function e(a){return new Float64Array(a)}function f(a){if(1==a.length)return d(a[0]);var b=a[0];a=a.slice(1);for(var c=[],e=0;e<b;e++)c.push(f(a));return c}function g(a){if(1==a.length)return c(a[0]);var b=a[0];a=a.slice(1);for(var d=[],e=0;e<b;e++)d.push(g(a));return d}function h(a){if(1==a.length)return b(a[0]);var c=a[0];a=a.slice(1);for(var d=[],e=0;e<c;e++)d.push(h(a));return d}function i(a){if(1==a.length)return new Array(a[0]);var b=a[0];a=a.slice(1);for(var c=[],d=0;d<b;d++)c.push(i(a));return c}function m(a){this.ordinal=a}function o(a){this.ordinal=a}function r(a){var b=a;this.ordinal=function(){return b}}function s(){var a="http://www.mp3dev.org/",b=3,c=98,d=4,e=0,f=93;this.getLameVersion=function(){return b+"."+c+"."+d},this.getLameShortVersion=function(){return b+"."+c+"."+d},this.getLameVeryShortVersion=function(){return"LAME"+b+"."+c+"r"},this.getPsyVersion=function(){return e+"."+f},this.getLameUrl=function(){return a},this.getLameOsBitness=function(){return"32bits"}}function t(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){this.vbr_q=a,this.quant_comp=b,this.quant_comp_s=c,this.expY=d,this.st_lrm=e,this.st_s=f,this.masking_adj=g,this.masking_adj_short=h,this.ath_lower=i,this.ath_curve=j,this.ath_sensitivity=k,this.interch=l,this.safejoint=m,this.sfb21mod=n,this.msfix=o}function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n){this.quant_comp=b,this.quant_comp_s=c,this.safejoint=d,this.nsmsfix=e,this.st_lrm=f,this.st_s=g,this.nsbass=h,this.scale=i,this.masking_adj=j,this.ath_lower=k,this.ath_curve=l,this.interch=m,this.sfscale=n}function f(a,b,c){var f=a.VBR==o.vbr_rh?d:e,g=a.VBR_q_frac,h=f[b],j=f[b+1],k=h;h.st_lrm=h.st_lrm+g*(j.st_lrm-h.st_lrm),h.st_s=h.st_s+g*(j.st_s-h.st_s),h.masking_adj=h.masking_adj+g*(j.masking_adj-h.masking_adj),h.masking_adj_short=h.masking_adj_short+g*(j.masking_adj_short-h.masking_adj_short),h.ath_lower=h.ath_lower+g*(j.ath_lower-h.ath_lower),h.ath_curve=h.ath_curve+g*(j.ath_curve-h.ath_curve),h.ath_sensitivity=h.ath_sensitivity+g*(j.ath_sensitivity-h.ath_sensitivity),h.interch=h.interch+g*(j.interch-h.interch),h.msfix=h.msfix+g*(j.msfix-h.msfix),i(a,k.vbr_q),0!=c?a.quant_comp=k.quant_comp:Math.abs(a.quant_comp- -1)>0||(a.quant_comp=k.quant_comp),0!=c?a.quant_comp_short=k.quant_comp_s:Math.abs(a.quant_comp_short- -1)>0||(a.quant_comp_short=k.quant_comp_s),0!=k.expY&&(a.experimentalY=0!=k.expY),0!=c?a.internal_flags.nsPsy.attackthre=k.st_lrm:Math.abs(a.internal_flags.nsPsy.attackthre- -1)>0||(a.internal_flags.nsPsy.attackthre=k.st_lrm),0!=c?a.internal_flags.nsPsy.attackthre_s=k.st_s:Math.abs(a.internal_flags.nsPsy.attackthre_s- -1)>0||(a.internal_flags.nsPsy.attackthre_s=k.st_s),0!=c?a.maskingadjust=k.masking_adj:Math.abs(a.maskingadjust-0)>0||(a.maskingadjust=k.masking_adj),0!=c?a.maskingadjust_short=k.masking_adj_short:Math.abs(a.maskingadjust_short-0)>0||(a.maskingadjust_short=k.masking_adj_short),0!=c?a.ATHlower=-k.ath_lower/10:Math.abs(10*-a.ATHlower-0)>0||(a.ATHlower=-k.ath_lower/10),0!=c?a.ATHcurve=k.ath_curve:Math.abs(a.ATHcurve- -1)>0||(a.ATHcurve=k.ath_curve),0!=c?a.athaa_sensitivity=k.ath_sensitivity:Math.abs(a.athaa_sensitivity- -1)>0||(a.athaa_sensitivity=k.ath_sensitivity),k.interch>0&&(0!=c?a.interChRatio=k.interch:Math.abs(a.interChRatio- -1)>0||(a.interChRatio=k.interch)),k.safejoint>0&&(a.exp_nspsytune=a.exp_nspsytune|k.safejoint),k.sfb21mod>0&&(a.exp_nspsytune=a.exp_nspsytune|k.sfb21mod<<20),0!=c?a.msfix=k.msfix:Math.abs(a.msfix- -1)>0||(a.msfix=k.msfix),0==c&&(a.VBR_q=b,a.VBR_q_frac=g)}function h(a,b,d){var e=b,f=c.nearestBitrateFullIndex(b);if(a.VBR=o.vbr_abr,a.VBR_mean_bitrate_kbps=e,a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320),a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.brate=a.VBR_mean_bitrate_kbps,a.VBR_mean_bitrate_kbps>320&&(a.disable_reservoir=!0),g[f].safejoint>0&&(a.exp_nspsytune=2|a.exp_nspsytune),g[f].sfscale>0&&(a.internal_flags.noise_shaping=2),Math.abs(g[f].nsbass)>0){var h=int(4*g[f].nsbass);h<0&&(h+=64),a.exp_nspsytune=a.exp_nspsytune|h<<2}return 0!=d?a.quant_comp=g[f].quant_comp:Math.abs(a.quant_comp- -1)>0||(a.quant_comp=g[f].quant_comp),0!=d?a.quant_comp_short=g[f].quant_comp_s:Math.abs(a.quant_comp_short- -1)>0||(a.quant_comp_short=g[f].quant_comp_s),0!=d?a.msfix=g[f].nsmsfix:Math.abs(a.msfix- -1)>0||(a.msfix=g[f].nsmsfix),0!=d?a.internal_flags.nsPsy.attackthre=g[f].st_lrm:Math.abs(a.internal_flags.nsPsy.attackthre- -1)>0||(a.internal_flags.nsPsy.attackthre=g[f].st_lrm),0!=d?a.internal_flags.nsPsy.attackthre_s=g[f].st_s:Math.abs(a.internal_flags.nsPsy.attackthre_s- -1)>0||(a.internal_flags.nsPsy.attackthre_s=g[f].st_s),0!=d?a.scale=g[f].scale:Math.abs(a.scale- -1)>0||(a.scale=g[f].scale),0!=d?a.maskingadjust=g[f].masking_adj:Math.abs(a.maskingadjust-0)>0||(a.maskingadjust=g[f].masking_adj),g[f].masking_adj>0?0!=d?a.maskingadjust_short=.9*g[f].masking_adj:Math.abs(a.maskingadjust_short-0)>0||(a.maskingadjust_short=.9*g[f].masking_adj):0!=d?a.maskingadjust_short=1.1*g[f].masking_adj:Math.abs(a.maskingadjust_short-0)>0||(a.maskingadjust_short=1.1*g[f].masking_adj),0!=d?a.ATHlower=-g[f].ath_lower/10:Math.abs(10*-a.ATHlower-0)>0||(a.ATHlower=-g[f].ath_lower/10),0!=d?a.ATHcurve=g[f].ath_curve:Math.abs(a.ATHcurve- -1)>0||(a.ATHcurve=g[f].ath_curve),0!=d?a.interChRatio=g[f].interch:Math.abs(a.interChRatio- -1)>0||(a.interChRatio=g[f].interch),b}function i(a,b){var c=0;return 0>b&&(c=-1,b=0),9<b&&(c=-1,b=9),a.VBR_q=b,a.VBR_q_frac=0,c}var c;this.setModules=function(a){c=a};var d=[new a(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new a(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new a(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new a(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new a(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new a(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new a(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new a(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new a(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new a(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new a(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],e=[new a(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new a(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new a(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new a(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new a(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new a(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new a(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new a(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new a(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new a(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new a(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)],g=[new b(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new b(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new b(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new b(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new b(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new b(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new b(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new b(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new b(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new b(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new b(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new b(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new b(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new b(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new b(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new b(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new b(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];this.apply_preset=function(a,b,c){switch(b){case Y.R3MIX:b=Y.V3,a.VBR=o.vbr_mtrh;break;case Y.MEDIUM:b=Y.V4,a.VBR=o.vbr_rh;break;case Y.MEDIUM_FAST:b=Y.V4,a.VBR=o.vbr_mtrh;break;case Y.STANDARD:b=Y.V2,a.VBR=o.vbr_rh;break;case Y.STANDARD_FAST:b=Y.V2,a.VBR=o.vbr_mtrh;break;case Y.EXTREME:b=Y.V0,a.VBR=o.vbr_rh;break;case Y.EXTREME_FAST:b=Y.V0,a.VBR=o.vbr_mtrh;break;case Y.INSANE:return b=320,a.preset=b,h(a,b,c),a.VBR=o.vbr_off,b}switch(a.preset=b,b){case Y.V9:return f(a,9,c),b;case Y.V8:return f(a,8,c),b;case Y.V7:return f(a,7,c),b;case Y.V6:return f(a,6,c),b;case Y.V5:return f(a,5,c),b;case Y.V4:return f(a,4,c),b;case Y.V3:return f(a,3,c),b;case Y.V2:return f(a,2,c),b;case Y.V1:return f(a,1,c),b;case Y.V0:return f(a,0,c),b}return 8<=b&&b<=320?h(a,b,c):(a.preset=0,b)}}function u(){function l(a,b,c,d,e,f){for(;0!=e--;)c[d]=1e-10+a[b+0]*f[0]-c[d-1]*f[1]+a[b-1]*f[2]-c[d-2]*f[3]+a[b-2]*f[4]-c[d-3]*f[5]+a[b-3]*f[6]-c[d-4]*f[7]+a[b-4]*f[8]-c[d-5]*f[9]+a[b-5]*f[10]-c[d-6]*f[11]+a[b-6]*f[12]-c[d-7]*f[13]+a[b-7]*f[14]-c[d-8]*f[15]+a[b-8]*f[16]-c[d-9]*f[17]+a[b-9]*f[18]-c[d-10]*f[19]+a[b-10]*f[20],++d,++b}function m(a,b,c,d,e,f){for(;0!=e--;)c[d]=a[b+0]*f[0]-c[d-1]*f[1]+a[b-1]*f[2]-c[d-2]*f[3]+a[b-2]*f[4],++d,++b}function n(a,b){for(var c=0;c<MAX_ORDER;c++)a.linprebuf[c]=a.lstepbuf[c]=a.loutbuf[c]=a.rinprebuf[c]=a.rstepbuf[c]=a.routbuf[c]=0;switch(0|b){case 48e3:a.reqindex=0;break;case 44100:a.reqindex=1;break;case 32e3:a.reqindex=2;break;case 24e3:a.reqindex=3;break;case 22050:a.reqindex=4;break;case 16e3:a.reqindex=5;break;case 12e3:a.reqindex=6;break;case 11025:a.reqindex=7;break;case 8e3:a.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return a.sampleWindow=0|(b*e+f-1)/f,a.lsum=0,a.rsum=0,a.totsamp=0,j.ill(a.A,0),INIT_GAIN_ANALYSIS_OK}function o(a){return a*a}function p(b,d){var e,f=0;for(e=0;e<d;e++)f+=b[e];if(0==f)return GAIN_NOT_ENOUGH_SAMPLES;var g=0|Math.ceil(f*(1-c));for(e=d;e-- >0&&!((g-=b[e])<=0););return a-e/u.STEPS_per_dB}var a=64.82,c=(u.YULE_ORDER,.95),e=(u.MAX_SAMP_FREQ,u.RMS_WINDOW_TIME_NUMERATOR),f=u.RMS_WINDOW_TIME_DENOMINATOR,h=(u.MAX_SAMPLES_PER_WINDOW,[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]]),i=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];this.InitGainAnalysis=function(a,b){return n(a,b)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(a.linpre=MAX_ORDER,a.rinpre=MAX_ORDER,a.lstep=MAX_ORDER,a.rstep=MAX_ORDER,a.lout=MAX_ORDER,a.rout=MAX_ORDER,j.fill(a.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(a,b,c,d,e,f,g){var j,n,p,q,r,s,t;if(0==f)return GAIN_ANALYSIS_OK;switch(t=0,r=f,g){case 1:d=b,e=c;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(f<MAX_ORDER?(k.arraycopy(b,c,a.linprebuf,MAX_ORDER,f),k.arraycopy(d,e,a.rinprebuf,MAX_ORDER,f)):(k.arraycopy(b,c,a.linprebuf,MAX_ORDER,MAX_ORDER),k.arraycopy(d,e,a.rinprebuf,MAX_ORDER,MAX_ORDER));r>0;){s=r>a.sampleWindow-a.totsamp?a.sampleWindow-a.totsamp:r,t<MAX_ORDER?(j=a.linpre+t,n=a.linprebuf,p=a.rinpre+t,q=a.rinprebuf,s>MAX_ORDER-t&&(s=MAX_ORDER-t)):(j=c+t,n=b,p=e+t,q=d),l(n,j,a.lstepbuf,a.lstep+a.totsamp,s,h[a.reqindex]),l(q,p,a.rstepbuf,a.rstep+a.totsamp,s,h[a.reqindex]),m(a.lstepbuf,a.lstep+a.totsamp,a.loutbuf,a.lout+a.totsamp,s,i[a.reqindex]),m(a.rstepbuf,a.rstep+a.totsamp,a.routbuf,a.rout+a.totsamp,s,i[a.reqindex]),j=a.lout+a.totsamp,n=a.loutbuf,p=a.rout+a.totsamp,q=a.routbuf;for(var v=s%8;0!=v--;)a.lsum+=o(n[j++]),a.rsum+=o(q[p++]);for(v=s/8;0!=v--;)a.lsum+=o(n[j+0])+o(n[j+1])+o(n[j+2])+o(n[j+3])+o(n[j+4])+o(n[j+5])+o(n[j+6])+o(n[j+7]),j+=8,a.rsum+=o(q[p+0])+o(q[p+1])+o(q[p+2])+o(q[p+3])+o(q[p+4])+o(q[p+5])+o(q[p+6])+o(q[p+7]),p+=8;if(r-=s,t+=s,a.totsamp+=s,a.totsamp==a.sampleWindow){var w=10*u.STEPS_per_dB*Math.log10((a.lsum+a.rsum)/a.totsamp*.5+1e-37),x=w<=0?0:0|w;x>=a.A.length&&(x=a.A.length-1),a.A[x]++,a.lsum=a.rsum=0,k.arraycopy(a.loutbuf,a.totsamp,a.loutbuf,0,MAX_ORDER),k.arraycopy(a.routbuf,a.totsamp,a.routbuf,0,MAX_ORDER),k.arraycopy(a.lstepbuf,a.totsamp,a.lstepbuf,0,MAX_ORDER),k.arraycopy(a.rstepbuf,a.totsamp,a.rstepbuf,0,MAX_ORDER),a.totsamp=0}if(a.totsamp>a.sampleWindow)return GAIN_ANALYSIS_ERROR}return f<MAX_ORDER?(k.arraycopy(a.linprebuf,f,a.linprebuf,0,MAX_ORDER-f),k.arraycopy(a.rinprebuf,f,a.rinprebuf,0,MAX_ORDER-f),k.arraycopy(b,c,a.linprebuf,MAX_ORDER-f,f),k.arraycopy(d,e,a.rinprebuf,MAX_ORDER-f,f)):(k.arraycopy(b,c+f-MAX_ORDER,a.linprebuf,0,MAX_ORDER),k.arraycopy(d,e+f-MAX_ORDER,a.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(a){for(var b=p(a.A,a.A.length),c=0;c<a.A.length;c++)a.B[c]+=a.A[c],a.A[c]=0;for(var c=0;c<MAX_ORDER;c++)a.linprebuf[c]=a.lstepbuf[c]=a.loutbuf[c]=a.rinprebuf[c]=a.rstepbuf[c]=a.routbuf[c]=0;return a.totsamp=0,a.lsum=a.rsum=0,b}}function v(){var a;this.setModules=function(b){a=b},this.ResvFrameBegin=function(b,c){var e,d=b.internal_flags,f=d.l3_side,g=a.getframebits(b);c.bits=(g-8*d.sideinfo_len)/d.mode_gr;var h=2048*d.mode_gr-8;b.brate>320?e=8*int(1e3*b.brate/(b.out_samplerate/1152)/8+.5):(e=11520,b.strict_ISO&&(e=8*int(32e4/(b.out_samplerate/1152)/8+.5))),d.ResvMax=e-g,d.ResvMax>h&&(d.ResvMax=h),(d.ResvMax<0||b.disable_reservoir)&&(d.ResvMax=0);var i=c.bits*d.mode_gr+Math.min(d.ResvSize,d.ResvMax);return i>e&&(i=e),f.resvDrain_pre=0,null!=d.pinfo&&(d.pinfo.mean_bits=c.bits/2,d.pinfo.resvsize=d.ResvSize),i},this.ResvMaxBits=function(a,b,c,d){var f,e=a.internal_flags,g=e.ResvSize,h=e.ResvMax;0!=d&&(g+=b),0!=(1&e.substep_shaping)&&(h*=.9),c.bits=b,10*g>9*h?(f=g-9*h/10,c.bits+=f,e.substep_shaping|=128):(f=0,e.substep_shaping&=127,a.disable_reservoir||0!=(1&e.substep_shaping)||(c.bits-=.1*b));var i=g<6*e.ResvMax/10?g:6*e.ResvMax/10;return i-=f,i<0&&(i=0),i},this.ResvAdjust=function(a,b){a.ResvSize-=b.part2_3_length+b.part2_length},this.ResvFrameEnd=function(a,b){var c,d=a.l3_side;a.ResvSize+=b*a.mode_gr;var e=0;d.resvDrain_post=0,d.resvDrain_pre=0,0!=(c=a.ResvSize%8)&&(e+=c),c=a.ResvSize-e-a.ResvMax,c>0&&(e+=c);var f=Math.min(8*d.main_data_begin,e)/8;d.resvDrain_pre+=8*f,e-=8*f,a.ResvSize-=8*f,d.main_data_begin-=f,d.resvDrain_post+=e,a.ResvSize-=e}}function w(){function b(a){this.bits=0|a}function e(a,b,c,d,e,f){var g=.5946/b;for(a>>=1;0!=a--;)e[f++]=g>c[d++]?0:1,e[f++]=g>c[d++]?0:1}function f(b,c,d,e,f,g){b>>=1;var h=b%2;for(b>>=1;0!=b--;){var i,j,k,l,m,n,o,p;i=d[e++]*c,j=d[e++]*c,m=0|i,k=d[e++]*c,n=0|j,l=d[e++]*c,o=0|k,i+=a.adj43[m],p=0|l,j+=a.adj43[n],f[g++]=0|i,k+=a.adj43[o],f[g++]=0|j,l+=a.adj43[p],f[g++]=0|k,f[g++]=0|l}if(0!=h){var i,j,m,n;i=d[e++]*c,j=d[e++]*c,m=0|i,n=0|j,i+=a.adj43[m],j+=a.adj43[n],f[g++]=0|i,f[g++]=0|j}}function g(b,c,d,g,h){var i,k,m,l=0,n=0,o=0,p=0,q=c,r=0,s=q,t=0,u=b,v=0;for(m=null!=h&&g.global_gain==h.global_gain,k=g.block_type==Q.SHORT_TYPE?38:21,i=0;i<=k;i++){var w=-1;if((m||g.block_type==Q.NORM_TYPE)&&(w=g.global_gain-(g.scalefac[i]+(0!=g.preflag?a.pretab[i]:0)<<g.scalefac_scale+1)-8*g.subblock_gain[g.window[i]]),m&&h.step[i]==w)0!=n&&(f(n,d,u,v,s,t),n=0),0!=o&&(e(o,d,u,v,s,t),o=0);else{var x=g.width[i];if(l+g.width[i]>g.max_nonzero_coeff){var y;y=g.max_nonzero_coeff-l+1,j.fill(c,g.max_nonzero_coeff,576,0),x=y,x<0&&(x=0),i=k+1}if(0==n&&0==o&&(s=q,t=r,u=b,v=p),null!=h&&h.sfb_count1>0&&i>=h.sfb_count1&&h.step[i]>0&&w>=h.step[i]?(0!=n&&(f(n,d,u,v,s,t),n=0,s=q,t=r,u=b,v=p),o+=x):(0!=o&&(e(o,d,u,v,s,t),o=0,s=q,t=r,u=b,v=p),n+=x),x<=0){0!=o&&(e(o,d,u,v,s,t),o=0),0!=n&&(f(n,d,u,v,s,t),n=0);break}}i<=k&&(r+=g.width[i],p+=g.width[i],l+=g.width[i])}0!=n&&(f(n,d,u,v,s,t),n=0),0!=o&&(e(o,d,u,v,s,t),o=0)}function h(a,b,c){var d=0,e=0;do{var f=a[b++],g=a[b++];d<f&&(d=f),e<g&&(e=g)}while(b<c);return d<e&&(d=e),d}function i(a,b,c,d,e,f){var i,g=65536*A.ht[d].xlen+A.ht[e].xlen,h=0;do{var j=a[b++],k=a[b++];0!=j&&(j>14&&(j=15,h+=g),j*=16),0!=k&&(k>14&&(k=15,h+=g),j+=k),h+=A.largetbl[j]}while(b<c);return i=65535&h,h>>=16,h>i&&(h=i,d=e),f.bits+=h,d}function l(a,b,c,d){var e=0,f=A.ht[1].hlen;do{var g=2*a[b+0]+a[b+1];b+=2,e+=f[g]}while(b<c);return d.bits+=e,1}function m(a,b,c,d,e){var g,i,f=0,h=A.ht[d].xlen;i=2==d?A.table23:A.table56;do{var j=a[b+0]*h+a[b+1];b+=2,f+=i[j]}while(b<c);return g=65535&f,f>>=16,f>g&&(f=g,d++),e.bits+=f,d}function n(a,b,c,d,e){var f=0,g=0,h=0,i=A.ht[d].xlen,j=A.ht[d].hlen,k=A.ht[d+1].hlen,l=A.ht[d+2].hlen;do{var m=a[b+0]*i+a[b+1];b+=2,f+=j[m],g+=k[m],h+=l[m]}while(b<c);var n=d;return f>g&&(f=g,n++),f>h&&(f=h,n=d+2),e.bits+=f,n}function p(a,b,c,d){var e=h(a,b,c);switch(e){case 0:return e;case 1:return l(a,b,c,d);case 2:case 3:return m(a,b,c,o[e-1],d);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return n(a,b,c,o[e-1],d);default:if(e>J.IXMAX_VAL)return d.bits=J.LARGE_BITS,-1;e-=15;var f;for(f=24;f<32&&!(A.ht[f].linmax>=e);f++);var g;for(g=f-8;g<24&&!(A.ht[g].linmax>=e);g++);return i(a,b,c,g,f,d)}}function q(a,c,d,e,f,g,h){for(var i=c.big_values,j=0;j<=22;j++)e[j]=J.LARGE_BITS;for(var j=0;j<16;j++){var k=a.scalefac_band.l[j+1];if(k>=i)break;var l=0,m=new b(l),n=p(d,0,k,m);l=m.bits;for(var o=0;o<8;o++){var q=a.scalefac_band.l[j+o+2];if(q>=i)break;var r=l;m=new b(r);var s=p(d,k,q,m);r=m.bits,e[j+o]>r&&(e[j+o]=r,f[j+o]=j,g[j+o]=n,h[j+o]=s)}}}function r(a,c,d,e,f,g,h,i){for(var j=c.big_values,k=2;k<Q.SBMAX_l+1;k++){var l=a.scalefac_band.l[k];if(l>=j)break;var m=f[k-2]+c.count1bits;if(d.part2_3_length<=m)break;var n=new b(m),o=p(e,l,j,n);m=n.bits,d.part2_3_length<=m||(d.assign(c),d.part2_3_length=m,d.region0_count=g[k-2],d.region1_count=k-2-g[k-2],d.table_select[0]=h[k-2],d.table_select[1]=i[k-2],d.table_select[2]=o)}}function x(a,b){for(var c,d=b.tt[1][a],e=b.tt[0][a],f=0;f<A.scfsi_band.length-1;f++){for(c=A.scfsi_band[f];c<A.scfsi_band[f+1]&&!(e.scalefac[c]!=d.scalefac[c]&&d.scalefac[c]>=0);c++);if(c==A.scfsi_band[f+1]){for(c=A.scfsi_band[f];c<A.scfsi_band[f+1];c++)d.scalefac[c]=-1;b.scfsi[a][f]=1}}var g=0,h=0;for(c=0;c<11;c++)d.scalefac[c]!=-1&&(h++,g<d.scalefac[c]&&(g=d.scalefac[c]));for(var i=0,j=0;c<Q.SBPSY_l;c++)d.scalefac[c]!=-1&&(j++,i<d.scalefac[c]&&(i=d.scalefac[c]));for(var f=0;f<16;f++)if(g<s[f]&&i<t[f]){var k=u[f]*h+v[f]*j;d.part2_length>k&&(d.part2_length=k,d.scalefac_compress=f)}}var a=null;this.qupvt=null,this.setModules=function(b){this.qupvt=b,a=b};var d=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]],o=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];this.noquant_count_bits=function(a,c,d){var e=c.l3_enc,f=Math.min(576,c.max_nonzero_coeff+2>>1<<1);for(null!=d&&(d.sfb_count1=0);f>1&&0==(e[f-1]|e[f-2]);f-=2);c.count1=f;for(var g=0,h=0;f>3;f-=4){var i;if((2147483647&(e[f-1]|e[f-2]|e[f-3]|e[f-4]))>1)break;i=2*(2*(2*e[f-4]+e[f-3])+e[f-2])+e[f-1],g+=A.t32l[i],h+=A.t33l[i]}var j=g;if(c.count1table_select=0,g>h&&(j=h,c.count1table_select=1),c.count1bits=j,c.big_values=f,0==f)return j;if(c.block_type==Q.SHORT_TYPE)g=3*a.scalefac_band.s[3],g>c.big_values&&(g=c.big_values),h=c.big_values;else if(c.block_type==Q.NORM_TYPE){if(g=c.region0_count=a.bv_scf[f-2],h=c.region1_count=a.bv_scf[f-1],h=a.scalefac_band.l[g+h+2],g=a.scalefac_band.l[g+1],h<f){var k=new b(j);c.table_select[2]=p(e,h,f,k),j=k.bits}}else c.region0_count=7,c.region1_count=Q.SBMAX_l-1-7-1,g=a.scalefac_band.l[8],h=f,g>h&&(g=h);if(g=Math.min(g,f),h=Math.min(h,f),0<g){var k=new b(j);c.table_select[0]=p(e,0,g,k),j=k.bits}if(g<h){var k=new b(j);c.table_select[1]=p(e,g,h,k),j=k.bits}if(2==a.use_best_huffman&&(c.part2_3_length=j,best_huffman_divide(a,c),j=c.part2_3_length),null!=d&&c.block_type==Q.NORM_TYPE){for(var l=0;a.scalefac_band.l[l]<c.big_values;)l++;d.sfb_count1=l}return j},this.count_bits=function(b,c,d,e){var f=d.l3_enc,h=J.IXMAX_VAL/a.IPOW20(d.global_gain);if(d.xrpow_max>h)return J.LARGE_BITS;if(g(c,f,a.IPOW20(d.global_gain),d,e),0!=(2&b.substep_shaping))for(var i=0,j=d.global_gain+d.scalefac_scale,k=.634521682242439/a.IPOW20(j),l=0;l<d.sfbmax;l++){var m=d.width[l];if(0==b.pseudohalf[l])i+=m;else{var n;for(n=i,i+=m;n<i;++n)f[n]=c[n]>=k?f[n]:0}}return this.noquant_count_bits(b,d,e)},this.best_huffman_divide=function(a,d){var e=new K,f=d.l3_enc,g=c(23),h=c(23),i=c(23),j=c(23);if(d.block_type!=Q.SHORT_TYPE||1!=a.mode_gr){e.assign(d),d.block_type==Q.NORM_TYPE&&(q(a,d,f,g,h,i,j),r(a,e,d,f,g,h,i,j));var k=e.big_values;if(!(0==k||(f[k-2]|f[k-1])>1||(k=d.count1+2,k>576))){e.assign(d),e.count1=k;for(var l=0,m=0;k>e.big_values;k-=4){var n=2*(2*(2*f[k-4]+f[k-3])+f[k-2])+f[k-1];l+=A.t32l[n],m+=A.t33l[n]}if(e.big_values=k,e.count1table_select=0,l>m&&(l=m,e.count1table_select=1),e.count1bits=l,e.block_type==Q.NORM_TYPE)r(a,e,d,f,g,h,i,j);else{if(e.part2_3_length=l,l=a.scalefac_band.l[8],l>k&&(l=k),l>0){var o=new b(e.part2_3_length);e.table_select[0]=p(f,0,l,o),e.part2_3_length=o.bits}if(k>l){var o=new b(e.part2_3_length);e.table_select[1]=p(f,l,k,o),e.part2_3_length=o.bits}d.part2_3_length>e.part2_3_length&&d.assign(e)}}}};var s=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],t=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],u=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],v=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];w.slen1_tab=u,w.slen2_tab=v,this.best_scalefac_store=function(b,c,d,e){var g,h,i,j,f=e.tt[c][d],k=0;for(i=0,g=0;g<f.sfbmax;g++){var l=f.width[g];for(i+=l,j=-l;j<0&&0==f.l3_enc[j+i];j++);0==j&&(f.scalefac[g]=k=-2)}if(0==f.scalefac_scale&&0==f.preflag){var m=0;for(g=0;g<f.sfbmax;g++)f.scalefac[g]>0&&(m|=f.scalefac[g]);if(0==(1&m)&&0!=m){for(g=0;g<f.sfbmax;g++)f.scalefac[g]>0&&(f.scalefac[g]>>=1);f.scalefac_scale=k=1}}if(0==f.preflag&&f.block_type!=Q.SHORT_TYPE&&2==b.mode_gr){for(g=11;g<Q.SBPSY_l&&!(f.scalefac[g]<a.pretab[g]&&f.scalefac[g]!=-2);g++);if(g==Q.SBPSY_l){for(g=11;g<Q.SBPSY_l;g++)f.scalefac[g]>0&&(f.scalefac[g]-=a.pretab[g]);f.preflag=k=1}}for(h=0;h<4;h++)e.scfsi[d][h]=0;for(2==b.mode_gr&&1==c&&e.tt[0][d].block_type!=Q.SHORT_TYPE&&e.tt[1][d].block_type!=Q.SHORT_TYPE&&(x(d,e),k=0),g=0;g<f.sfbmax;g++)f.scalefac[g]==-2&&(f.scalefac[g]=0);0!=k&&(2==b.mode_gr?this.scale_bitcount(f):this.scale_bitcount_lsf(b,f))};var z=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],B=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],C=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(b){var c,d,g,e=0,f=0,h=b.scalefac;if(b.block_type==Q.SHORT_TYPE)g=z,0!=b.mixed_block_flag&&(g=B);else if(g=C,0==b.preflag){for(d=11;d<Q.SBPSY_l&&!(h[d]<a.pretab[d]);d++);if(d==Q.SBPSY_l)for(b.preflag=1,d=11;d<Q.SBPSY_l;d++)h[d]-=a.pretab[d]}for(d=0;d<b.sfbdivide;d++)e<h[d]&&(e=h[d]);for(;d<b.sfbmax;d++)f<h[d]&&(f=h[d]);for(b.part2_length=J.LARGE_BITS,c=0;c<16;c++)e<s[c]&&f<t[c]&&b.part2_length>g[c]&&(b.part2_length=g[c],b.scalefac_compress=c);return b.part2_length==J.LARGE_BITS};var D=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(b,d){var e,f,g,h,i,j,l,m,n=c(4),o=d.scalefac;for(e=0!=d.preflag?2:0,l=0;l<4;l++)n[l]=0;if(d.block_type==Q.SHORT_TYPE){f=1;var p=a.nr_of_sfb_block[e][f];for(m=0,g=0;g<4;g++)for(h=p[g]/3,l=0;l<h;l++,m++)for(i=0;i<3;i++)o[3*m+i]>n[g]&&(n[g]=o[3*m+i])}else{f=0;var p=a.nr_of_sfb_block[e][f];for(m=0,g=0;g<4;g++)for(h=p[g],l=0;l<h;l++,m++)o[m]>n[g]&&(n[g]=o[m])}for(j=!1,g=0;g<4;g++)n[g]>D[e][g]&&(j=!0);if(!j){var q,r,s,t;for(d.sfb_partition_table=a.nr_of_sfb_block[e][f],g=0;g<4;g++)d.slen[g]=E[n[g]];switch(q=d.slen[0],r=d.slen[1],s=d.slen[2],t=d.slen[3],e){case 0:d.scalefac_compress=(5*q+r<<4)+(s<<2)+t;break;case 1:d.scalefac_compress=400+(5*q+r<<2)+s;break;case 2:d.scalefac_compress=500+3*q+r;break;default:k.err.printf("intensity stereo not implemented yet\n")}}if(!j)for(d.part2_length=0,g=0;g<4;g++)d.part2_length+=d.slen[g]*d.sfb_partition_table[g];return j};var E=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(a){for(var b=2;b<=576;b+=2){for(var e,c=0;a.scalefac_band.l[++c]<b;);for(e=d[c][0];a.scalefac_band.l[e+1]>b;)e--;for(e<0&&(e=d[c][0]),a.bv_scf[b-2]=e,e=d[c][1];a.scalefac_band.l[e+a.bv_scf[b-2]+2]>b;)e--;e<0&&(e=d[c][1]),a.bv_scf[b-1]=e}}}function x(){function q(a){k.arraycopy(a.header[a.w_ptr].buf,0,m,o,a.sideinfo_len),o+=a.sideinfo_len,n+=8*a.sideinfo_len,a.w_ptr=a.w_ptr+1&V.MAX_HEADER_BUF-1}function r(a,b,c){for(;c>0;){var d;0==p&&(p=8,o++,a.header[a.w_ptr].write_timing==n&&q(a),m[o]=0),d=Math.min(c,p),c-=d,p-=d,m[o]|=b>>c<<p,n+=d}}function s(a,b,c){for(;c>0;){var d;0==p&&(p=8,o++,m[o]=0),d=Math.min(c,p),c-=d,p-=d,m[o]|=b>>c<<p,n+=d}}function t(a,b){var d,c=a.internal_flags;if(b>=8&&(r(c,76,8),b-=8),b>=8&&(r(c,65,8),b-=8),b>=8&&(r(c,77,8),b-=8),b>=8&&(r(c,69,8),b-=8),b>=32){var e=i.getLameShortVersion();if(b>=32)for(d=0;d<e.length&&b>=8;++d)b-=8,r(c,e.charAt(d),8)}for(;b>=1;b-=1)r(c,c.ancillary_flag,1),c.ancillary_flag^=a.disable_reservoir?0:1}function v(a,b,c){for(var d=a.header[a.h_ptr].ptr;c>0;){var e=Math.min(c,8-(7&d));c-=e,a.header[a.h_ptr].buf[d>>3]|=b>>c<<8-(7&d)-e,d+=e}a.header[a.h_ptr].ptr=d}function x(a,b){a<<=8;for(var c=0;c<8;c++)a<<=1,b<<=1,0!=(65536&(b^a))&&(b^=d);return b}function y(a,b){var d,e,f,c=a.internal_flags;if(d=c.l3_side,c.header[c.h_ptr].ptr=0,j.fill(c.header[c.h_ptr].buf,0,c.sideinfo_len,0),a.out_samplerate<16e3?v(c,4094,12):v(c,4095,12),v(c,a.version,1),v(c,1,2),v(c,a.error_protection?0:1,1),v(c,c.bitrate_index,4),v(c,c.samplerate_index,2),v(c,c.padding,1),v(c,a.extension,1),v(c,a.mode.ordinal(),2),v(c,c.mode_ext,2),v(c,a.copyright,1),v(c,a.original,1),v(c,a.emphasis,2),a.error_protection&&v(c,0,16),1==a.version){for(v(c,d.main_data_begin,9),2==c.channels_out?v(c,d.private_bits,3):v(c,d.private_bits,5),f=0;f<c.channels_out;f++){var g;for(g=0;g<4;g++)v(c,d.scfsi[f][g],1)}for(e=0;e<2;e++)for(f=0;f<c.channels_out;f++){var h=d.tt[e][f];v(c,h.part2_3_length+h.part2_length,12),v(c,h.big_values/2,9),v(c,h.global_gain,8),v(c,h.scalefac_compress,4),h.block_type!=Q.NORM_TYPE?(v(c,1,1),v(c,h.block_type,2),v(c,h.mixed_block_flag,1),14==h.table_select[0]&&(h.table_select[0]=16),v(c,h.table_select[0],5),14==h.table_select[1]&&(h.table_select[1]=16),v(c,h.table_select[1],5),v(c,h.subblock_gain[0],3),v(c,h.subblock_gain[1],3),v(c,h.subblock_gain[2],3)):(v(c,0,1),14==h.table_select[0]&&(h.table_select[0]=16),v(c,h.table_select[0],5),14==h.table_select[1]&&(h.table_select[1]=16),v(c,h.table_select[1],5),14==h.table_select[2]&&(h.table_select[2]=16),v(c,h.table_select[2],5),v(c,h.region0_count,4),v(c,h.region1_count,3)),v(c,h.preflag,1),v(c,h.scalefac_scale,1),v(c,h.count1table_select,1)}}else for(v(c,d.main_data_begin,8),v(c,d.private_bits,c.channels_out),e=0,f=0;f<c.channels_out;f++){var h=d.tt[e][f];v(c,h.part2_3_length+h.part2_length,12),v(c,h.big_values/2,9),v(c,h.global_gain,8),v(c,h.scalefac_compress,9),h.block_type!=Q.NORM_TYPE?(v(c,1,1),v(c,h.block_type,2),v(c,h.mixed_block_flag,1),14==h.table_select[0]&&(h.table_select[0]=16),v(c,h.table_select[0],5),14==h.table_select[1]&&(h.table_select[1]=16),v(c,h.table_select[1],5),v(c,h.subblock_gain[0],3),v(c,h.subblock_gain[1],3),v(c,h.subblock_gain[2],3)):(v(c,0,1),14==h.table_select[0]&&(h.table_select[0]=16),v(c,h.table_select[0],5),14==h.table_select[1]&&(h.table_select[1]=16),v(c,h.table_select[1],5),14==h.table_select[2]&&(h.table_select[2]=16),v(c,h.table_select[2],5),v(c,h.region0_count,4),v(c,h.region1_count,3)),v(c,h.scalefac_scale,1),v(c,h.count1table_select,1)}a.error_protection&&CRC_writeheader(c,c.header[c.h_ptr].buf);var i=c.h_ptr;c.h_ptr=i+1&V.MAX_HEADER_BUF-1,c.header[c.h_ptr].write_timing=c.header[i].write_timing+b,c.h_ptr==c.w_ptr&&k.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}function z(a,b){var d,c=A.ht[b.count1table_select+32],e=0,f=b.big_values,g=b.big_values;for(d=(b.count1-b.big_values)/4;d>0;--d){var j,h=0,i=0;j=b.l3_enc[f+0],0!=j&&(i+=8,b.xr[g+0]<0&&h++),j=b.l3_enc[f+1],0!=j&&(i+=4,h*=2,b.xr[g+1]<0&&h++),j=b.l3_enc[f+2],0!=j&&(i+=2,h*=2,b.xr[g+2]<0&&h++),j=b.l3_enc[f+3],0!=j&&(i++,h*=2,b.xr[g+3]<0&&h++),f+=4,g+=4,r(a,h+c.table[i],c.hlen[i]),e+=c.hlen[i]}return e}function B(a,b,c,d,e){var f=A.ht[b],g=0;if(0==b)return g;for(var h=c;h<d;h+=2){var i=0,j=0,k=f.xlen,l=f.xlen,m=0,n=e.l3_enc[h],o=e.l3_enc[h+1];if(0!=n&&(e.xr[h]<0&&m++,i--),b>15){if(n>14){var p=n-15;m|=p<<1,j=k,n=15}if(o>14){var q=o-15;m<<=k,m|=q,j+=k,o=15}l=16}0!=o&&(m<<=1,e.xr[h+1]<0&&m++,i--),n=n*l+o,j-=i,i+=f.hlen[n],r(a,f.table[n],i),r(a,m,j),g+=i+j}return g}function C(a,b){var c=3*a.scalefac_band.s[3];c>b.big_values&&(c=b.big_values);var d=B(a,b.table_select[0],0,c,b);return d+=B(a,b.table_select[1],c,b.big_values,b)}function D(a,b){var c,d,e,f;c=b.big_values;var g=b.region0_count+1;return e=a.scalefac_band.l[g],g+=b.region1_count+1,f=a.scalefac_band.l[g],e>c&&(e=c),f>c&&(f=c),d=B(a,b.table_select[0],0,e,b),d+=B(a,b.table_select[1],e,f,b),d+=B(a,b.table_select[2],f,c,b)}function E(a){var b,c,d,e,f=0,g=a.internal_flags,h=g.l3_side;if(1==a.version)for(b=0;b<2;b++)for(c=0;c<g.channels_out;c++){
var i=h.tt[b][c],j=w.slen1_tab[i.scalefac_compress],k=w.slen2_tab[i.scalefac_compress];for(e=0,d=0;d<i.sfbdivide;d++)i.scalefac[d]!=-1&&(r(g,i.scalefac[d],j),e+=j);for(;d<i.sfbmax;d++)i.scalefac[d]!=-1&&(r(g,i.scalefac[d],k),e+=k);e+=i.block_type==Q.SHORT_TYPE?C(g,i):D(g,i),e+=z(g,i),f+=e}else for(b=0,c=0;c<g.channels_out;c++){var l,m,i=h.tt[b][c],n=0;if(e=0,d=0,m=0,i.block_type==Q.SHORT_TYPE){for(;m<4;m++){var o=i.sfb_partition_table[m]/3,p=i.slen[m];for(l=0;l<o;l++,d++)r(g,Math.max(i.scalefac[3*d+0],0),p),r(g,Math.max(i.scalefac[3*d+1],0),p),r(g,Math.max(i.scalefac[3*d+2],0),p),n+=3*p}e+=C(g,i)}else{for(;m<4;m++){var o=i.sfb_partition_table[m],p=i.slen[m];for(l=0;l<o;l++,d++)r(g,Math.max(i.scalefac[d],0),p),n+=p}e+=D(g,i)}e+=z(g,i),f+=n+e}return f}function F(){this.total=0}function G(a,c){var e,f,g,h,i,d=a.internal_flags;return i=d.w_ptr,h=d.h_ptr-1,h==-1&&(h=V.MAX_HEADER_BUF-1),e=d.header[h].write_timing-n,c.total=e,e>=0&&(f=1+h-i,h<i&&(f=1+h-i+V.MAX_HEADER_BUF),e-=8*f*d.sideinfo_len),g=b.getframebits(a),e+=g,c.total+=g,c.total%8!=0?c.total=1+c.total/8:c.total=c.total/8,c.total+=o+1,e<0&&k.err.println("strange error flushing buffer ... \n"),e}var b=this,d=32773,g=null,h=null,i=null,l=null;this.setModules=function(a,b,c,d){g=a,h=b,i=c,l=d};var m=null,n=0,o=0,p=0;this.getframebits=function(a){var c,b=a.internal_flags;c=0!=b.bitrate_index?A.bitrate_table[a.version][b.bitrate_index]:a.brate;var d=0|72e3*(a.version+1)*c/a.out_samplerate+b.padding;return 8*d},this.CRC_writeheader=function(a,b){var c=65535;c=x(255&b[2],c),c=x(255&b[3],c);for(var d=6;d<a.sideinfo_len;d++)c=x(255&b[d],c);b[4]=byte(c>>8),b[5]=byte(255&c)},this.flush_bitstream=function(a){var c,d,b=a.internal_flags,e=b.h_ptr-1;if(e==-1&&(e=V.MAX_HEADER_BUF-1),c=b.l3_side,!((d=G(a,new F))<0)){if(t(a,d),b.ResvSize=0,c.main_data_begin=0,b.findReplayGain){var f=g.GetTitleGain(b.rgdata);b.RadioGain=0|Math.floor(10*f+.5)}b.findPeakSample&&(b.noclipGainChange=0|Math.ceil(20*Math.log10(b.PeakSample/32767)*10),b.noclipGainChange>0&&(EQ(a.scale,1)||EQ(a.scale,0))?b.noclipScale=Math.floor(32767/b.PeakSample*100)/100:b.noclipScale=-1)}},this.add_dummy_byte=function(a,b,c){for(var e,d=a.internal_flags;c-- >0;)for(s(d,b,8),e=0;e<V.MAX_HEADER_BUF;++e)d.header[e].write_timing+=8},this.format_bitstream=function(a){var c,b=a.internal_flags;c=b.l3_side;var d=this.getframebits(a);t(a,c.resvDrain_pre),y(a,d);var e=8*b.sideinfo_len;if(e+=E(a),t(a,c.resvDrain_post),e+=c.resvDrain_post,c.main_data_begin+=(d-e)/8,G(a,new F)!=b.ResvSize&&k.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*c.main_data_begin!=b.ResvSize&&(k.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*c.main_data_begin,b.ResvSize,c.resvDrain_post,c.resvDrain_pre,8*b.sideinfo_len,e-c.resvDrain_post-8*b.sideinfo_len,e,e%8,d),k.err.println("This is a fatal error.  It has several possible causes:"),k.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),k.err.println(" 9%%  Your system is overclocked"),k.err.println(" 1%%  bug in LAME encoding library"),b.ResvSize=8*c.main_data_begin),n>1e9){var f;for(f=0;f<V.MAX_HEADER_BUF;++f)b.header[f].write_timing-=n;n=0}return 0},this.copy_buffer=function(a,b,d,e,i){var j=o+1;if(j<=0)return 0;if(0!=e&&j>e)return-1;if(k.arraycopy(m,0,b,d,j),o=-1,p=0,0!=i){var n=c(1);if(n[0]=a.nMusicCRC,l.updateMusicCRC(n,b,d,j),a.nMusicCRC=n[0],j>0&&(a.VBR_seek_table.nBytesWritten+=j),a.decode_on_the_fly)for(var t,q=f([2,1152]),r=j,s=-1;0!=s;)if(s=h.hip_decode1_unclipped(a.hip,b,d,r,q[0],q[1]),r=0,s==-1&&(s=0),s>0){if(a.findPeakSample){for(t=0;t<s;t++)q[0][t]>a.PeakSample?a.PeakSample=q[0][t]:-q[0][t]>a.PeakSample&&(a.PeakSample=-q[0][t]);if(a.channels_out>1)for(t=0;t<s;t++)q[1][t]>a.PeakSample?a.PeakSample=q[1][t]:-q[1][t]>a.PeakSample&&(a.PeakSample=-q[1][t])}if(a.findReplayGain&&g.AnalyzeSamples(a.rgdata,q[0],0,q[1],0,s,a.channels_out)==u.GAIN_ANALYSIS_ERROR)return-6}}return j},this.init_bit_stream_w=function(b){m=a(Y.LAME_MAXMP3BUFFER),b.h_ptr=b.w_ptr=0,b.header[b.h_ptr].write_timing=0,o=-1,p=0,n=0}}function y(){function x(a,b){if(a.nVbrNumFrames++,a.sum+=b,a.seen++,!(a.seen<a.want)&&(a.pos<a.size&&(a.bag[a.pos]=a.sum,a.pos++,a.seen=0),a.pos==a.size)){for(var c=1;c<a.size;c+=2)a.bag[c/2]=a.bag[c];a.want*=2,a.pos/=2}}function z(a,b){if(!(a.pos<=0))for(var c=1;c<i;++c){var e,f,d=c/i,g=0|Math.floor(d*a.pos);g>a.pos-1&&(g=a.pos-1),e=a.bag[g],f=a.sum;var h=0|256*e/f;h>255&&(h=255),b[c]=255&h}}function B(a,b){var c=255&a[b+0];return c<<=8,c|=255&a[b+1],c<<=8,c|=255&a[b+2],c<<=8,c|=255&a[b+3]}function C(a,b,c){a[b+0]=255&(c>>24&255),a[b+1]=255&(c>>16&255),a[b+2]=255&(c>>8&255),a[b+3]=255&(255&c)}function D(a,b,c){a[b+0]=255&(c>>8&255),a[b+1]=255&(255&c)}function E(a,b){return new String(a,b,u.length(),t).equals(u)||new String(a,b,v.length(),t).equals(v)}function F(a,b,c){return 255&(a<<b|c&~(-1<<b))}function G(a,c){var d=a.internal_flags;c[0]=F(c[0],8,255),c[1]=F(c[1],3,7),c[1]=F(c[1],1,a.out_samplerate<16e3?0:1),c[1]=F(c[1],1,a.version),c[1]=F(c[1],2,1),c[1]=F(c[1],1,a.error_protection?0:1),c[2]=F(c[2],4,d.bitrate_index),c[2]=F(c[2],2,d.samplerate_index),c[2]=F(c[2],1,0),c[2]=F(c[2],1,a.extension),c[3]=F(c[3],2,a.mode.ordinal()),c[3]=F(c[3],2,d.mode_ext),c[3]=F(c[3],1,a.copyright),c[3]=F(c[3],1,a.original),c[3]=F(c[3],2,a.emphasis),c[0]=255;var f,e=255&(241&c[1]);f=1==a.version?q:a.out_samplerate<16e3?s:r,a.VBR==o.vbr_off&&(f=a.brate);var g;g=a.free_format?0:255&16*b.BitrateIndex(f,a.version,a.out_samplerate),1==a.version?(c[1]=255&(10|e),e=255&(13&c[2]),c[2]=255&(g|e)):(c[1]=255&(2|e),e=255&(13&c[2]),c[2]=255&(g|e))}function H(a,b){var c=b^a;return b=b>>8^w[255&c]}function I(a,b,c,e,f){var n,p,M,g=a.internal_flags,h=0,i=a.encoder_delay,j=a.encoder_padding,k=100-10*a.VBR_q-a.quality,l=d.getLameVeryShortVersion(),o=0,q=[1,5,3,2,4,0,3],r=0|(a.lowpassfreq/100+.5>255?255:a.lowpassfreq/100+.5),s=0,t=0,u=0,v=a.internal_flags.noise_shaping,w=0,x=0,y=0,z=0,A=0,B=0!=(1&a.exp_nspsytune),E=0!=(2&a.exp_nspsytune),F=!1,G=!1,I=a.internal_flags.nogap_total,J=a.internal_flags.nogap_current,K=a.ATHtype,L=0;switch(a.VBR){case vbr_abr:M=a.VBR_mean_bitrate_kbps;break;case vbr_off:M=a.brate;break;default:M=a.VBR_min_bitrate_kbps}switch(n=a.VBR.ordinal()<q.length?q[a.VBR.ordinal()]:0,p=16*o+n,g.findReplayGain&&(g.RadioGain>510&&(g.RadioGain=510),g.RadioGain<-510&&(g.RadioGain=-510),t=8192,t|=3072,g.RadioGain>=0?t|=g.RadioGain:(t|=512,t|=-g.RadioGain)),g.findPeakSample&&(s=Math.abs(0|g.PeakSample/32767*Math.pow(2,23)+.5)),I!=-1&&(J>0&&(G=!0),J<I-1&&(F=!0)),L=K+((B?1:0)<<4)+((E?1:0)<<5)+((F?1:0)<<6)+((G?1:0)<<7),k<0&&(k=0),a.mode){case MONO:w=0;break;case STEREO:w=1;break;case DUAL_CHANNEL:w=2;break;case JOINT_STEREO:w=a.force_ms?4:3;break;case NOT_SET:default:w=7}y=a.in_samplerate<=32e3?0:48e3==a.in_samplerate?2:a.in_samplerate>48e3?3:1,(a.short_blocks==m.short_block_forced||a.short_blocks==m.short_block_dispensed||a.lowpassfreq==-1&&a.highpassfreq==-1||a.scale_left<a.scale_right||a.scale_left>a.scale_right||a.disable_reservoir&&a.brate<320||a.noATH||a.ATHonly||0==K||a.in_samplerate<=32e3)&&(x=1),z=v+(w<<2)+(x<<5)+(y<<6),A=g.nMusicCRC,C(c,e+h,k),h+=4;for(var N=0;N<9;N++)c[e+h+N]=255&l.charAt(N);h+=9,c[e+h]=255&p,h++,c[e+h]=255&r,h++,C(c,e+h,s),h+=4,D(c,e+h,t),h+=2,D(c,e+h,u),h+=2,c[e+h]=255&L,h++,M>=255?c[e+h]=255:c[e+h]=255&M,h++,c[e+h]=255&i>>4,c[e+h+1]=255&(i<<4)+(j>>8),c[e+h+2]=255&j,h+=3,c[e+h]=255&z,h++,c[e+h++]=0,D(c,e+h,a.preset),h+=2,C(c,e+h,b),h+=4,D(c,e+h,A),h+=2;for(var O=0;O<h;O++)f=H(c[e+O],f);return D(c,e+h,f),h+=2}function J(b){b.seek(0);var c=a(10);b.readFully(c);var d;return d=new String(c,"ISO-8859-1").startsWith("ID3")?0:((127&c[6])<<21|(127&c[7])<<14|(127&c[8])<<7|127&c[9])+c.length}var b,c,d;this.setModules=function(a,e,f){b=a,c=e,d=f};var e=1,f=2,g=4,h=8,i=y.NUMTOCENTRIES,l=y.MAXFRAMESIZE,n=i+4+4+4+4+4,p=n+9+1+1+8+1+1+3+1+1+2+4+2+2,q=128,r=64,s=32,t=null,u="Xing",v="Info",w=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.addVbrFrame=function(a){var b=a.internal_flags,c=A.bitrate_table[a.version][b.bitrate_index];x(b.VBR_seek_table,c)},this.getVbrTag=function(a){var b=new VBRTagData,c=0;b.flags=0;var d=a[c+1]>>3&1,j=a[c+2]>>2&3,k=a[c+3]>>6&3,l=a[c+2]>>4&15;if(l=A.bitrate_table[d][l],a[c+1]>>4==14?b.samprate=A.samplerate_table[2][j]:b.samprate=A.samplerate_table[d][j],c+=0!=d?3!=k?36:21:3!=k?21:13,!E(a,c))return null;c+=4,b.hId=d;var m=b.flags=B(a,c);if(c+=4,0!=(m&e)&&(b.frames=B(a,c),c+=4),0!=(m&f)&&(b.bytes=B(a,c),c+=4),0!=(m&g)){if(null!=b.toc)for(var n=0;n<i;n++)b.toc[n]=a[c+n];c+=i}b.vbrScale=-1,0!=(m&h)&&(b.vbrScale=B(a,c),c+=4),b.headersize=72e3*(d+1)*l/b.samprate,c+=21;var o=a[c+0]<<4;o+=a[c+1]>>4;var p=(15&a[c+1])<<8;return p+=255&a[c+2],(o<0||o>3e3)&&(o=-1),(p<0||p>3e3)&&(p=-1),b.encDelay=o,b.encPadding=p,b},this.InitVbrTag=function(b){var e,d=b.internal_flags;e=1==b.version?q:b.out_samplerate<16e3?s:r,b.VBR==o.vbr_off&&(e=b.brate);var f=72e3*(b.version+1)*e/b.out_samplerate,g=d.sideinfo_len+p;if(d.VBR_seek_table.TotalFrameSize=f,f<g||f>l)return void(b.bWriteVbrTag=!1);d.VBR_seek_table.nVbrNumFrames=0,d.VBR_seek_table.nBytesWritten=0,d.VBR_seek_table.sum=0,d.VBR_seek_table.seen=0,d.VBR_seek_table.want=1,d.VBR_seek_table.pos=0,null==d.VBR_seek_table.bag&&(d.VBR_seek_table.bag=new int[400],d.VBR_seek_table.size=400);var h=a(l);G(b,h);for(var i=d.VBR_seek_table.TotalFrameSize,j=0;j<i;++j)c.add_dummy_byte(b,255&h[j],1)},this.updateMusicCRC=function(a,b,c,d){for(var e=0;e<d;++e)a[0]=H(b[c+e],a[0])},this.getLameTagFrame=function(b,d){var l=b.internal_flags;if(!b.bWriteVbrTag)return 0;if(l.Class_ID!=Y.LAME_ID)return 0;if(l.VBR_seek_table.pos<=0)return 0;if(d.length<l.VBR_seek_table.TotalFrameSize)return l.VBR_seek_table.TotalFrameSize;j.fill(d,0,l.VBR_seek_table.TotalFrameSize,0),G(b,d);var m=a(i);if(b.free_format)for(var n=1;n<i;++n)m[n]=255&255*n/100;else z(l.VBR_seek_table,m);var p=l.sideinfo_len;b.error_protection&&(p-=2),b.VBR==o.vbr_off?(d[p++]=255&v.charAt(0),d[p++]=255&v.charAt(1),d[p++]=255&v.charAt(2),d[p++]=255&v.charAt(3)):(d[p++]=255&u.charAt(0),d[p++]=255&u.charAt(1),d[p++]=255&u.charAt(2),d[p++]=255&u.charAt(3)),C(d,p,e+f+g+h),p+=4,C(d,p,l.VBR_seek_table.nVbrNumFrames),p+=4;var q=l.VBR_seek_table.nBytesWritten+l.VBR_seek_table.TotalFrameSize;C(d,p,0|q),p+=4,k.arraycopy(m,0,d,p,m.length),p+=m.length,b.error_protection&&c.CRC_writeheader(l,d);for(var r=0,n=0;n<p;n++)r=H(d[n],r);return p+=I(b,q,d,p,r),l.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(b,c){var d=b.internal_flags;if(d.VBR_seek_table.pos<=0)return-1;if(c.seek(c.length()),0==c.length())return-1;var e=J(c);c.seek(e);var f=a(l),g=getLameTagFrame(b,f);return g>f.length?-1:g<1?0:(c.write(f,0,g),0)}}function z(a,b,c,d){this.xlen=a,this.linmax=b,this.table=c,this.hlen=d}function B(a){this.bits=a}function C(){var a,b;this.setModules=function(c,d){a=c,b=d}}function D(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function E(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=r.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function F(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=d(Q.SBMAX_l),this.s=d(Q.SBMAX_s),this.psfb21=d(Q.PSFB21),this.psfb12=d(Q.PSFB12),this.cb_l=d(Q.CBANDS),this.cb_s=d(Q.CBANDS),this.eql_w=d(Q.BLKSIZE/2)}function G(){this.linprebuf=d(2*u.MAX_ORDER),this.linpre=0,this.lstepbuf=d(u.MAX_SAMPLES_PER_WINDOW+u.MAX_ORDER),this.lstep=0,this.loutbuf=d(u.MAX_SAMPLES_PER_WINDOW+u.MAX_ORDER),this.lout=0,this.rinprebuf=d(2*u.MAX_ORDER),this.rinpre=0,this.rstepbuf=d(u.MAX_SAMPLES_PER_WINDOW+u.MAX_ORDER),this.rstep=0,this.routbuf=d(u.MAX_SAMPLES_PER_WINDOW+u.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=c(0|u.STEPS_per_dB*u.MAX_dB),this.B=c(0|u.STEPS_per_dB*u.MAX_dB)}function H(a){var b=a;this.quantize=b,this.iteration_loop=function(a,b,e,f){var l,g=a.internal_flags,h=d(M.SFBMAX),i=d(576),j=c(2),k=0,m=g.l3_side,n=new B(k);this.quantize.rv.ResvFrameBegin(a,n),k=n.bits;for(var o=0;o<g.mode_gr;o++){l=this.quantize.qupvt.on_pe(a,b,j,k,o,o),g.mode_ext==Q.MPG_MD_MS_LR&&(this.quantize.ms_convert(g.l3_side,o),this.quantize.qupvt.reduce_side(j,e[o],k,l));for(var p=0;p<g.channels_out;p++){var q,r,s=m.tt[o][p];s.block_type!=Q.SHORT_TYPE?(q=0,r=g.PSY.mask_adjust-q):(q=0,r=g.PSY.mask_adjust_short-q),g.masking_lower=Math.pow(10,.1*r),this.quantize.init_outer_loop(g,s),this.quantize.init_xrpow(g,s,i)&&(this.quantize.qupvt.calc_xmin(a,f[o][p],s,h),this.quantize.outer_loop(a,s,h,i,p,j[p])),this.quantize.iteration_finish_one(g,o,p)}}this.quantize.rv.ResvFrameEnd(g,k)}}function I(a,b,d,e){this.l=c(1+Q.SBMAX_l),this.s=c(1+Q.SBMAX_s),this.psfb21=c(1+Q.PSFB21),this.psfb12=c(1+Q.PSFB12);var f=this.l,g=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],k.arraycopy(this.arrL,0,f,0,Math.min(this.arrL.length,this.l.length)),k.arraycopy(this.arrS,0,g,0,Math.min(this.arrS.length,this.s.length)),k.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),k.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function J(){function f(a){return s[a+J.Q_MAX2]}function w(a,b){var c=e.ATHformula(b,a);return c-=q,c=Math.pow(10,c/10+a.ATHlower)}function y(a){for(var b=a.internal_flags.ATH.l,c=a.internal_flags.ATH.psfb21,d=a.internal_flags.ATH.s,e=a.internal_flags.ATH.psfb12,f=a.internal_flags,g=a.out_samplerate,h=0;h<Q.SBMAX_l;h++){var i=f.scalefac_band.l[h],j=f.scalefac_band.l[h+1];b[h]=n.MAX_VALUE;for(var k=i;k<j;k++){var l=k*g/1152,m=w(a,l);b[h]=Math.min(b[h],m)}}for(var h=0;h<Q.PSFB21;h++){var i=f.scalefac_band.psfb21[h],j=f.scalefac_band.psfb21[h+1];c[h]=n.MAX_VALUE;for(var k=i;k<j;k++){var l=k*g/1152,m=w(a,l);c[h]=Math.min(c[h],m)}}for(var h=0;h<Q.SBMAX_s;h++){var i=f.scalefac_band.s[h],j=f.scalefac_band.s[h+1];d[h]=n.MAX_VALUE;for(var k=i;k<j;k++){var l=k*g/384,m=w(a,l);d[h]=Math.min(d[h],m)}d[h]*=f.scalefac_band.s[h+1]-f.scalefac_band.s[h]}for(var h=0;h<Q.PSFB12;h++){var i=f.scalefac_band.psfb12[h],j=f.scalefac_band.psfb12[h+1];e[h]=n.MAX_VALUE;for(var k=i;k<j;k++){var l=k*g/384,m=w(a,l);e[h]=Math.min(e[h],m)}e[h]*=f.scalefac_band.s[13]-f.scalefac_band.s[12]}if(a.noATH){for(var h=0;h<Q.SBMAX_l;h++)b[h]=1e-20;for(var h=0;h<Q.PSFB21;h++)c[h]=1e-20;for(var h=0;h<Q.SBMAX_s;h++)d[h]=1e-20;for(var h=0;h<Q.PSFB12;h++)e[h]=1e-20}f.ATH.floor=10*Math.log10(w(a,-1))}function z(a){this.s=a}var a=null,b=null,e=null;this.setModules=function(c,d,f){a=c,b=d,e=f},this.IPOW20=function(a){return t[a]};var g=2.220446049250313e-16,h=J.IXMAX_VAL,i=h+2,j=J.Q_MAX,m=J.Q_MAX2,q=(J.LARGE_BITS,100);this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var r=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=r,this.sfBandIndex=[new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var s=d(j+m+1),t=d(j),u=d(i),v=d(i);this.adj43=v,this.iteration_init=function(b){var e,c=b.internal_flags,d=c.l3_side;if(0==c.iteration_init_init){for(c.iteration_init_init=1,d.main_data_begin=0,y(b),u[0]=0,e=1;e<i;e++)u[e]=Math.pow(e,4/3);for(e=0;e<i-1;e++)v[e]=e+1-Math.pow(.5*(u[e]+u[e+1]),.75);for(v[e]=.5,e=0;e<j;e++)t[e]=Math.pow(2,(e-210)*-.1875);for(e=0;e<=j+m;e++)s[e]=Math.pow(2,.25*(e-210-m));a.huffman_init(c);var f,g,h,k;for(e=b.exp_nspsytune>>2&63,e>=32&&(e-=64),f=Math.pow(10,e/4/10),e=b.exp_nspsytune>>8&63,e>=32&&(e-=64),g=Math.pow(10,e/4/10),e=b.exp_nspsytune>>14&63,e>=32&&(e-=64),h=Math.pow(10,e/4/10),e=b.exp_nspsytune>>20&63,e>=32&&(e-=64),k=h*Math.pow(10,e/4/10),e=0;e<Q.SBMAX_l;e++){var l;l=e<=6?f:e<=13?g:e<=20?h:k,c.nsPsy.longfact[e]=l}for(e=0;e<Q.SBMAX_s;e++){var l;l=e<=5?f:e<=10?g:e<=11?h:k,c.nsPsy.shortfact[e]=l}}},this.on_pe=function(a,d,e,f,g,h){var k,m,i=a.internal_flags,j=0,l=c(2),n=new B(j),o=b.ResvMaxBits(a,f,n,h);j=n.bits;var p=j+o;for(p>V.MAX_BITS_PER_GRANULE&&(p=V.MAX_BITS_PER_GRANULE),k=0,m=0;m<i.channels_out;++m)e[m]=Math.min(V.MAX_BITS_PER_CHANNEL,j/i.channels_out),l[m]=0|e[m]*d[g][m]/700-e[m],l[m]>3*f/4&&(l[m]=3*f/4),l[m]<0&&(l[m]=0),l[m]+e[m]>V.MAX_BITS_PER_CHANNEL&&(l[m]=Math.max(0,V.MAX_BITS_PER_CHANNEL-e[m])),k+=l[m];if(k>o)for(m=0;m<i.channels_out;++m)l[m]=o*l[m]/k;for(m=0;m<i.channels_out;++m)e[m]+=l[m],o-=l[m];for(k=0,m=0;m<i.channels_out;++m)k+=e[m];if(k>V.MAX_BITS_PER_GRANULE){var q=0;for(m=0;m<i.channels_out;++m)e[m]*=V.MAX_BITS_PER_GRANULE,e[m]/=k,q+=e[m]}return p},this.reduce_side=function(a,b,c,d){var e=.33*(.5-b)/.5;e<0&&(e=0),e>.5&&(e=.5);var f=0|.5*e*(a[0]+a[1]);f>V.MAX_BITS_PER_CHANNEL-a[0]&&(f=V.MAX_BITS_PER_CHANNEL-a[0]),f<0&&(f=0),a[1]>=125&&(a[1]-f>125?(a[0]<c&&(a[0]+=f),a[1]-=f):(a[0]+=a[1]-125,a[1]=125)),f=a[0]+a[1],f>d&&(a[0]=d*a[0]/f,a[1]=d*a[1]/f)},this.athAdjust=function(a,b,c){var d=90.30873362,e=94.82444863,f=l.FAST_LOG10_X(b,10),g=a*a,h=0;return f-=c,g>1e-20&&(h=1+l.FAST_LOG10_X(g,10/d)),h<0&&(h=0),f*=h,f+=c+d-e,Math.pow(10,.1*f)},this.calc_xmin=function(a,b,c,d){var h,e=0,f=a.internal_flags,i=0,j=0,k=f.ATH,l=c.xr,m=a.VBR==o.vbr_mtrh?1:0,n=f.masking_lower;for(a.VBR!=o.vbr_mtrh&&a.VBR!=o.vbr_mt||(n=1),h=0;h<c.psy_lmax;h++){var p,q,r,s,t,u;q=a.VBR==o.vbr_rh||a.VBR==o.vbr_mtrh?athAdjust(k.adjust,k.l[h],k.floor):k.adjust*k.l[h],t=c.width[h],r=q/t,s=g,u=t>>1,p=0;do{var v,w;v=l[i]*l[i],p+=v,s+=v<r?v:r,i++,w=l[i]*l[i],p+=w,s+=w<r?w:r,i++}while(--u>0);if(p>q&&j++,h==Q.SBPSY_l){var y=q*f.nsPsy.longfact[h];s<y&&(s=y)}if(0!=m&&(q=s),!a.ATHonly){var z=b.en.l[h];if(z>0){var y;y=p*b.thm.l[h]*n/z,0!=m&&(y*=f.nsPsy.longfact[h]),q<y&&(q=y)}}0!=m?d[e++]=q:d[e++]=q*f.nsPsy.longfact[h]}var A=575;if(c.block_type!=Q.SHORT_TYPE)for(var B=576;0!=B--&&x.EQ(l[B],0);)A=B;c.max_nonzero_coeff=A;for(var C=c.sfb_smin;h<c.psymax;C++,h+=3){var t,D,E;for(E=a.VBR==o.vbr_rh||a.VBR==o.vbr_mtrh?athAdjust(k.adjust,k.s[C],k.floor):k.adjust*k.s[C],t=c.width[h],D=0;D<3;D++){var q,r,s,p=0,u=t>>1;r=E/t,s=g;do{var v,w;v=l[i]*l[i],p+=v,s+=v<r?v:r,i++,w=l[i]*l[i],p+=w,s+=w<r?w:r,i++}while(--u>0);if(p>E&&j++,C==Q.SBPSY_s){var y=E*f.nsPsy.shortfact[C];s<y&&(s=y)}if(q=0!=m?s:E,!a.ATHonly&&!a.ATHshort){var z=b.en.s[C][D];if(z>0){var y;y=p*b.thm.s[C][D]*n/z,0!=m&&(y*=f.nsPsy.shortfact[C]),q<y&&(q=y)}}0!=m?d[e++]=q:d[e++]=q*f.nsPsy.shortfact[C]}a.useTemporal&&(d[e-3]>d[e-3+1]&&(d[e-3+1]+=(d[e-3]-d[e-3+1])*f.decay),d[e-3+1]>d[e-3+2]&&(d[e-3+2]+=(d[e-3+1]-d[e-3+2])*f.decay))}return j},this.calc_noise_core=function(a,b,c,e){var f=0,g=b.s,h=a.l3_enc;if(g>a.count1)for(;0!=c--;){var i;i=a.xr[g],g++,f+=i*i,i=a.xr[g],g++,f+=i*i}else if(g>a.big_values){var j=d(2);for(j[0]=0,j[1]=e;0!=c--;){var i;i=Math.abs(a.xr[g])-j[h[g]],g++,f+=i*i,i=Math.abs(a.xr[g])-j[h[g]],g++,f+=i*i}}else for(;0!=c--;){var i;i=Math.abs(a.xr[g])-u[h[g]]*e,g++,f+=i*i,i=Math.abs(a.xr[g])-u[h[g]]*e,g++,f+=i*i}return b.s=g,f},this.calc_noise=function(a,b,c,d,e){var i,j,g=0,h=0,k=0,m=0,n=0,o=-20,p=0,q=a.scalefac,s=0;for(d.over_SSD=0,i=0;i<a.psymax;i++){var t=a.global_gain-(q[s++]+(0!=a.preflag?r[i]:0)<<a.scalefac_scale+1)-8*a.subblock_gain[a.window[i]],u=0;if(null!=e&&e.step[i]==t)u=e.noise[i],p+=a.width[i],c[g++]=u/b[h++],u=e.noise_log[i];else{var v=f(t);if(j=a.width[i]>>1,p+a.width[i]>a.max_nonzero_coeff){var w;w=a.max_nonzero_coeff-p+1,j=w>0?w>>1:0}var x=new z(p);u=this.calc_noise_core(a,x,j,v),p=x.s,null!=e&&(e.step[i]=t,e.noise[i]=u),u=c[g++]=u/b[h++],u=l.FAST_LOG10(Math.max(u,1e-20)),null!=e&&(e.noise_log[i]=u)}if(null!=e&&(e.global_gain=a.global_gain),n+=u,u>0){var y;y=Math.max(0|10*u+.5,1),d.over_SSD+=y*y,k++,m+=u}o=Math.max(o,u)}return d.over_count=k,d.tot_noise=n,d.over_noise=m,d.max_noise=o,k},this.set_pinfo=function(a,b,c,e,f){var h,i,j,k,l,g=a.internal_flags,m=0==b.scalefac_scale?.5:1,n=b.scalefac,o=d(M.SFBMAX),p=d(M.SFBMAX),q=new D;calc_xmin(a,c,b,o),calc_noise(b,o,p,q,null);var s=0;for(i=b.sfb_lmax,b.block_type!=Q.SHORT_TYPE&&0==b.mixed_block_flag&&(i=22),h=0;h<i;h++){var t=g.scalefac_band.l[h],u=g.scalefac_band.l[h+1],v=u-t;for(k=0;s<u;s++)k+=b.xr[s]*b.xr[s];k/=v,l=1e15,g.pinfo.en[e][f][h]=l*k,g.pinfo.xfsf[e][f][h]=l*o[h]*p[h]/v,c.en.l[h]>0&&!a.ATHonly?k/=c.en.l[h]:k=0,g.pinfo.thr[e][f][h]=l*Math.max(k*c.thm.l[h],g.ATH.l[h]),g.pinfo.LAMEsfb[e][f][h]=0,0!=b.preflag&&h>=11&&(g.pinfo.LAMEsfb[e][f][h]=-m*r[h]),h<Q.SBPSY_l&&(g.pinfo.LAMEsfb[e][f][h]-=m*n[h])}if(b.block_type==Q.SHORT_TYPE)for(i=h,h=b.sfb_smin;h<Q.SBMAX_s;h++)for(var t=g.scalefac_band.s[h],u=g.scalefac_band.s[h+1],v=u-t,w=0;w<3;w++){for(k=0,j=t;j<u;j++)k+=b.xr[s]*b.xr[s],s++;k=Math.max(k/v,1e-20),l=1e15,g.pinfo.en_s[e][f][3*h+w]=l*k,g.pinfo.xfsf_s[e][f][3*h+w]=l*o[i]*p[i]/v,c.en.s[h][w]>0?k/=c.en.s[h][w]:k=0,(a.ATHonly||a.ATHshort)&&(k=0),g.pinfo.thr_s[e][f][3*h+w]=l*Math.max(k*c.thm.s[h][w],g.ATH.s[h]),g.pinfo.LAMEsfb_s[e][f][3*h+w]=-2*b.subblock_gain[w],h<Q.SBPSY_s&&(g.pinfo.LAMEsfb_s[e][f][3*h+w]-=m*n[i]),i++}g.pinfo.LAMEqss[e][f]=b.global_gain,g.pinfo.LAMEmainbits[e][f]=b.part2_3_length+b.part2_length,g.pinfo.LAMEsfbits[e][f]=b.part2_length,g.pinfo.over[e][f]=q.over_count,g.pinfo.max_noise[e][f]=10*q.max_noise,g.pinfo.over_noise[e][f]=10*q.over_noise,g.pinfo.tot_noise[e][f]=10*q.tot_noise,g.pinfo.over_SSD[e][f]=q.over_SSD}}function K(){function b(a){return new Int32Array(a)}function e(a){return new Float32Array(a)}this.xr=d(576),this.l3_enc=c(576),this.scalefac=c(M.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=c(3),this.subblock_gain=c(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=c(M.SFBMAX),this.window=c(M.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=c(4),this.max_nonzero_coeff=0;var a=this;this.assign=function(c){a.xr=e(c.xr),a.l3_enc=b(c.l3_enc),a.scalefac=b(c.scalefac),a.xrpow_max=c.xrpow_max,a.part2_3_length=c.part2_3_length,a.big_values=c.big_values,a.count1=c.count1,a.global_gain=c.global_gain,a.scalefac_compress=c.scalefac_compress,a.block_type=c.block_type,a.mixed_block_flag=c.mixed_block_flag,a.table_select=b(c.table_select),a.subblock_gain=b(c.subblock_gain),a.region0_count=c.region0_count,a.region1_count=c.region1_count,a.preflag=c.preflag,a.scalefac_scale=c.scalefac_scale,a.count1table_select=c.count1table_select,a.part2_length=c.part2_length,a.sfb_lmax=c.sfb_lmax,a.sfb_smin=c.sfb_smin,a.psy_lmax=c.psy_lmax,a.sfbmax=c.sfbmax,a.psymax=c.psymax,a.sfbdivide=c.sfbdivide,a.width=b(c.width),a.window=b(c.window),a.count1bits=c.count1bits,a.sfb_partition_table=c.sfb_partition_table.slice(0),a.slen=b(c.slen),a.max_nonzero_coeff=c.max_nonzero_coeff}}function L(){this.global_gain=0,this.sfb_count1=0,this.step=c(39),this.noise=d(39),this.noise_log=d(39)}function N(){function g(a,b,c,d){d=0;for(var e=0;e<=c;++e){var f=Math.abs(a.xr[e]);d+=f,b[e]=Math.sqrt(f*Math.sqrt(f)),b[e]>a.xrpow_max&&(a.xrpow_max=b[e])}return d}function h(a,b){var d=a.ATH,e=b.xr;if(b.block_type!=Q.SHORT_TYPE)for(var f=!1,g=Q.PSFB21-1;g>=0&&!f;g--){var h=a.scalefac_band.psfb21[g],i=a.scalefac_band.psfb21[g+1],j=c.athAdjust(d.adjust,d.psfb21[g],d.floor);a.nsPsy.longfact[21]>1e-12&&(j*=a.nsPsy.longfact[21]);for(var k=i-1;k>=h;k--){if(!(Math.abs(e[k])<j)){f=!0;break}e[k]=0}}else for(var l=0;l<3;l++)for(var f=!1,g=Q.PSFB12-1;g>=0&&!f;g--){var h=3*a.scalefac_band.s[12]+(a.scalefac_band.s[13]-a.scalefac_band.s[12])*l+(a.scalefac_band.psfb12[g]-a.scalefac_band.psfb12[0]),i=h+(a.scalefac_band.psfb12[g+1]-a.scalefac_band.psfb12[g]),m=c.athAdjust(d.adjust,d.psfb12[g],d.floor);a.nsPsy.shortfact[12]>1e-12&&(m*=a.nsPsy.shortfact[12]);for(var k=i-1;k>=h;k--){if(!(Math.abs(e[k])<m)){f=!0;break}e[k]=0}}}function i(a){this.ordinal=a}function m(a,b,c,d,e){var g,h=a.CurrentStep[d],j=!1,k=a.OldValue[d],l=i.BINSEARCH_NONE;for(b.global_gain=k,c-=b.part2_length;;){var m;if(g=f.count_bits(a,e,b,null),1==h||g==c)break;g>c?(l==i.BINSEARCH_DOWN&&(j=!0),j&&(h/=2),l=i.BINSEARCH_UP,m=h):(l==i.BINSEARCH_UP&&(j=!0),j&&(h/=2),l=i.BINSEARCH_DOWN,m=-h),b.global_gain+=m,b.global_gain<0&&(b.global_gain=0,j=!0),b.global_gain>255&&(b.global_gain=255,j=!0)}for(;g>c&&b.global_gain<255;)b.global_gain++,g=f.count_bits(a,e,b,null);return a.CurrentStep[d]=k-b.global_gain>=4?4:2,a.OldValue[d]=b.global_gain,b.part2_3_length=g,g}function n(a){for(var b=0;b<a.sfbmax;b++)if(a.scalefac[b]+a.subblock_gain[a.window[b]]==0)return!1;return!0}function p(a){return l.FAST_LOG10(.368+.632*a*a*a)}function q(a,b){for(var c=1e-37,d=0;d<b.psymax;d++)c+=p(a[d]);return Math.max(1e-20,c)}function r(a,b,c,d,e){var f;switch(a){default:case 9:b.over_count>0?(f=c.over_SSD<=b.over_SSD,c.over_SSD==b.over_SSD&&(f=c.bits<b.bits)):f=c.max_noise<0&&10*c.max_noise+c.bits<=10*b.max_noise+b.bits;break;case 0:f=c.over_count<b.over_count||c.over_count==b.over_count&&c.over_noise<b.over_noise||c.over_count==b.over_count&&x.EQ(c.over_noise,b.over_noise)&&c.tot_noise<b.tot_noise;break;case 8:c.max_noise=q(e,d);case 1:f=c.max_noise<b.max_noise;break;case 2:f=c.tot_noise<b.tot_noise;break;case 3:f=c.tot_noise<b.tot_noise&&c.max_noise<b.max_noise;break;case 4:f=c.max_noise<=0&&b.max_noise>.2||c.max_noise<=0&&b.max_noise<0&&b.max_noise>c.max_noise-.2&&c.tot_noise<b.tot_noise||c.max_noise<=0&&b.max_noise>0&&b.max_noise>c.max_noise-.2&&c.tot_noise<b.tot_noise+b.over_noise||c.max_noise>0&&b.max_noise>-.05&&b.max_noise>c.max_noise-.1&&c.tot_noise+c.over_noise<b.tot_noise+b.over_noise||c.max_noise>0&&b.max_noise>-.1&&b.max_noise>c.max_noise-.15&&c.tot_noise+c.over_noise+c.over_noise<b.tot_noise+b.over_noise+b.over_noise;break;case 5:f=c.over_noise<b.over_noise||x.EQ(c.over_noise,b.over_noise)&&c.tot_noise<b.tot_noise;break;case 6:f=c.over_noise<b.over_noise||x.EQ(c.over_noise,b.over_noise)&&(c.max_noise<b.max_noise||x.EQ(c.max_noise,b.max_noise)&&c.tot_noise<=b.tot_noise);break;case 7:f=c.over_count<b.over_count||c.over_noise<b.over_noise}return 0==b.over_count&&(f=f&&c.bits<b.bits),f}function s(a,b,c,d,e){var g,f=a.internal_flags;g=0==b.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var h=0,i=0;i<b.sfbmax;i++)h<c[i]&&(h=c[i]);var j=f.noise_shaping_amp;switch(3==j&&(j=e?2:1),j){case 2:break;case 1:h>1?h=Math.pow(h,.5):h*=.95;break;case 0:default:h>1?h=1:h*=.95}for(var k=0,i=0;i<b.sfbmax;i++){var m,l=b.width[i];if(k+=l,!(c[i]<h)){if(0!=(2&f.substep_shaping)&&(f.pseudohalf[i]=0==f.pseudohalf[i]?1:0,0==f.pseudohalf[i]&&2==f.noise_shaping_amp))return;for(b.scalefac[i]++,m=-l;m<0;m++)d[k+m]*=g,d[k+m]>b.xrpow_max&&(b.xrpow_max=d[k+m]);if(2==f.noise_shaping_amp)return}}}function t(a,b){for(var d=1.2968395546510096,e=0,f=0;f<a.sfbmax;f++){var g=a.width[f],h=a.scalefac[f];if(0!=a.preflag&&(h+=c.pretab[f]),e+=g,0!=(1&h)){h++;for(var i=-g;i<0;i++)b[e+i]*=d,b[e+i]>a.xrpow_max&&(a.xrpow_max=b[e+i])}a.scalefac[f]=h>>1}a.preflag=0,a.scalefac_scale=1}function u(a,b,d){var e,f=b.scalefac;for(e=0;e<b.sfb_lmax;e++)if(f[e]>=16)return!0;for(var g=0;g<3;g++){var h=0,i=0;for(e=b.sfb_lmax+g;e<b.sfbdivide;e+=3)h<f[e]&&(h=f[e]);for(;e<b.sfbmax;e+=3)i<f[e]&&(i=f[e]);if(!(h<16&&i<8)){if(b.subblock_gain[g]>=7)return!0;b.subblock_gain[g]++;var j=a.scalefac_band.l[b.sfb_lmax];for(e=b.sfb_lmax+g;e<b.sfbmax;e+=3){var k,l=b.width[e],m=f[e];if(m-=4>>b.scalefac_scale,m>=0)f[e]=m,j+=3*l;else{f[e]=0;var n=210+(m<<b.scalefac_scale+1);k=c.IPOW20(n),j+=l*(g+1);for(var o=-l;o<0;o++)d[j+o]*=k,d[j+o]>b.xrpow_max&&(b.xrpow_max=d[j+o]);j+=l*(3-g-1)}}var k=c.IPOW20(202);j+=b.width[e]*(g+1);for(var o=-b.width[e];o<0;o++)d[j+o]*=k,
d[j+o]>b.xrpow_max&&(b.xrpow_max=d[j+o])}}return!1}function v(a,b,c,d,e){var g=a.internal_flags;s(a,b,c,d,e);var h=n(b);return!h&&(!(h=2==g.mode_gr?f.scale_bitcount(b):f.scale_bitcount_lsf(g,b))||(g.noise_shaping>1&&(j.fill(g.pseudohalf,0),0==b.scalefac_scale?(t(b,d),h=!1):b.block_type==Q.SHORT_TYPE&&g.subblock_gain>0&&(h=u(g,b,d)||n(b))),h||(h=2==g.mode_gr?f.scale_bitcount(b):f.scale_bitcount_lsf(g,b)),!h))}var a;this.rv=null;var b;this.qupvt=null;var c,f,e=new C;this.setModules=function(d,g,h,i){a=d,b=g,this.rv=g,c=h,this.qupvt=h,f=i,e.setModules(c,f)},this.ms_convert=function(a,b){for(var c=0;c<576;++c){var d=a.tt[b][0].xr[c],e=a.tt[b][1].xr[c];a.tt[b][0].xr[c]=(d+e)*(.5*l.SQRT2),a.tt[b][1].xr[c]=(d-e)*(.5*l.SQRT2)}},this.init_xrpow=function(a,b,c){var d=0,e=0|b.max_nonzero_coeff;if(b.xrpow_max=0,j.fill(c,e,576,0),d=g(b,c,e,d),d>1e-20){var f=0;0!=(2&a.substep_shaping)&&(f=1);for(var h=0;h<b.psymax;h++)a.pseudohalf[h]=f;return!0}return j.fill(b.l3_enc,0,576,0),!1},this.init_outer_loop=function(a,b){b.part2_3_length=0,b.big_values=0,b.count1=0,b.global_gain=210,b.scalefac_compress=0,b.table_select[0]=0,b.table_select[1]=0,b.table_select[2]=0,b.subblock_gain[0]=0,b.subblock_gain[1]=0,b.subblock_gain[2]=0,b.subblock_gain[3]=0,b.region0_count=0,b.region1_count=0,b.preflag=0,b.scalefac_scale=0,b.count1table_select=0,b.part2_length=0,b.sfb_lmax=Q.SBPSY_l,b.sfb_smin=Q.SBPSY_s,b.psy_lmax=a.sfb21_extra?Q.SBMAX_l:Q.SBPSY_l,b.psymax=b.psy_lmax,b.sfbmax=b.sfb_lmax,b.sfbdivide=11;for(var e=0;e<Q.SBMAX_l;e++)b.width[e]=a.scalefac_band.l[e+1]-a.scalefac_band.l[e],b.window[e]=3;if(b.block_type==Q.SHORT_TYPE){var f=d(576);b.sfb_smin=0,b.sfb_lmax=0,0!=b.mixed_block_flag&&(b.sfb_smin=3,b.sfb_lmax=2*a.mode_gr+4),b.psymax=b.sfb_lmax+3*((a.sfb21_extra?Q.SBMAX_s:Q.SBPSY_s)-b.sfb_smin),b.sfbmax=b.sfb_lmax+3*(Q.SBPSY_s-b.sfb_smin),b.sfbdivide=b.sfbmax-18,b.psy_lmax=b.sfb_lmax;var g=a.scalefac_band.l[b.sfb_lmax];k.arraycopy(b.xr,0,f,0,576);for(var e=b.sfb_smin;e<Q.SBMAX_s;e++)for(var i=a.scalefac_band.s[e],l=a.scalefac_band.s[e+1],m=0;m<3;m++)for(var n=i;n<l;n++)b.xr[g++]=f[3*n+m];for(var o=b.sfb_lmax,e=b.sfb_smin;e<Q.SBMAX_s;e++)b.width[o]=b.width[o+1]=b.width[o+2]=a.scalefac_band.s[e+1]-a.scalefac_band.s[e],b.window[o]=0,b.window[o+1]=1,b.window[o+2]=2,o+=3}b.count1bits=0,b.sfb_partition_table=c.nr_of_sfb_block[0][0],b.slen[0]=0,b.slen[1]=0,b.slen[2]=0,b.slen[3]=0,b.max_nonzero_coeff=575,j.fill(b.scalefac,0),h(a,b)},i.BINSEARCH_NONE=new i(0),i.BINSEARCH_UP=new i(1),i.BINSEARCH_DOWN=new i(2),this.trancate_smallspectrums=function(a,b,e,g){var h=d(M.SFBMAX);if((0!=(4&a.substep_shaping)||b.block_type!=Q.SHORT_TYPE)&&0==(128&a.substep_shaping)){c.calc_noise(b,e,h,new D,null);for(var i=0;i<576;i++){var k=0;0!=b.l3_enc[i]&&(k=Math.abs(b.xr[i])),g[i]=k}var i=0,l=8;b.block_type==Q.SHORT_TYPE&&(l=6);do{var m,n,o,p,q=b.width[l];if(i+=q,!(h[l]>=1||(j.sort(g,i-q,q),x.EQ(g[i-1],0)))){m=(1-h[l])*e[l],n=0,p=0;do{var r;for(o=1;p+o<q&&!x.NEQ(g[p+i-q],g[p+i+o-q]);o++);if(r=g[p+i-q]*g[p+i-q]*o,m<r){0!=p&&(n=g[p+i-q-1]);break}m-=r,p+=o}while(p<q);if(!x.EQ(n,0))do Math.abs(b.xr[i-q])<=n&&(b.l3_enc[i-q]=0);while(--q>0)}}while(++l<b.psymax);b.part2_3_length=f.noquant_count_bits(a,b,null)}},this.outer_loop=function(a,b,e,g,h,i){var s,j=a.internal_flags,l=new K,n=d(576),p=d(M.SFBMAX),q=new D,t=new L,u=9999999,w=!1,x=!1,y=0;if(m(j,b,i,h,g),0==j.noise_shaping)return 100;c.calc_noise(b,e,p,q,t),q.bits=b.part2_3_length,l.assign(b);var z=0;for(k.arraycopy(g,0,n,0,576);!w;){do{var B,A=new D,C=255;if(B=0!=(2&j.substep_shaping)?20:3,j.sfb21_extra){if(p[l.sfbmax]>1)break;if(l.block_type==Q.SHORT_TYPE&&(p[l.sfbmax+1]>1||p[l.sfbmax+2]>1))break}if(!v(a,l,p,g,x))break;0!=l.scalefac_scale&&(C=254);var E=i-l.part2_length;if(E<=0)break;for(;(l.part2_3_length=f.count_bits(j,g,l,t))>E&&l.global_gain<=C;)l.global_gain++;if(l.global_gain>C)break;if(0==q.over_count){for(;(l.part2_3_length=f.count_bits(j,g,l,t))>u&&l.global_gain<=C;)l.global_gain++;if(l.global_gain>C)break}if(c.calc_noise(l,e,p,A,t),A.bits=l.part2_3_length,s=b.block_type!=Q.SHORT_TYPE?a.quant_comp:a.quant_comp_short,s=r(s,q,A,l,p)?1:0,0!=s)u=b.part2_3_length,q=A,b.assign(l),z=0,k.arraycopy(g,0,n,0,576);else if(0==j.full_outer_loop){if(++z>B&&0==q.over_count)break;if(3==j.noise_shaping_amp&&x&&z>30)break;if(3==j.noise_shaping_amp&&x&&l.global_gain-y>15)break}}while(l.global_gain+l.scalefac_scale<255);3==j.noise_shaping_amp?x?w=!0:(l.assign(b),k.arraycopy(n,0,g,0,576),z=0,y=l.global_gain,x=!0):w=!0}return a.VBR==o.vbr_rh||a.VBR==o.vbr_mtrh?k.arraycopy(n,0,g,0,576):0!=(1&j.substep_shaping)&&trancate_smallspectrums(j,b,e,g),q.over_count},this.iteration_finish_one=function(a,c,d){var e=a.l3_side,g=e.tt[c][d];f.best_scalefac_store(a,c,d,e),1==a.use_best_huffman&&f.best_huffman_divide(a,g),b.ResvAdjust(a,g)},this.VBR_encode_granule=function(a,b,c,e,f,g,h){var q,r,i=a.internal_flags,l=new K,m=d(576),n=h,o=h+1,p=(h+g)/2,s=0,t=i.sfb21_extra;j.fill(l.l3_enc,0);do p>n-42?i.sfb21_extra=!1:i.sfb21_extra=t,r=outer_loop(a,b,c,e,f,p),r<=0?(s=1,o=b.part2_3_length,l.assign(b),k.arraycopy(e,0,m,0,576),h=o-32,q=h-g,p=(h+g)/2):(g=p+32,q=h-g,p=(h+g)/2,0!=s&&(s=2,b.assign(l),k.arraycopy(m,0,e,0,576)));while(q>12);i.sfb21_extra=t,2==s&&k.arraycopy(l.l3_enc,0,b.l3_enc,0,576)},this.get_framebits=function(c,d){var e=c.internal_flags;e.bitrate_index=e.VBR_min_bitrate;var f=a.getframebits(c);e.bitrate_index=1,f=a.getframebits(c);for(var g=1;g<=e.VBR_max_bitrate;g++){e.bitrate_index=g;var h=new B(f);d[g]=b.ResvFrameBegin(c,h),f=h.bits}},this.VBR_old_prepare=function(a,d,e,f,g,h,i,j,k){var m,l=a.internal_flags,n=0,o=1,p=0;l.bitrate_index=l.VBR_max_bitrate;var q=b.ResvFrameBegin(a,new B(0))/l.mode_gr;get_framebits(a,h);for(var r=0;r<l.mode_gr;r++){var s=c.on_pe(a,d,j[r],q,r,0);l.mode_ext==Q.MPG_MD_MS_LR&&(ms_convert(l.l3_side,r),c.reduce_side(j[r],e[r],q,s));for(var t=0;t<l.channels_out;++t){var u=l.l3_side.tt[r][t];u.block_type!=Q.SHORT_TYPE?(n=1.28/(1+Math.exp(3.5-d[r][t]/300))-.05,m=l.PSY.mask_adjust-n):(n=2.56/(1+Math.exp(3.5-d[r][t]/300))-.14,m=l.PSY.mask_adjust_short-n),l.masking_lower=Math.pow(10,.1*m),init_outer_loop(l,u),k[r][t]=c.calc_xmin(a,f[r][t],u,g[r][t]),0!=k[r][t]&&(o=0),i[r][t]=126,p+=j[r][t]}}for(var r=0;r<l.mode_gr;r++)for(var t=0;t<l.channels_out;t++)p>h[l.VBR_max_bitrate]&&(j[r][t]*=h[l.VBR_max_bitrate],j[r][t]/=p),i[r][t]>j[r][t]&&(i[r][t]=j[r][t]);return o},this.bitpressure_strategy=function(a,b,c,d){for(var e=0;e<a.mode_gr;e++)for(var f=0;f<a.channels_out;f++){for(var g=a.l3_side.tt[e][f],h=b[e][f],i=0,j=0;j<g.psy_lmax;j++)h[i++]*=1+.029*j*j/Q.SBMAX_l/Q.SBMAX_l;if(g.block_type==Q.SHORT_TYPE)for(var j=g.sfb_smin;j<Q.SBMAX_s;j++)h[i++]*=1+.029*j*j/Q.SBMAX_s/Q.SBMAX_s,h[i++]*=1+.029*j*j/Q.SBMAX_s/Q.SBMAX_s,h[i++]*=1+.029*j*j/Q.SBMAX_s/Q.SBMAX_s;d[e][f]=0|Math.max(c[e][f],.9*d[e][f])}},this.VBR_new_prepare=function(a,d,e,f,g,h){var m,i=a.internal_flags,j=1,k=0,l=0;if(a.free_format){i.bitrate_index=0;var n=new B(k);m=b.ResvFrameBegin(a,n),k=n.bits,g[0]=m}else{i.bitrate_index=i.VBR_max_bitrate;var n=new B(k);b.ResvFrameBegin(a,n),k=n.bits,get_framebits(a,g),m=g[i.VBR_max_bitrate]}for(var o=0;o<i.mode_gr;o++){c.on_pe(a,d,h[o],k,o,0),i.mode_ext==Q.MPG_MD_MS_LR&&ms_convert(i.l3_side,o);for(var p=0;p<i.channels_out;++p){var q=i.l3_side.tt[o][p];i.masking_lower=Math.pow(10,.1*i.PSY.mask_adjust),init_outer_loop(i,q),0!=c.calc_xmin(a,e[o][p],q,f[o][p])&&(j=0),l+=h[o][p]}}for(var o=0;o<i.mode_gr;o++)for(var p=0;p<i.channels_out;p++)l>m&&(h[o][p]*=m,h[o][p]/=l);return j},this.calc_target_bits=function(d,e,f,g,h,i){var l,m,n,o,j=d.internal_flags,k=j.l3_side,p=0;j.bitrate_index=j.VBR_max_bitrate;var q=new B(p);for(i[0]=b.ResvFrameBegin(d,q),p=q.bits,j.bitrate_index=1,p=a.getframebits(d)-8*j.sideinfo_len,h[0]=p/(j.mode_gr*j.channels_out),p=d.VBR_mean_bitrate_kbps*d.framesize*1e3,0!=(1&j.substep_shaping)&&(p*=1.09),p/=d.out_samplerate,p-=8*j.sideinfo_len,p/=j.mode_gr*j.channels_out,l=.93+.07*(11-d.compression_ratio)/5.5,l<.9&&(l=.9),l>1&&(l=1),m=0;m<j.mode_gr;m++){var r=0;for(n=0;n<j.channels_out;n++){if(g[m][n]=int(l*p),e[m][n]>700){var s=int((e[m][n]-700)/1.4),t=k.tt[m][n];g[m][n]=int(l*p),t.block_type==Q.SHORT_TYPE&&s<p/2&&(s=p/2),s>3*p/2?s=3*p/2:s<0&&(s=0),g[m][n]+=s}g[m][n]>V.MAX_BITS_PER_CHANNEL&&(g[m][n]=V.MAX_BITS_PER_CHANNEL),r+=g[m][n]}if(r>V.MAX_BITS_PER_GRANULE)for(n=0;n<j.channels_out;++n)g[m][n]*=V.MAX_BITS_PER_GRANULE,g[m][n]/=r}if(j.mode_ext==Q.MPG_MD_MS_LR)for(m=0;m<j.mode_gr;m++)c.reduce_side(g[m],f[m],p*j.channels_out,V.MAX_BITS_PER_GRANULE);for(o=0,m=0;m<j.mode_gr;m++)for(n=0;n<j.channels_out;n++)g[m][n]>V.MAX_BITS_PER_CHANNEL&&(g[m][n]=V.MAX_BITS_PER_CHANNEL),o+=g[m][n];if(o>i[0])for(m=0;m<j.mode_gr;m++)for(n=0;n<j.channels_out;n++)g[m][n]*=i[0],g[m][n]/=o}}function O(){function n(b,c,d){for(var e=10,f=c+238-14-286,g=-15;g<0;g++){var h,i,j;h=a[e+-10],i=b[f+-224]*h,j=b[c+224]*h,h=a[e+-9],i+=b[f+-160]*h,j+=b[c+160]*h,h=a[e+-8],i+=b[f+-96]*h,j+=b[c+96]*h,h=a[e+-7],i+=b[f+-32]*h,j+=b[c+32]*h,h=a[e+-6],i+=b[f+32]*h,j+=b[c+-32]*h,h=a[e+-5],i+=b[f+96]*h,j+=b[c+-96]*h,h=a[e+-4],i+=b[f+160]*h,j+=b[c+-160]*h,h=a[e+-3],i+=b[f+224]*h,j+=b[c+-224]*h,h=a[e+-2],i+=b[c+-256]*h,j-=b[f+256]*h,h=a[e+-1],i+=b[c+-192]*h,j-=b[f+192]*h,h=a[e+0],i+=b[c+-128]*h,j-=b[f+128]*h,h=a[e+1],i+=b[c+-64]*h,j-=b[f+64]*h,h=a[e+2],i+=b[c+0]*h,j-=b[f+0]*h,h=a[e+3],i+=b[c+64]*h,j-=b[f+-64]*h,h=a[e+4],i+=b[c+128]*h,j-=b[f+-128]*h,h=a[e+5],i+=b[c+192]*h,j-=b[f+-192]*h,i*=a[e+6],h=j-i,d[30+2*g]=j+i,d[31+2*g]=a[e+7]*h,e+=18,c--,f++}var i,j,k,m;j=b[c+-16]*a[e+-10],i=b[c+-32]*a[e+-2],j+=(b[c+-48]-b[c+16])*a[e+-9],i+=b[c+-96]*a[e+-1],j+=(b[c+-80]+b[c+48])*a[e+-8],i+=b[c+-160]*a[e+0],j+=(b[c+-112]-b[c+80])*a[e+-7],i+=b[c+-224]*a[e+1],j+=(b[c+-144]+b[c+112])*a[e+-6],i-=b[c+32]*a[e+2],j+=(b[c+-176]-b[c+144])*a[e+-5],i-=b[c+96]*a[e+3],j+=(b[c+-208]+b[c+176])*a[e+-4],i-=b[c+160]*a[e+4],j+=(b[c+-240]-b[c+208])*a[e+-3],i-=b[c+224],k=i-j,m=i+j,j=d[14],i=d[15]-j,d[31]=m+j,d[30]=k+i,d[15]=k-i,d[14]=m-j;var n;n=d[28]-d[0],d[0]+=d[28],d[28]=n*a[e+-36+7],n=d[29]-d[1],d[1]+=d[29],d[29]=n*a[e+-36+7],n=d[26]-d[2],d[2]+=d[26],d[26]=n*a[e+-72+7],n=d[27]-d[3],d[3]+=d[27],d[27]=n*a[e+-72+7],n=d[24]-d[4],d[4]+=d[24],d[24]=n*a[e+-108+7],n=d[25]-d[5],d[5]+=d[25],d[25]=n*a[e+-108+7],n=d[22]-d[6],d[6]+=d[22],d[22]=n*l.SQRT2,n=d[23]-d[7],d[7]+=d[23],d[23]=n*l.SQRT2-d[7],d[7]-=d[6],d[22]-=d[7],d[23]-=d[22],n=d[6],d[6]=d[31]-n,d[31]=d[31]+n,n=d[7],d[7]=d[30]-n,d[30]=d[30]+n,n=d[22],d[22]=d[15]-n,d[15]=d[15]+n,n=d[23],d[23]=d[14]-n,d[14]=d[14]+n,n=d[20]-d[8],d[8]+=d[20],d[20]=n*a[e+-180+7],n=d[21]-d[9],d[9]+=d[21],d[21]=n*a[e+-180+7],n=d[18]-d[10],d[10]+=d[18],d[18]=n*a[e+-216+7],n=d[19]-d[11],d[11]+=d[19],d[19]=n*a[e+-216+7],n=d[16]-d[12],d[12]+=d[16],d[16]=n*a[e+-252+7],n=d[17]-d[13],d[13]+=d[17],d[17]=n*a[e+-252+7],n=-d[20]+d[24],d[20]+=d[24],d[24]=n*a[e+-216+7],n=-d[21]+d[25],d[21]+=d[25],d[25]=n*a[e+-216+7],n=d[4]-d[8],d[4]+=d[8],d[8]=n*a[e+-216+7],n=d[5]-d[9],d[5]+=d[9],d[9]=n*a[e+-216+7],n=d[0]-d[12],d[0]+=d[12],d[12]=n*a[e+-72+7],n=d[1]-d[13],d[1]+=d[13],d[13]=n*a[e+-72+7],n=d[16]-d[28],d[16]+=d[28],d[28]=n*a[e+-72+7],n=-d[17]+d[29],d[17]+=d[29],d[29]=n*a[e+-72+7],n=l.SQRT2*(d[2]-d[10]),d[2]+=d[10],d[10]=n,n=l.SQRT2*(d[3]-d[11]),d[3]+=d[11],d[11]=n,n=l.SQRT2*(-d[18]+d[26]),d[18]+=d[26],d[26]=n-d[18],n=l.SQRT2*(-d[19]+d[27]),d[19]+=d[27],d[27]=n-d[19],n=d[2],d[19]-=d[3],d[3]-=n,d[2]=d[31]-n,d[31]+=n,n=d[3],d[11]-=d[19],d[18]-=n,d[3]=d[30]-n,d[30]+=n,n=d[18],d[27]-=d[11],d[19]-=n,d[18]=d[15]-n,d[15]+=n,n=d[19],d[10]-=n,d[19]=d[14]-n,d[14]+=n,n=d[10],d[11]-=n,d[10]=d[23]-n,d[23]+=n,n=d[11],d[26]-=n,d[11]=d[22]-n,d[22]+=n,n=d[26],d[27]-=n,d[26]=d[7]-n,d[7]+=n,n=d[27],d[27]=d[6]-n,d[6]+=n,n=l.SQRT2*(d[0]-d[4]),d[0]+=d[4],d[4]=n,n=l.SQRT2*(d[1]-d[5]),d[1]+=d[5],d[5]=n,n=l.SQRT2*(d[16]-d[20]),d[16]+=d[20],d[20]=n,n=l.SQRT2*(d[17]-d[21]),d[17]+=d[21],d[21]=n,n=-l.SQRT2*(d[8]-d[12]),d[8]+=d[12],d[12]=n-d[8],n=-l.SQRT2*(d[9]-d[13]),d[9]+=d[13],d[13]=n-d[9],n=-l.SQRT2*(d[25]-d[29]),d[25]+=d[29],d[29]=n-d[25],n=-l.SQRT2*(d[24]+d[28]),d[24]-=d[28],d[28]=n-d[24],n=d[24]-d[16],d[24]=n,n=d[20]-n,d[20]=n,n=d[28]-n,d[28]=n,n=d[25]-d[17],d[25]=n,n=d[21]-n,d[21]=n,n=d[29]-n,d[29]=n,n=d[17]-d[1],d[17]=n,n=d[9]-n,d[9]=n,n=d[25]-n,d[25]=n,n=d[5]-n,d[5]=n,n=d[21]-n,d[21]=n,n=d[13]-n,d[13]=n,n=d[29]-n,d[29]=n,n=d[1]-d[0],d[1]=n,n=d[16]-n,d[16]=n,n=d[17]-n,d[17]=n,n=d[8]-n,d[8]=n,n=d[9]-n,d[9]=n,n=d[24]-n,d[24]=n,n=d[25]-n,d[25]=n,n=d[4]-n,d[4]=n,n=d[5]-n,d[5]=n,n=d[20]-n,d[20]=n,n=d[21]-n,d[21]=n,n=d[12]-n;d[12]=n;n=d[13]-n,d[13]=n,n=d[28]-n,d[28]=n,n=d[29]-n,d[29]=n,n=d[0],d[0]+=d[31],d[31]-=n,n=d[1],d[1]+=d[30],d[30]-=n,n=d[16],d[16]+=d[15],d[15]-=n,n=d[17],d[17]+=d[14],d[14]-=n,n=d[8],d[8]+=d[23],d[23]-=n,n=d[9],d[9]+=d[22],d[22]-=n,n=d[24],d[24]+=d[7],d[7]-=n,n=d[25],d[25]+=d[6],d[6]-=n,n=d[4],d[4]+=d[27],d[27]-=n,n=d[5],d[5]+=d[26],d[26]-=n,n=d[20],d[20]+=d[11],d[11]-=n,n=d[21],d[21]+=d[10],d[10]-=n,n=d[12],d[12]+=d[19],d[19]-=n,n=d[13],d[13]+=d[18],d[18]-=n,n=d[28],d[28]+=d[3],d[3]-=n,n=d[29],d[29]+=d[2],d[2]-=n}function o(a,b){for(var c=0;c<3;c++){var d,f,g,h,i,j;h=a[b+6]*e[Q.SHORT_TYPE][0]-a[b+15],d=a[b+0]*e[Q.SHORT_TYPE][2]-a[b+9],f=h+d,g=h-d,h=a[b+15]*e[Q.SHORT_TYPE][0]+a[b+6],d=a[b+9]*e[Q.SHORT_TYPE][2]+a[b+0],i=h+d,j=-h+d,d=2.069978111953089e-11*(a[b+3]*e[Q.SHORT_TYPE][1]-a[b+12]),h=2.069978111953089e-11*(a[b+12]*e[Q.SHORT_TYPE][1]+a[b+3]),a[b+0]=1.90752519173728e-11*f+d,a[b+15]=1.90752519173728e-11*-i+h,g=.8660254037844387*g*1.907525191737281e-11,i=.5*i*1.907525191737281e-11+h,a[b+3]=g-i,a[b+6]=g+i,f=.5*f*1.907525191737281e-11-d,j=.8660254037844387*j*1.907525191737281e-11,a[b+9]=f+j,a[b+12]=f-j,b++}}function p(a,b,c){var d,e,f,h,i,j,k,l,m,n;f=c[17]-c[9],i=c[15]-c[11],j=c[14]-c[12],k=c[0]+c[8],l=c[1]+c[7],m=c[2]+c[6],n=c[3]+c[5],a[b+17]=k+m-n-(l-c[4]),e=(k+m-n)*g[19]+(l-c[4]),d=(f-i-j)*g[18],a[b+5]=d+e,a[b+6]=d-e,h=(c[16]-c[10])*g[18],l=l*g[19]+c[4],d=f*g[12]+h+i*g[13]+j*g[14],e=-k*g[16]+l-m*g[17]+n*g[15],a[b+1]=d+e,a[b+2]=d-e,d=f*g[13]-h-i*g[14]+j*g[12],e=-k*g[17]+l-m*g[15]+n*g[16],a[b+9]=d+e,a[b+10]=d-e,d=f*g[14]-h+i*g[12]-j*g[13],e=k*g[15]-l+m*g[16]-n*g[17],a[b+13]=d+e,a[b+14]=d-e;var o,p,q,r,s,t,u,v;o=c[8]-c[0],q=c[6]-c[2],r=c[5]-c[3],s=c[17]+c[9],t=c[16]+c[10],u=c[15]+c[11],v=c[14]+c[12],a[b+0]=s+u+v+(t+c[13]),d=(s+u+v)*g[19]-(t+c[13]),e=(o-q+r)*g[18],a[b+11]=d+e,a[b+12]=d-e,p=(c[7]-c[1])*g[18],t=c[13]-t*g[19],d=s*g[15]-t+u*g[16]+v*g[17],e=o*g[14]+p+q*g[12]+r*g[13],a[b+3]=d+e,a[b+4]=d-e,d=-s*g[17]+t-u*g[15]-v*g[16],e=o*g[13]+p-q*g[14]-r*g[12],a[b+7]=d+e,a[b+8]=d-e,d=-s*g[16]+t-u*g[17]-v*g[15],e=o*g[12]-p+q*g[13]-r*g[14],a[b+15]=d+e,a[b+16]=d-e}var a=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*l.SQRT2*.5/2384e-9,.017876148*l.SQRT2*.5/2384e-9,.003134727*l.SQRT2*.5/2384e-9,.002457142*l.SQRT2*.5/2384e-9,971317e-9*l.SQRT2*.5/2384e-9,218868e-9*l.SQRT2*.5/2384e-9,101566e-9*l.SQRT2*.5/2384e-9,13828e-9*l.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,49591e-9/2384e-9,1995.1556208053692,21458e-9/2384e-9,-69618e-9/2384e-9],b=12,c=36,e=[[2.382191739347913e-13,6.423305872147834e-13,9.400849094049688e-13,1.122435026096556e-12,1.183840321267481e-12,1.122435026096556e-12,9.40084909404969e-13,6.423305872147839e-13,2.382191739347918e-13,5.456116108943412e-12,4.878985199565852e-12,4.240448995017367e-12,3.559909094758252e-12,2.858043359288075e-12,2.156177623817898e-12,1.475637723558783e-12,8.371015190102974e-13,2.599706096327376e-13,-5.456116108943412e-12,-4.878985199565852e-12,-4.240448995017367e-12,-3.559909094758252e-12,-2.858043359288076e-12,-2.156177623817898e-12,-1.475637723558783e-12,-8.371015190102975e-13,-2.599706096327376e-13,-2.382191739347923e-13,-6.423305872147843e-13,-9.400849094049696e-13,-1.122435026096556e-12,-1.183840321267481e-12,-1.122435026096556e-12,-9.400849094049694e-13,-6.42330587214784e-13,-2.382191739347918e-13],[2.382191739347913e-13,6.423305872147834e-13,9.400849094049688e-13,1.122435026096556e-12,1.183840321267481e-12,1.122435026096556e-12,9.400849094049688e-13,6.423305872147841e-13,2.382191739347918e-13,5.456116108943413e-12,4.878985199565852e-12,4.240448995017367e-12,3.559909094758253e-12,2.858043359288075e-12,2.156177623817898e-12,1.475637723558782e-12,8.371015190102975e-13,2.599706096327376e-13,-5.461314069809755e-12,-4.921085770524055e-12,-4.343405037091838e-12,-3.732668368707687e-12,-3.093523840190885e-12,-2.430835727329465e-12,-1.734679010007751e-12,-9.74825365660928e-13,-2.797435120168326e-13,0,0,0,0,0,0,-2.283748241799531e-13,-4.037858874020686e-13,-2.146547464825323e-13],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2.283748241799531e-13,4.037858874020686e-13,2.146547464825323e-13,5.461314069809755e-12,4.921085770524055e-12,4.343405037091838e-12,3.732668368707687e-12,3.093523840190885e-12,2.430835727329466e-12,1.734679010007751e-12,9.74825365660928e-13,2.797435120168326e-13,-5.456116108943413e-12,-4.878985199565852e-12,-4.240448995017367e-12,-3.559909094758253e-12,-2.858043359288075e-12,-2.156177623817898e-12,-1.475637723558782e-12,-8.371015190102975e-13,-2.599706096327376e-13,-2.382191739347913e-13,-6.423305872147834e-13,-9.400849094049688e-13,-1.122435026096556e-12,-1.183840321267481e-12,-1.122435026096556e-12,-9.400849094049688e-13,-6.423305872147841e-13,-2.382191739347918e-13]],f=e[Q.SHORT_TYPE],g=e[Q.SHORT_TYPE],h=e[Q.SHORT_TYPE],i=e[Q.SHORT_TYPE],m=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];this.mdct_sub48=function(a,g,l){for(var q=g,r=286,s=0;s<a.channels_out;s++){for(var t=0;t<a.mode_gr;t++){for(var u,v=a.l3_side.tt[t][s],w=v.xr,x=0,y=a.sb_sample[s][1-t],z=0,A=0;A<9;A++)for(n(q,r,y[z]),n(q,r+32,y[z+1]),z+=2,r+=64,u=1;u<32;u+=2)y[z-1][u]*=-1;for(u=0;u<32;u++,x+=18){var B=v.block_type,C=a.sb_sample[s][t],D=a.sb_sample[s][1-t];if(0!=v.mixed_block_flag&&u<2&&(B=0),a.amp_filter[u]<1e-12)j.fill(w,x+0,x+18,0);else{if(a.amp_filter[u]<1)for(var A=0;A<18;A++)D[A][m[u]]*=a.amp_filter[u];if(B==Q.SHORT_TYPE){for(var A=-b/4;A<0;A++){var E=e[Q.SHORT_TYPE][A+3];w[x+3*A+9]=C[9+A][m[u]]*E-C[8-A][m[u]],w[x+3*A+18]=C[14-A][m[u]]*E+C[15+A][m[u]],w[x+3*A+10]=C[15+A][m[u]]*E-C[14-A][m[u]],w[x+3*A+19]=D[2-A][m[u]]*E+D[3+A][m[u]],w[x+3*A+11]=D[3+A][m[u]]*E-D[2-A][m[u]],w[x+3*A+20]=D[8-A][m[u]]*E+D[9+A][m[u]]}o(w,x)}else{for(var F=d(18),A=-c/4;A<0;A++){var G,H;G=e[B][A+27]*D[A+9][m[u]]+e[B][A+36]*D[8-A][m[u]],H=e[B][A+9]*C[A+9][m[u]]-e[B][A+18]*C[8-A][m[u]],F[A+9]=G-H*f[3+A+9],F[A+18]=G*f[3+A+9]+H}p(w,x,F)}}if(B!=Q.SHORT_TYPE&&0!=u)for(var A=7;A>=0;--A){var I,J;I=w[x+A]*h[20+A]+w[x+-1-A]*i[28+A],J=w[x+A]*i[28+A]-w[x+-1-A]*h[20+A],w[x+-1-A]=I,w[x+A]=J}}}if(q=l,r=286,1==a.mode_gr)for(var K=0;K<18;K++)k.arraycopy(a.sb_sample[s][1][K],0,a.sb_sample[s][0][K],0,32)}}}function P(){this.thm=new U,this.en=new U}function Q(){function m(a){var b,c;if(0==a.ATH.useAdjust)return void(a.ATH.adjust=1);if(c=a.loudness_sq[0][0],b=a.loudness_sq[1][0],2==a.channels_out?(c+=a.loudness_sq[0][1],b+=a.loudness_sq[1][1]):(c+=c,b+=b),2==a.mode_gr&&(c=Math.max(c,b)),c*=.5,c*=a.ATH.aaSensitivityP,c>.03125)a.ATH.adjust>=1?a.ATH.adjust=1:a.ATH.adjust<a.ATH.adjustLimit&&(a.ATH.adjust=a.ATH.adjustLimit),a.ATH.adjustLimit=1;else{var d=31.98*c+625e-6;a.ATH.adjust>=d?(a.ATH.adjust*=.075*d+.925,a.ATH.adjust<d&&(a.ATH.adjust=d)):a.ATH.adjustLimit>=d?a.ATH.adjust=d:a.ATH.adjust<a.ATH.adjustLimit&&(a.ATH.adjust=a.ATH.adjustLimit),a.ATH.adjustLimit=d}}function n(a){var b,c;for(a.bitrate_stereoMode_Hist[a.bitrate_index][4]++,a.bitrate_stereoMode_Hist[15][4]++,2==a.channels_out&&(a.bitrate_stereoMode_Hist[a.bitrate_index][a.mode_ext]++,a.bitrate_stereoMode_Hist[15][a.mode_ext]++),b=0;b<a.mode_gr;++b)for(c=0;c<a.channels_out;++c){var d=0|a.l3_side.tt[b][c].block_type;0!=a.l3_side.tt[b][c].mixed_block_flag&&(d=4),a.bitrate_blockType_Hist[a.bitrate_index][d]++,a.bitrate_blockType_Hist[a.bitrate_index][5]++,a.bitrate_blockType_Hist[15][d]++,a.bitrate_blockType_Hist[15][5]++}}function p(a,b){var e,f,c=a.internal_flags;if(0==c.lame_encode_frame_init){var g,h,i=d(2014),j=d(2014);for(c.lame_encode_frame_init=1,g=0,h=0;g<286+576*(1+c.mode_gr);++g)g<576*c.mode_gr?(i[g]=0,2==c.channels_out&&(j[g]=0)):(i[g]=b[0][h],2==c.channels_out&&(j[g]=b[1][h]),++h);for(f=0;f<c.mode_gr;f++)for(e=0;e<c.channels_out;e++)c.l3_side.tt[f][e].block_type=Q.SHORT_TYPE;l.mdct_sub48(c,i,j)}}var a=Q.FFTOFFSET,b=Q.MPG_MD_MS_LR,e=null;this.psy=null;var g=null,h=null,j=null;this.setModules=function(a,b,c,d){e=a,this.psy=b,g=b,h=d,j=c};var l=new O;this.lame_encode_mp3_frame=function(d,q,s,t,u,v){var w,x=i([2,2]);x[0][0]=new P,x[0][1]=new P,x[1][0]=new P,x[1][1]=new P;var y=i([2,2]);y[0][0]=new P,y[0][1]=new P,y[1][0]=new P,y[1][1]=new P;var z,G,H,I,A=[null,null],B=d.internal_flags,C=f([2,4]),D=[.5,.5],E=[[0,0],[0,0]],F=[[0,0],[0,0]];if(A[0]=q,A[1]=s,0==B.lame_encode_frame_init&&p(d,A),B.padding=0,(B.slot_lag-=B.frac_SpF)<0&&(B.slot_lag+=d.out_samplerate,B.padding=1),0!=B.psymodel){var J,K=[null,null],L=0,M=c(2);for(I=0;I<B.mode_gr;I++){for(H=0;H<B.channels_out;H++)K[H]=A[H],L=576+576*I-Q.FFTOFFSET;if(J=d.VBR==o.vbr_mtrh||d.VBR==o.vbr_mt?g.L3psycho_anal_vbr(d,K,L,I,x,y,E[I],F[I],C[I],M):g.L3psycho_anal_ns(d,K,L,I,x,y,E[I],F[I],C[I],M),0!=J)return-4;for(d.mode==r.JOINT_STEREO&&(D[I]=C[I][2]+C[I][3],D[I]>0&&(D[I]=C[I][3]/D[I])),H=0;H<B.channels_out;H++){var N=B.l3_side.tt[I][H];N.block_type=M[H],N.mixed_block_flag=0}}}else for(I=0;I<B.mode_gr;I++)for(H=0;H<B.channels_out;H++)B.l3_side.tt[I][H].block_type=Q.NORM_TYPE,B.l3_side.tt[I][H].mixed_block_flag=0,F[I][H]=E[I][H]=700;if(m(B),l.mdct_sub48(B,A[0],A[1]),B.mode_ext=Q.MPG_MD_LR_LR,d.force_ms)B.mode_ext=Q.MPG_MD_MS_LR;else if(d.mode==r.JOINT_STEREO){var O=0,R=0;for(I=0;I<B.mode_gr;I++)for(H=0;H<B.channels_out;H++)O+=F[I][H],R+=E[I][H];if(O<=1*R){var S=B.l3_side.tt[0],T=B.l3_side.tt[B.mode_gr-1];S[0].block_type==S[1].block_type&&T[0].block_type==T[1].block_type&&(B.mode_ext=Q.MPG_MD_MS_LR)}}if(B.mode_ext==b?(z=y,G=F):(z=x,G=E),d.analysis&&null!=B.pinfo)for(I=0;I<B.mode_gr;I++)for(H=0;H<B.channels_out;H++)B.pinfo.ms_ratio[I]=B.ms_ratio[I],B.pinfo.ms_ener_ratio[I]=D[I],B.pinfo.blocktype[I][H]=B.l3_side.tt[I][H].block_type,B.pinfo.pe[I][H]=G[I][H],k.arraycopy(B.l3_side.tt[I][H].xr,0,B.pinfo.xr[I][H],0,576),B.mode_ext==b&&(B.pinfo.ers[I][H]=B.pinfo.ers[I][H+2],k.arraycopy(B.pinfo.energy[I][H+2],0,B.pinfo.energy[I][H],0,B.pinfo.energy[I][H].length));if(d.VBR==o.vbr_off||d.VBR==o.vbr_abr){var U,V;for(U=0;U<18;U++)B.nsPsy.pefirbuf[U]=B.nsPsy.pefirbuf[U+1];for(V=0,I=0;I<B.mode_gr;I++)for(H=0;H<B.channels_out;H++)V+=G[I][H];for(B.nsPsy.pefirbuf[18]=V,V=B.nsPsy.pefirbuf[9],U=0;U<9;U++)V+=(B.nsPsy.pefirbuf[U]+B.nsPsy.pefirbuf[18-U])*Q.fircoef[U];for(V=3350*B.mode_gr*B.channels_out/V,I=0;I<B.mode_gr;I++)for(H=0;H<B.channels_out;H++)G[I][H]*=V}if(B.iteration_loop.iteration_loop(d,G,D,z),e.format_bitstream(d),w=e.copy_buffer(B,t,u,v,1),d.bWriteVbrTag&&h.addVbrFrame(d),d.analysis&&null!=B.pinfo){for(H=0;H<B.channels_out;H++){var W;for(W=0;W<a;W++)B.pinfo.pcmdata[H][W]=B.pinfo.pcmdata[H][W+d.framesize];for(W=a;W<1600;W++)B.pinfo.pcmdata[H][W]=A[H][W-a]}j.set_frame_pinfo(d,z)}return n(B),w}}function R(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function S(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[c(4),c(4)];for(var a=0;a<2;a++)for(var b=0;b<2;b++)this.tt[a][b]=new K}function T(){this.last_en_subshort=f([4,9]),this.lastAttacks=c(4),this.pefirbuf=d(19),this.longfact=d(Q.SBMAX_l),this.shortfact=d(Q.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function U(){this.l=d(Q.SBMAX_l),this.s=f([Q.SBMAX_s,3]);var a=this;this.assign=function(b){k.arraycopy(b.l,0,a.l,0,Q.SBMAX_l);for(var c=0;c<Q.SBMAX_s;c++)for(var d=0;d<3;d++)a.s[c][d]=b.s[c][d]}}function V(){function h(){this.write_timing=0,this.ptr=0,this.buf=a(b)}var b=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=f([2,V.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new S,this.ms_ratio=d(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=c(2),this.CurrentStep=c(2),this.masking_lower=0,this.bv_scf=c(576),this.pseudohalf=c(M.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*V.BPC+1),this.itime=e(2),this.sideinfo_len=0,this.sb_sample=f([2,2,18,Q.SBLIMIT]),this.amp_filter=d(32),this.header=new Array(V.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new I,this.minval_l=d(Q.CBANDS),this.minval_s=d(Q.CBANDS),this.nb_1=f([4,Q.CBANDS]),this.nb_2=f([4,Q.CBANDS]),this.nb_s1=f([4,Q.CBANDS]),this.nb_s2=f([4,Q.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=d(4),this.loudness_sq=f([2,2]),this.loudness_sq_save=d(2),this.mld_l=d(Q.SBMAX_l),this.mld_s=d(Q.SBMAX_s),this.bm_l=c(Q.SBMAX_l),this.bo_l=c(Q.SBMAX_l),this.bm_s=c(Q.SBMAX_s),this.bo_s=c(Q.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=g([Q.CBANDS,2]),this.s3ind_s=g([Q.CBANDS,2]),this.numlines_s=c(Q.CBANDS),this.numlines_l=c(Q.CBANDS),this.rnumlines_l=d(Q.CBANDS),this.mld_cb_l=d(Q.CBANDS),this.mld_cb_s=d(Q.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=d(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=c(2),this.nsPsy=new T,this.VBR_seek_table=new R,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=g([16,5]),this.bitrate_blockType_Hist=g([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var i=0;i<this.en.length;i++)this.en[i]=new U;for(var i=0;i<this.thm.length;i++)this.thm[i]=new U;
for(var i=0;i<this.header.length;i++)this.header[i]=new h}function W(){function e(a,b,d){var f,g,h,e=0;d<<=1;var i=b+d;f=4;do{var j,k,m,n,o,p,q;q=f>>1,n=f,o=f<<1,p=o+n,f=o<<1,g=b,h=g+q;do{var r,s,t,u;s=a[g+0]-a[g+n],r=a[g+0]+a[g+n],u=a[g+o]-a[g+p],t=a[g+o]+a[g+p],a[g+o]=r-t,a[g+0]=r+t,a[g+p]=s-u,a[g+n]=s+u,s=a[h+0]-a[h+n],r=a[h+0]+a[h+n],u=l.SQRT2*a[h+p],t=l.SQRT2*a[h+o],a[h+o]=r-t,a[h+0]=r+t,a[h+p]=s-u,a[h+n]=s+u,h+=f,g+=f}while(g<i);for(k=c[e+0],j=c[e+1],m=1;m<q;m++){var v,w;v=1-2*j*j,w=2*j*k,g=b+m,h=b+n-m;do{var x,y,z,r,s,A,t,B,u,C;y=w*a[g+n]-v*a[h+n],x=v*a[g+n]+w*a[h+n],s=a[g+0]-x,r=a[g+0]+x,A=a[h+0]-y,z=a[h+0]+y,y=w*a[g+p]-v*a[h+p],x=v*a[g+p]+w*a[h+p],u=a[g+o]-x,t=a[g+o]+x,C=a[h+o]-y,B=a[h+o]+y,y=j*t-k*C,x=k*t+j*C,a[g+o]=r-x,a[g+0]=r+x,a[h+p]=A-y,a[h+n]=A+y,y=k*B-j*u,x=j*B+k*u,a[h+o]=z-x,a[h+0]=z+x,a[g+p]=s-y,a[g+n]=s+y,h+=f,g+=f}while(g<i);v=k,k=v*c[e+0]-j*c[e+1],j=v*c[e+1]+j*c[e+0]}e+=2}while(f<d)}var a=d(Q.BLKSIZE),b=d(Q.BLKSIZE_s/2),c=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475],f=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(a,c,d,g,h){for(var i=0;i<3;i++){var j=Q.BLKSIZE_s/2,k=65535&192*(i+1),l=Q.BLKSIZE_s/8-1;do{var m,n,o,p,q,r=255&f[l<<2];m=b[r]*g[d][h+r+k],q=b[127-r]*g[d][h+r+k+128],n=m-q,m+=q,o=b[r+64]*g[d][h+r+k+64],q=b[63-r]*g[d][h+r+k+192],p=o-q,o+=q,j-=4,c[i][j+0]=m+o,c[i][j+2]=m-o,c[i][j+1]=n+p,c[i][j+3]=n-p,m=b[r+1]*g[d][h+r+k+1],q=b[126-r]*g[d][h+r+k+129],n=m-q,m+=q,o=b[r+65]*g[d][h+r+k+65],q=b[62-r]*g[d][h+r+k+193],p=o-q,o+=q,c[i][j+Q.BLKSIZE_s/2+0]=m+o,c[i][j+Q.BLKSIZE_s/2+2]=m-o,c[i][j+Q.BLKSIZE_s/2+1]=n+p,c[i][j+Q.BLKSIZE_s/2+3]=n-p}while(--l>=0);e(c[i],j,Q.BLKSIZE_s/2)}},this.fft_long=function(b,c,d,g,h){var i=Q.BLKSIZE/8-1,j=Q.BLKSIZE/2;do{var k,l,m,n,o,p=255&f[i];k=a[p]*g[d][h+p],o=a[p+512]*g[d][h+p+512],l=k-o,k+=o,m=a[p+256]*g[d][h+p+256],o=a[p+768]*g[d][h+p+768],n=m-o,m+=o,j-=4,c[j+0]=k+m,c[j+2]=k-m,c[j+1]=l+n,c[j+3]=l-n,k=a[p+1]*g[d][h+p+1],o=a[p+513]*g[d][h+p+513],l=k-o,k+=o,m=a[p+257]*g[d][h+p+257],o=a[p+769]*g[d][h+p+769],n=m-o,m+=o,c[j+Q.BLKSIZE/2+0]=k+m,c[j+Q.BLKSIZE/2+2]=k-m,c[j+Q.BLKSIZE/2+1]=l+n,c[j+Q.BLKSIZE/2+3]=l-n}while(--i>=0);e(c,j,Q.BLKSIZE/2)},this.init_fft=function(c){for(var d=0;d<Q.BLKSIZE;d++)a[d]=.42-.5*Math.cos(2*Math.PI*(d+.5)/Q.BLKSIZE)+.08*Math.cos(4*Math.PI*(d+.5)/Q.BLKSIZE);for(var d=0;d<Q.BLKSIZE_s/2;d++)b[d]=.5*(1-Math.cos(2*Math.PI*(d+.5)/Q.BLKSIZE_s))}}function X(){function A(a){return a}function B(a,b){for(var c=0,d=0;d<Q.BLKSIZE/2;++d)c+=a[d]*b.ATH.eql_w[d];return c*=p}function C(b,c,d,e,f,g,h,i,j,k,m){var n=b.internal_flags;if(j<2)a.fft_long(n,e[f],j,k,m),a.fft_short(n,g[h],j,k,m);else if(2==j){for(var o=Q.BLKSIZE-1;o>=0;--o){var p=e[f+0][o],q=e[f+1][o];e[f+0][o]=(p+q)*l.SQRT2*.5,e[f+1][o]=(p-q)*l.SQRT2*.5}for(var r=2;r>=0;--r)for(var o=Q.BLKSIZE_s-1;o>=0;--o){var p=g[h+0][r][o],q=g[h+1][r][o];g[h+0][r][o]=(p+q)*l.SQRT2*.5,g[h+1][r][o]=(p-q)*l.SQRT2*.5}}c[0]=A(e[f+0][0]),c[0]*=c[0];for(var o=Q.BLKSIZE/2-1;o>=0;--o){var s=e[f+0][Q.BLKSIZE/2-o],t=e[f+0][Q.BLKSIZE/2+o];c[Q.BLKSIZE/2-o]=A(.5*(s*s+t*t))}for(var r=2;r>=0;--r){d[r][0]=g[h+0][r][0],d[r][0]*=d[r][0];for(var o=Q.BLKSIZE_s/2-1;o>=0;--o){var s=g[h+0][r][Q.BLKSIZE_s/2-o],t=g[h+0][r][Q.BLKSIZE_s/2+o];d[r][Q.BLKSIZE_s/2-o]=A(.5*(s*s+t*t))}}for(var u=0,o=11;o<Q.HBLKSIZE;o++)u+=c[o];if(n.tot_ener[j]=u,b.analysis){for(var o=0;o<Q.HBLKSIZE;o++)n.pinfo.energy[i][j][o]=n.pinfo.energy_save[j][o],n.pinfo.energy_save[j][o]=c[o];n.pinfo.pe[i][j]=n.pe[j]}2==b.athaa_loudapprox&&j<2&&(n.loudness_sq[i][j]=n.loudness_sq_save[j],n.loudness_sq_save[j]=B(c,n))}function K(){G=Math.pow(10,(D+1)/16),H=Math.pow(10,(E+1)/16),I=Math.pow(10,F/10)}function O(a,b,c,d,e,f){var g;if(b>a){if(!(b<a*H))return a+b;g=b/a}else{if(a>=b*H)return a+b;g=a/b}if(a+=b,d+3<=6){if(g>=G)return a;var h=0|l.FAST_LOG10_X(g,16);return a*M[h]}var h=0|l.FAST_LOG10_X(g,16);if(b=0!=f?e.ATH.cb_s[c]*e.ATH.adjust:e.ATH.cb_l[c]*e.ATH.adjust,a<I*b){if(a>b){var i,j;return i=1,h<=13&&(i=N[h]),j=l.FAST_LOG10_X(a/b,10/15),a*((L[h]-i)*j+i)}return h>13?a:a*N[h]}return a*L[h]}function R(a,b,c){var d;if(a<0&&(a=0),b<0&&(b=0),a<=0)return b;if(b<=0)return a;if(d=b>a?b/a:a/b,-2<=c&&c<=2){if(d>=G)return a+b;var e=0|l.FAST_LOG10_X(d,16);return(a+b)*P[e]}return d<H?a+b:(a<b&&(a=b),a)}function S(a,b){var c=a.internal_flags;if(c.channels_out>1){for(var d=0;d<Q.SBMAX_l;d++){var e=c.thm[0].l[d],f=c.thm[1].l[d];c.thm[0].l[d]+=f*b,c.thm[1].l[d]+=e*b}for(var d=0;d<Q.SBMAX_s;d++)for(var g=0;g<3;g++){var e=c.thm[0].s[d][g],f=c.thm[1].s[d][g];c.thm[0].s[d][g]+=f*b,c.thm[1].s[d][g]+=e*b}}}function T(a){for(var b=0;b<Q.SBMAX_l;b++)if(!(a.thm[0].l[b]>1.58*a.thm[1].l[b]||a.thm[1].l[b]>1.58*a.thm[0].l[b])){var c=a.mld_l[b]*a.en[3].l[b],d=Math.max(a.thm[2].l[b],Math.min(a.thm[3].l[b],c));c=a.mld_l[b]*a.en[2].l[b];var e=Math.max(a.thm[3].l[b],Math.min(a.thm[2].l[b],c));a.thm[2].l[b]=d,a.thm[3].l[b]=e}for(var b=0;b<Q.SBMAX_s;b++)for(var f=0;f<3;f++)if(!(a.thm[0].s[b][f]>1.58*a.thm[1].s[b][f]||a.thm[1].s[b][f]>1.58*a.thm[0].s[b][f])){var c=a.mld_s[b]*a.en[3].s[b][f],d=Math.max(a.thm[2].s[b][f],Math.min(a.thm[3].s[b][f],c));c=a.mld_s[b]*a.en[2].s[b][f];var e=Math.max(a.thm[3].s[b][f],Math.min(a.thm[2].s[b][f],c));a.thm[2].s[b][f]=d,a.thm[3].s[b][f]=e}}function U(a,b,c){var d=b,e=Math.pow(10,c);b*=2,d*=2;for(var f=0;f<Q.SBMAX_l;f++){var g,h,i,j;if(j=a.ATH.cb_l[a.bm_l[f]]*e,g=Math.min(Math.max(a.thm[0].l[f],j),Math.max(a.thm[1].l[f],j)),h=Math.max(a.thm[2].l[f],j),i=Math.max(a.thm[3].l[f],j),g*b<h+i){var k=g*d/(h+i);h*=k,i*=k}a.thm[2].l[f]=Math.min(h,a.thm[2].l[f]),a.thm[3].l[f]=Math.min(i,a.thm[3].l[f])}e*=Q.BLKSIZE_s/Q.BLKSIZE;for(var f=0;f<Q.SBMAX_s;f++)for(var l=0;l<3;l++){var g,h,i,j;if(j=a.ATH.cb_s[a.bm_s[f]]*e,g=Math.min(Math.max(a.thm[0].s[f][l],j),Math.max(a.thm[1].s[f][l],j)),h=Math.max(a.thm[2].s[f][l],j),i=Math.max(a.thm[3].s[f][l],j),g*b<h+i){var k=g*b/(h+i);h*=k,i*=k}a.thm[2].s[f][l]=Math.min(a.thm[2].s[f][l],h),a.thm[3].s[f][l]=Math.min(a.thm[3].s[f][l],i)}}function V(a,b,c,d,e){var f,g,h=0,i=0;for(f=g=0;f<Q.SBMAX_s;++g,++f){for(var j=a.bo_s[f],k=a.npart_s,l=j<k?j:k;g<l;)h+=b[g],i+=c[g],g++;if(a.en[d].s[f][e]=h,a.thm[d].s[f][e]=i,g>=k){++f;break}var m=a.PSY.bo_s_weight[f],n=1-m;h=m*b[g],i=m*c[g],a.en[d].s[f][e]+=h,a.thm[d].s[f][e]+=i,h=n*b[g],i=n*c[g]}for(;f<Q.SBMAX_s;++f)a.en[d].s[f][e]=0,a.thm[d].s[f][e]=0}function X(a,b,c,d){var e,f,g=0,h=0;for(e=f=0;e<Q.SBMAX_l;++f,++e){for(var i=a.bo_l[e],j=a.npart_l,k=i<j?i:j;f<k;)g+=b[f],h+=c[f],f++;if(a.en[d].l[e]=g,a.thm[d].l[e]=h,f>=j){++e;break}var l=a.PSY.bo_l_weight[e],m=1-l;g=l*b[f],h=l*c[f],a.en[d].l[e]+=g,a.thm[d].l[e]+=h,g=m*b[f],h=m*c[f]}for(;e<Q.SBMAX_l;++e)a.en[d].l[e]=0,a.thm[d].l[e]=0}function Y(a,b,c,d,e,f){var j,k,g=a.internal_flags;for(k=j=0;k<g.npart_s;++k){for(var l=0,m=0,n=g.numlines_s[k],o=0;o<n;++o,++j){var p=b[f][j];l+=p,m<p&&(m=p)}c[k]=l}for(j=k=0;k<g.npart_s;k++){var q=g.s3ind_s[k][0],r=g.s3_ss[j++]*c[q];for(++q;q<=g.s3ind_s[k][1];)r+=g.s3_ss[j]*c[q],++j,++q;var s=h*g.nb_s1[e][k];if(d[k]=Math.min(r,s),g.blocktype_old[1&e]==Q.SHORT_TYPE){var s=i*g.nb_s2[e][k],t=d[k];d[k]=Math.min(s,t)}g.nb_s2[e][k]=g.nb_s1[e][k],g.nb_s1[e][k]=r}for(;k<=Q.CBANDS;++k)c[k]=0,d[k]=0}function Z(a,b,c,d){var e=a.internal_flags;a.short_blocks!=m.short_block_coupled||0!=b[0]&&0!=b[1]||(b[0]=b[1]=0);for(var f=0;f<e.channels_out;f++)d[f]=Q.NORM_TYPE,a.short_blocks==m.short_block_dispensed&&(b[f]=1),a.short_blocks==m.short_block_forced&&(b[f]=0),0!=b[f]?e.blocktype_old[f]==Q.SHORT_TYPE&&(d[f]=Q.STOP_TYPE):(d[f]=Q.SHORT_TYPE,e.blocktype_old[f]==Q.NORM_TYPE&&(e.blocktype_old[f]=Q.START_TYPE),e.blocktype_old[f]==Q.STOP_TYPE&&(e.blocktype_old[f]=Q.SHORT_TYPE)),c[f]=e.blocktype_old[f],e.blocktype_old[f]=d[f]}function $(a,b,c){return c>=1?a:c<=0?b:b>0?Math.pow(a/b,c)*b:0}function aa(a,c){for(var d=309.07,e=0;e<Q.SBMAX_s-1;e++)for(var f=0;f<3;f++){var g=a.thm.s[e][f];if(g>0){var h=g*c,i=a.en.s[e][f];i>h&&(d+=i>1e10*h?_[e]*(10*b):_[e]*l.FAST_LOG10(i/h))}}return d}function ca(a,c){for(var d=281.0575,e=0;e<Q.SBMAX_l-1;e++){var f=a.thm.l[e];if(f>0){var g=f*c,h=a.en.l[e];h>g&&(d+=h>1e10*g?ba[e]*(10*b):ba[e]*l.FAST_LOG10(h/g))}}return d}function da(a,b,c,d,e){var f,g;for(f=g=0;f<a.npart_l;++f){var j,h=0,i=0;for(j=0;j<a.numlines_l[f];++j,++g){var k=b[g];h+=k,i<k&&(i=k)}c[f]=h,d[f]=i,e[f]=h*a.rnumlines_l[f]}}function ea(a,b,c,d){var e=J.length-1,f=0,g=c[f]+c[f+1];if(g>0){var h=b[f];h<b[f+1]&&(h=b[f+1]),g=20*(2*h-g)/(g*(a.numlines_l[f]+a.numlines_l[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;for(f=1;f<a.npart_l-1;f++)if(g=c[f-1]+c[f]+c[f+1],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),h<b[f+1]&&(h=b[f+1]),g=20*(3*h-g)/(g*(a.numlines_l[f-1]+a.numlines_l[f]+a.numlines_l[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;if(g=c[f-1]+c[f],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),g=20*(2*h-g)/(g*(a.numlines_l[f-1]+a.numlines_l[f]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0}function ga(b,c,d,e,f,g,h,i){var j=b.internal_flags;if(e<2)a.fft_long(j,h[i],e,c,d);else if(2==e)for(var k=Q.BLKSIZE-1;k>=0;--k){var m=h[i+0][k],n=h[i+1][k];h[i+0][k]=(m+n)*l.SQRT2*.5,h[i+1][k]=(m-n)*l.SQRT2*.5}g[0]=A(h[i+0][0]),g[0]*=g[0];for(var k=Q.BLKSIZE/2-1;k>=0;--k){var o=h[i+0][Q.BLKSIZE/2-k],p=h[i+0][Q.BLKSIZE/2+k];g[Q.BLKSIZE/2-k]=A(.5*(o*o+p*p))}for(var q=0,k=11;k<Q.HBLKSIZE;k++)q+=g[k];if(j.tot_ener[e]=q,b.analysis){for(var k=0;k<Q.HBLKSIZE;k++)j.pinfo.energy[f][e][k]=j.pinfo.energy_save[e][k],j.pinfo.energy_save[e][k]=g[k];j.pinfo.pe[f][e]=j.pe[e]}}function ha(b,c,d,e,f,g,h,i){var j=b.internal_flags;if(0==f&&e<2&&a.fft_short(j,h[i],e,c,d),2==e)for(var k=Q.BLKSIZE_s-1;k>=0;--k){var m=h[i+0][f][k],n=h[i+1][f][k];h[i+0][f][k]=(m+n)*l.SQRT2*.5,h[i+1][f][k]=(m-n)*l.SQRT2*.5}g[f][0]=h[i+0][f][0],g[f][0]*=g[f][0];for(var k=Q.BLKSIZE_s/2-1;k>=0;--k){var o=h[i+0][f][Q.BLKSIZE_s/2-k],p=h[i+0][f][Q.BLKSIZE_s/2+k];g[f][Q.BLKSIZE_s/2-k]=A(.5*(o*o+p*p))}}function ia(a,b,c,d){var e=a.internal_flags;2==a.athaa_loudapprox&&c<2&&(e.loudness_sq[b][c]=e.loudness_sq_save[c],e.loudness_sq_save[c]=B(d,e))}function ka(a,b,c,e,g,h,i,j,k,l){for(var m=f([2,576]),n=a.internal_flags,o=n.channels_out,p=a.mode==r.JOINT_STEREO?4:o,q=0;q<o;q++){firbuf=b[q];for(var s=c+576-350-y+192,t=0;t<576;t++){var u,v;u=firbuf[s+t+10],v=0;for(var w=0;w<(y-1)/2-1;w+=2)u+=ja[w]*(firbuf[s+t+w]+firbuf[s+t+y-w]),v+=ja[w+1]*(firbuf[s+t+w+1]+firbuf[s+t+y-w-1]);m[q][t]=u+v}g[e][q].en.assign(n.en[q]),g[e][q].thm.assign(n.thm[q]),p>2&&(h[e][q].en.assign(n.en[q+2]),h[e][q].thm.assign(n.thm[q+2]))}for(var q=0;q<p;q++){var x=d(12),z=d(12),A=[0,0,0,0],B=m[1&q],C=0,D=3==q?n.nsPsy.attackthre_s:n.nsPsy.attackthre,E=1;if(2==q)for(var t=0,w=576;w>0;++t,--w){var F=m[0][t],G=m[1][t];m[0][t]=F+G,m[1][t]=F-G}for(var t=0;t<3;t++)z[t]=n.nsPsy.last_en_subshort[q][t+6],x[t]=z[t]/n.nsPsy.last_en_subshort[q][t+4],A[0]+=z[t];for(var t=0;t<9;t++){for(var H=C+64,I=1;C<H;C++)I<Math.abs(B[C])&&(I=Math.abs(B[C]));n.nsPsy.last_en_subshort[q][t]=z[t+3]=I,A[1+t/3]+=I,I>z[t+3-2]?I/=z[t+3-2]:I=z[t+3-2]>10*I?z[t+3-2]/(10*I):0,x[t+3]=I}for(var t=0;t<3;++t){var J=z[3*t+3]+z[3*t+4]+z[3*t+5],K=1;6*z[3*t+5]<J&&(K*=.5,6*z[3*t+4]<J&&(K*=.5)),j[q][t]=K}if(a.analysis){for(var L=x[0],t=1;t<12;t++)L<x[t]&&(L=x[t]);n.pinfo.ers[e][q]=n.pinfo.ers_save[q],n.pinfo.ers_save[q]=L}for(var t=0;t<12;t++)0==k[q][t/3]&&x[t]>D&&(k[q][t/3]=t%3+1);for(var t=1;t<4;t++){var M=A[t-1],N=A[t],O=Math.max(M,N);O<4e4&&M<1.7*N&&N<1.7*M&&(1==t&&k[q][0]<=k[q][t]&&(k[q][0]=0),k[q][t]=0)}k[q][0]<=n.nsPsy.lastAttacks[q]&&(k[q][0]=0),3!=n.nsPsy.lastAttacks[q]&&k[q][0]+k[q][1]+k[q][2]+k[q][3]==0||(E=0,0!=k[q][1]&&0!=k[q][0]&&(k[q][1]=0),0!=k[q][2]&&0!=k[q][1]&&(k[q][2]=0),0!=k[q][3]&&0!=k[q][2]&&(k[q][3]=0)),q<2?l[q]=E:0==E&&(l[0]=l[1]=0),i[q]=n.tot_ener[q]}}function la(a,b,c){if(0==c)for(var d=0;d<a.npart_s;d++)a.nb_s2[b][d]=a.nb_s1[b][d],a.nb_s1[b][d]=0}function ma(a,b){for(var c=0;c<a.npart_l;c++)a.nb_2[b][c]=a.nb_1[b][c],a.nb_1[b][c]=0}function na(a,b,c,d){var e=J.length-1,f=0,g=c[f]+c[f+1];if(g>0){var h=b[f];h<b[f+1]&&(h=b[f+1]),g=20*(2*h-g)/(g*(a.numlines_s[f]+a.numlines_s[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;for(f=1;f<a.npart_s-1;f++)if(g=c[f-1]+c[f]+c[f+1],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),h<b[f+1]&&(h=b[f+1]),g=20*(3*h-g)/(g*(a.numlines_s[f-1]+a.numlines_s[f]+a.numlines_s[f+1]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0;if(g=c[f-1]+c[f],g>0){var h=b[f-1];h<b[f]&&(h=b[f]),g=20*(2*h-g)/(g*(a.numlines_s[f-1]+a.numlines_s[f]-1));var i=0|g;i>e&&(i=e),d[f]=i}else d[f]=0}function oa(a,b,c,e,f,g){var k,l,m,h=a.internal_flags,i=new float[Q.CBANDS],j=d(Q.CBANDS),n=new int[Q.CBANDS];for(m=l=0;m<h.npart_s;++m){var o=0,p=0,q=h.numlines_s[m];for(k=0;k<q;++k,++l){var r=b[g][l];o+=r,p<r&&(p=r)}c[m]=o,i[m]=p,j[m]=o/q}for(;m<Q.CBANDS;++m)i[m]=0,j[m]=0;for(na(h,i,j,n),l=m=0;m<h.npart_s;m++){var u,v,w,x,y,s=h.s3ind_s[m][0],t=h.s3ind_s[m][1];for(u=n[s],v=1,x=h.s3_ss[l]*c[s]*J[n[s]],++l,++s;s<=t;)u+=n[s],v+=1,w=h.s3_ss[l]*c[s]*J[n[s]],x=R(x,w,s-m),++l,++s;u=(1+2*u)/(2*v),y=.5*J[u],x*=y,e[m]=x,h.nb_s2[f][m]=h.nb_s1[f][m],h.nb_s1[f][m]=x,w=i[m],w*=h.minval_s[m],w*=y,e[m]>w&&(e[m]=w),h.masking_lower>1&&(e[m]*=h.masking_lower),e[m]>c[m]&&(e[m]=c[m]),h.masking_lower<1&&(e[m]*=h.masking_lower)}for(;m<Q.CBANDS;++m)c[m]=0,e[m]=0}function pa(a,b,f,h,i){var m,j=d(Q.CBANDS),k=d(Q.CBANDS),l=c(Q.CBANDS+2);da(a,b,f,j,k),ea(a,j,k,l);var n=0;for(m=0;m<a.npart_l;m++){var o,p,q,r,s=a.s3ind[m][0],t=a.s3ind[m][1],v=0,w=0;for(v=l[s],w+=1,p=a.s3_ll[n]*f[s]*J[l[s]],++n,++s;s<=t;)v+=l[s],w+=1,o=a.s3_ll[n]*f[s]*J[l[s]],r=R(p,o,s-m),p=r,++n,++s;if(v=(1+2*v)/(2*w),q=.5*J[v],p*=q,a.blocktype_old[1&i]==Q.SHORT_TYPE){var x=e*a.nb_1[i][m];x>0?h[m]=Math.min(p,x):h[m]=Math.min(p,f[m]*u)}else{var x,y=g*a.nb_2[i][m],z=e*a.nb_1[i][m];y<=0&&(y=p),z<=0&&(z=p),x=a.blocktype_old[1&i]==Q.NORM_TYPE?Math.min(z,y):z,h[m]=Math.min(p,x)}a.nb_2[i][m]=a.nb_1[i][m],a.nb_1[i][m]=p,o=j[m],o*=a.minval_l[m],o*=q,h[m]>o&&(h[m]=o),a.masking_lower>1&&(h[m]*=a.masking_lower),h[m]>f[m]&&(h[m]=f[m]),a.masking_lower<1&&(h[m]*=a.masking_lower)}for(;m<Q.CBANDS;++m)f[m]=0,h[m]=0}function qa(a,b){var c=a.internal_flags;a.short_blocks!=m.short_block_coupled||0!=b[0]&&0!=b[1]||(b[0]=b[1]=0);for(var d=0;d<c.channels_out;d++)a.short_blocks==m.short_block_dispensed&&(b[d]=1),a.short_blocks==m.short_block_forced&&(b[d]=0)}function ra(a,b,c){for(var d=a.internal_flags,e=0;e<d.channels_out;e++){var f=Q.NORM_TYPE;0!=b[e]?d.blocktype_old[e]==Q.SHORT_TYPE&&(f=Q.STOP_TYPE):(f=Q.SHORT_TYPE,d.blocktype_old[e]==Q.NORM_TYPE&&(d.blocktype_old[e]=Q.START_TYPE),d.blocktype_old[e]==Q.STOP_TYPE&&(d.blocktype_old[e]=Q.SHORT_TYPE)),c[e]=d.blocktype_old[e],d.blocktype_old[e]=f}}function sa(a,b,c,d,e,f,g){for(var j,k,h=2*f,i=f>0?Math.pow(10,e):1,l=0;l<g;++l){var m=a[2][l],n=a[3][l],o=b[0][l],p=b[1][l],q=b[2][l],r=b[3][l];if(o<=1.58*p&&p<=1.58*o){var s=c[l]*n,t=c[l]*m;k=Math.max(q,Math.min(r,s)),j=Math.max(r,Math.min(q,t))}else k=q,j=r;if(f>0){var u,v,w=d[l]*i;if(u=Math.min(Math.max(o,w),Math.max(p,w)),q=Math.max(k,w),r=Math.max(j,w),v=q+r,v>0&&u*h<v){var x=u*h/v;q*=x,r*=x}k=Math.min(q,k),j=Math.min(r,j)}k>m&&(k=m),j>n&&(j=n),b[2][l]=k,b[3][l]=j}}function ta(a,b){var d,c=a;return d=c>=0?27*-c:c*b,d<=-72?0:Math.exp(d*z)}function ua(a){var e,f,b=0,c=0,d=0;for(d=0;ta(d,a)>1e-20;d-=1);for(e=d,f=0;Math.abs(f-e)>1e-12;)d=(f+e)/2,ta(d,a)>0?f=d:e=d;b=e;var e,f,d=0;for(d=0;ta(d,a)>1e-20;d+=1);for(e=0,f=d;Math.abs(f-e)>1e-12;)d=(f+e)/2,ta(d,a)>0?e=d:f=d;c=f;var i,g=0,h=1e3;for(i=0;i<=h;++i){var d=b+i*(c-b)/h,j=ta(d,a);g+=j}var k=(h+1)/(g*(c-b));return k}function va(a){var b,c,d,e;return b=a,b*=b>=0?3:1.5,b>=.5&&b<=2.5?(e=b-.5,c=8*(e*e-2*e)):c=0,b+=.474,d=15.811389+7.5*b-17.5*Math.sqrt(1+b*b),d<=-60?0:(b=Math.exp((c+d)*z),b/=.6609193)}function wa(a){return a<0&&(a=0),a=.001*a,13*Math.atan(.76*a)+3.5*Math.atan(a*a/56.25)}function xa(a,b,e,f,g,h,i,j,l,m,n,o){var s,p=d(Q.CBANDS+1),q=j/(o>15?1152:384),r=c(Q.HBLKSIZE);j/=l;var t=0,u=0;for(s=0;s<Q.CBANDS;s++){var v,w;for(v=wa(j*t),p[s]=j*t,w=t;wa(j*w)-v<k&&w<=l/2;w++);for(a[s]=w-t,u=s+1;t<w;)r[t++]=s;if(t>l/2){t=l/2,++s;break}}p[s]=j*t;for(var x=0;x<o;x++){var y,z,A,B,C;A=m[x],B=m[x+1],y=0|Math.floor(.5+n*(A-.5)),y<0&&(y=0),z=0|Math.floor(.5+n*(B-.5)),z>l/2&&(z=l/2),e[x]=(r[y]+r[z])/2,b[x]=r[z];var D=q*B;i[x]=(D-p[b[x]])/(p[b[x]+1]-p[b[x]]),i[x]<0?i[x]=0:i[x]>1&&(i[x]=1),C=wa(j*m[x]*n),C=Math.min(C,15.5)/15.5,h[x]=Math.pow(10,1.25*(1-Math.cos(Math.PI*C))-2.5)}t=0;for(var E=0;E<u;E++){var v,G,F=a[E];v=wa(j*t),G=wa(j*(t+F-1)),f[E]=.5*(v+G),v=wa(j*(t-.5)),G=wa(j*(t+F-.5)),g[E]=G-v,t+=F}return u}function ya(a,b,c,e,g,h){var j,i=f([Q.CBANDS,Q.CBANDS]),k=0;if(h)for(var l=0;l<b;l++)for(j=0;j<b;j++){var m=va(c[l]-c[j])*e[j];i[l][j]=m*g[l]}else for(j=0;j<b;j++)for(var n=15+Math.min(21/c[j],12),o=ua(n),l=0;l<b;l++){var m=o*ta(c[l]-c[j],n)*e[j];i[l][j]=m*g[l]}for(var l=0;l<b;l++){for(j=0;j<b&&!(i[l][j]>0);j++);for(a[l][0]=j,j=b-1;j>0&&!(i[l][j]>0);j--);a[l][1]=j,k+=a[l][1]-a[l][0]+1}for(var p=d(k),q=0,l=0;l<b;l++)for(j=a[l][0];j<=a[l][1];j++)p[q++]=i[l][j];return p}function za(a){var b=wa(a);return b=Math.min(b,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*b))-2.5)}function Aa(a,b){a<-.3&&(a=3410),a/=1e3,a=Math.max(.1,a);var c=3.64*Math.pow(a,-.8)-6.8*Math.exp(-.6*Math.pow(a-3.4,2))+6*Math.exp(-.15*Math.pow(a-8.7,2))+.001*(.6+.04*b)*Math.pow(a,4);return c}var G,H,I,a=new W,b=2.302585092994046,e=2,g=16,h=2,i=16,k=.34,p=1/217621504/(Q.BLKSIZE/2),q=.01,s=.8,t=.6,u=.3,v=3.5,y=21,z=.2302585093,D=8,E=23,F=15,J=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],L=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],M=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],N=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276],P=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],_=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130],ba=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1],fa=[-1.730326e-17,-.01703172,-1.349528e-17,.0418072,-6.73278e-17,-.0876324,-3.0835e-17,.1863476,-1.104424e-16,-.627638];this.L3psycho_anal_ns=function(a,b,h,i,k,l,m,n,p,q){var F,G,H,I,K,L,M,N,R,v=a.internal_flags,w=f([2,Q.BLKSIZE]),x=f([2,3,Q.BLKSIZE_s]),z=d(Q.CBANDS+1),A=d(Q.CBANDS+1),B=d(Q.CBANDS+2),D=c(2),E=c(2),P=f([2,576]),W=c(Q.CBANDS+2),_=c(Q.CBANDS+2);for(j.fill(_,0),F=v.channels_out,a.mode==r.JOINT_STEREO&&(F=4),R=a.VBR==o.vbr_off?0==v.ResvMax?0:v.ResvSize/v.ResvMax*.5:a.VBR==o.vbr_rh||a.VBR==o.vbr_mtrh||a.VBR==o.vbr_mt?.6:1,G=0;G<v.channels_out;G++){var ba=b[G],ga=h+576-350-y+192;for(I=0;I<576;I++){var ha,ia;for(ha=ba[ga+I+10],ia=0,K=0;K<(y-1)/2-1;K+=2)ha+=fa[K]*(ba[ga+I+K]+ba[ga+I+y-K]),ia+=fa[K+1]*(ba[ga+I+K+1]+ba[ga+I+y-K-1]);P[G][I]=ha+ia}k[i][G].en.assign(v.en[G]),k[i][G].thm.assign(v.thm[G]),F>2&&(l[i][G].en.assign(v.en[G+2]),l[i][G].thm.assign(v.thm[G+2]))}for(G=0;G<F;G++){var ja,ka,pa,la=d(12),ma=[0,0,0,0],na=d(12),oa=1,qa=d(Q.CBANDS),ra=d(Q.CBANDS),sa=[0,0,0,0],ta=d(Q.HBLKSIZE),ua=f([3,Q.HBLKSIZE_s]);for(I=0;I<3;I++)la[I]=v.nsPsy.last_en_subshort[G][I+6],na[I]=la[I]/v.nsPsy.last_en_subshort[G][I+4],ma[0]+=la[I];if(2==G)for(I=0;I<576;I++){var va,wa;va=P[0][I],wa=P[1][I],P[0][I]=va+wa,P[1][I]=va-wa}var xa=P[1&G],ya=0;for(I=0;I<9;I++){for(var za=ya+64,Aa=1;ya<za;ya++)Aa<Math.abs(xa[ya])&&(Aa=Math.abs(xa[ya]));v.nsPsy.last_en_subshort[G][I]=la[I+3]=Aa,ma[1+I/3]+=Aa,Aa>la[I+3-2]?Aa/=la[I+3-2]:Aa=la[I+3-2]>10*Aa?la[I+3-2]/(10*Aa):0,na[I+3]=Aa}if(a.analysis){var Ba=na[0];for(I=1;I<12;I++)Ba<na[I]&&(Ba=na[I]);v.pinfo.ers[i][G]=v.pinfo.ers_save[G],v.pinfo.ers_save[G]=Ba}for(pa=3==G?v.nsPsy.attackthre_s:v.nsPsy.attackthre,I=0;I<12;I++)0==sa[I/3]&&na[I]>pa&&(sa[I/3]=I%3+1);for(I=1;I<4;I++){var Ca;Ca=ma[I-1]>ma[I]?ma[I-1]/ma[I]:ma[I]/ma[I-1],Ca<1.7&&(sa[I]=0,1==I&&(sa[0]=0))}for(0!=sa[0]&&0!=v.nsPsy.lastAttacks[G]&&(sa[0]=0),3!=v.nsPsy.lastAttacks[G]&&sa[0]+sa[1]+sa[2]+sa[3]==0||(oa=0,0!=sa[1]&&0!=sa[0]&&(sa[1]=0),0!=sa[2]&&0!=sa[1]&&(sa[2]=0),0!=sa[3]&&0!=sa[2]&&(sa[3]=0)),G<2?E[G]=oa:0==oa&&(E[0]=E[1]=0),p[G]=v.tot_ener[G],ka=x,ja=w,C(a,ta,ua,ja,1&G,ka,1&G,i,G,b,h),da(v,ta,z,qa,ra),ea(v,qa,ra,W),N=0;N<3;N++){var Da,Ea;for(Y(a,ua,A,B,G,N),V(v,A,B,G,N),M=0;M<Q.SBMAX_s;M++){if(Ea=v.thm[G].s[M][N],Ea*=s,sa[N]>=2||1==sa[N+1]){var Fa=0!=N?N-1:2,Aa=$(v.thm[G].s[M][Fa],Ea,t*R);Ea=Math.min(Ea,Aa)}if(1==sa[N]){var Fa=0!=N?N-1:2,Aa=$(v.thm[G].s[M][Fa],Ea,u*R);Ea=Math.min(Ea,Aa)}else if(0!=N&&3==sa[N-1]||0==N&&3==v.nsPsy.lastAttacks[G]){var Fa=2!=N?N+1:0,Aa=$(v.thm[G].s[M][Fa],Ea,u*R);Ea=Math.min(Ea,Aa)}Da=la[3*N+3]+la[3*N+4]+la[3*N+5],6*la[3*N+5]<Da&&(Ea*=.5,6*la[3*N+4]<Da&&(Ea*=.5)),v.thm[G].s[M][N]=Ea}}for(v.nsPsy.lastAttacks[G]=sa[2],L=0,H=0;H<v.npart_l;H++){for(var Ga=v.s3ind[H][0],Ha=z[Ga]*J[W[Ga]],Ia=v.s3_ll[L++]*Ha;++Ga<=v.s3ind[H][1];)Ha=z[Ga]*J[W[Ga]],Ia=O(Ia,v.s3_ll[L++]*Ha,Ga,Ga-H,v,0);Ia*=.158489319246111,v.blocktype_old[1&G]==Q.SHORT_TYPE?B[H]=Ia:B[H]=$(Math.min(Ia,Math.min(e*v.nb_1[G][H],g*v.nb_2[G][H])),Ia,R),v.nb_2[G][H]=v.nb_1[G][H],v.nb_1[G][H]=Ia}for(;H<=Q.CBANDS;++H)z[H]=0,B[H]=0;X(v,z,B,G)}if(a.mode!=r.STEREO&&a.mode!=r.JOINT_STEREO||a.interChRatio>0&&S(a,a.interChRatio),a.mode==r.JOINT_STEREO){var Ja;T(v),Ja=a.msfix,Math.abs(Ja)>0&&U(v,Ja,a.ATHlower*v.ATH.adjust)}for(Z(a,E,q,D),G=0;G<F;G++){var Ka,Ma,Na,La=0;G>1?(Ka=n,La=-2,Ma=Q.NORM_TYPE,q[0]!=Q.SHORT_TYPE&&q[1]!=Q.SHORT_TYPE||(Ma=Q.SHORT_TYPE),Na=l[i][G-2]):(Ka=m,La=0,Ma=q[G],Na=k[i][G]),Ma==Q.SHORT_TYPE?Ka[La+G]=aa(Na,v.masking_lower):Ka[La+G]=ca(Na,v.masking_lower),a.analysis&&(v.pinfo.pe[i][G]=Ka[La+G])}return 0};var ja=[-1.730326e-17,-.01703172,-1.349528e-17,.0418072,-6.73278e-17,-.0876324,-3.0835e-17,.1863476,-1.104424e-16,-.627638];this.L3psycho_anal_vbr=function(a,b,e,g,h,i,j,k,l,m){var o,p,n=a.internal_flags,q=d(Q.HBLKSIZE),v=f([3,Q.HBLKSIZE_s]),w=f([2,Q.BLKSIZE]),x=f([2,3,Q.BLKSIZE_s]),y=f([4,Q.CBANDS]),z=f([4,Q.CBANDS]),A=f([4,3]),B=.6,C=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],D=c(2),E=a.mode==r.JOINT_STEREO?4:n.channels_out;ka(a,b,e,g,h,i,l,A,C,D),qa(a,D);for(var F=0;F<E;F++){var G=1&F;o=w,ga(a,b,e,F,g,q,o,G),ia(a,g,F,q),0!=D[G]?pa(n,q,y[F],z[F],F):ma(n,F)}D[0]+D[1]==2&&a.mode==r.JOINT_STEREO&&sa(y,z,n.mld_cb_l,n.ATH.cb_l,a.ATHlower*n.ATH.adjust,a.msfix,n.npart_l);for(var F=0;F<E;F++){var G=1&F;0!=D[G]&&X(n,y[F],z[F],F)}for(var H=0;H<3;H++){for(var F=0;F<E;++F){var G=1&F;0!=D[G]?la(n,F,H):(p=x,ha(a,b,e,F,H,v,p,G),oa(a,v,y[F],z[F],F,H))}D[0]+D[1]==0&&a.mode==r.JOINT_STEREO&&sa(y,z,n.mld_cb_s,n.ATH.cb_s,a.ATHlower*n.ATH.adjust,a.msfix,n.npart_s);for(var F=0;F<E;++F){var G=1&F;0==D[G]&&V(n,y[F],z[F],F,H)}}for(var F=0;F<E;F++){var G=1&F;if(0==D[G])for(var I=0;I<Q.SBMAX_s;I++){for(var J=d(3),H=0;H<3;H++){var K=n.thm[F].s[I][H];if(K*=s,C[F][H]>=2||1==C[F][H+1]){var L=0!=H?H-1:2,M=$(n.thm[F].s[I][L],K,t*B);K=Math.min(K,M)}else if(1==C[F][H]){var L=0!=H?H-1:2,M=$(n.thm[F].s[I][L],K,u*B);K=Math.min(K,M)}else if(0!=H&&3==C[F][H-1]||0==H&&3==n.nsPsy.lastAttacks[F]){var L=2!=H?H+1:0,M=$(n.thm[F].s[I][L],K,u*B);K=Math.min(K,M)}K*=A[F][H],J[H]=K}for(var H=0;H<3;H++)n.thm[F].s[I][H]=J[H]}}for(var F=0;F<E;F++)n.nsPsy.lastAttacks[F]=C[F][2];ra(a,D,m);for(var F=0;F<E;F++){var N,O,P,R;F>1?(N=k,O=-2,P=Q.NORM_TYPE,m[0]!=Q.SHORT_TYPE&&m[1]!=Q.SHORT_TYPE||(P=Q.SHORT_TYPE),R=i[g][F-2]):(N=j,O=0,P=m[F],R=h[g][F]),P==Q.SHORT_TYPE?N[O+F]=aa(R,n.masking_lower):N[O+F]=ca(R,n.masking_lower),a.analysis&&(n.pinfo.pe[g][F]=N[O+F])}return 0},this.psymodel_init=function(c){var f,e=c.internal_flags,g=!0,h=13,i=24,j=0,k=0,l=-8.25,m=-4.5,p=d(Q.CBANDS),r=d(Q.CBANDS),s=d(Q.CBANDS),t=c.out_samplerate;switch(c.experimentalZ){default:case 0:g=!0;break;case 1:g=c.VBR!=o.vbr_mtrh&&c.VBR!=o.vbr_mt;break;case 2:g=!1;break;case 3:h=8,j=-1.75,k=-.0125,l=-8.25,m=-2.25}for(e.ms_ener_ratio_old=.25,e.blocktype_old[0]=e.blocktype_old[1]=Q.NORM_TYPE,f=0;f<4;++f){for(var u=0;u<Q.CBANDS;++u)e.nb_1[f][u]=1e20,e.nb_2[f][u]=1e20,e.nb_s1[f][u]=e.nb_s2[f][u]=1;for(var w=0;w<Q.SBMAX_l;w++)e.en[f].l[w]=1e20,e.thm[f].l[w]=1e20;for(var u=0;u<3;++u){for(var w=0;w<Q.SBMAX_s;w++)e.en[f].s[w][u]=1e20,e.thm[f].s[w][u]=1e20;e.nsPsy.lastAttacks[f]=0}for(var u=0;u<9;u++)e.nsPsy.last_en_subshort[f][u]=10}for(e.loudness_sq_save[0]=e.loudness_sq_save[1]=0,e.npart_l=xa(e.numlines_l,e.bo_l,e.bm_l,p,r,e.mld_l,e.PSY.bo_l_weight,t,Q.BLKSIZE,e.scalefac_band.l,Q.BLKSIZE/1152,Q.SBMAX_l),f=0;f<e.npart_l;f++){var x=j;p[f]>=h&&(x=k*(p[f]-h)/(i-h)+j*(i-p[f])/(i-h)),s[f]=Math.pow(10,x/10),e.numlines_l[f]>0?e.rnumlines_l[f]=1/e.numlines_l[f]:e.rnumlines_l[f]=0}e.s3_ll=ya(e.s3ind,e.npart_l,p,r,s,g);var u=0;for(f=0;f<e.npart_l;f++){var y;y=n.MAX_VALUE;for(var z=0;z<e.numlines_l[f];z++,u++){var B,A=t*u/(1e3*Q.BLKSIZE);B=this.ATHformula(1e3*A,c)-20,B=Math.pow(10,.1*B),B*=e.numlines_l[f],y>B&&(y=B)}e.ATH.cb_l[f]=y,y=-20+20*p[f]/10,y>6&&(y=100),y<-15&&(y=-15),y-=8,e.minval_l[f]=Math.pow(10,y/10)*e.numlines_l[f]}for(e.npart_s=xa(e.numlines_s,e.bo_s,e.bm_s,p,r,e.mld_s,e.PSY.bo_s_weight,t,Q.BLKSIZE_s,e.scalefac_band.s,Q.BLKSIZE_s/384,Q.SBMAX_s),u=0,f=0;f<e.npart_s;f++){var y,x=l;p[f]>=h&&(x=m*(p[f]-h)/(i-h)+l*(i-p[f])/(i-h)),s[f]=Math.pow(10,x/10),y=n.MAX_VALUE;for(var z=0;z<e.numlines_s[f];z++,u++){var B,A=t*u/(1e3*Q.BLKSIZE_s);B=this.ATHformula(1e3*A,c)-20,B=Math.pow(10,.1*B),B*=e.numlines_s[f],y>B&&(y=B)}e.ATH.cb_s[f]=y,y=-7+7*p[f]/12,p[f]>12&&(y*=1+3.1*Math.log(1+y)),p[f]<12&&(y*=1+2.3*Math.log(1-y)),y<-15&&(y=-15),y-=8,e.minval_s[f]=Math.pow(10,y/10)*e.numlines_s[f]}e.s3_ss=ya(e.s3ind_s,e.npart_s,p,r,s,g),K(),a.init_fft(e),e.decay=Math.exp(-1*b/(q*t/192));var C;C=v,0!=(2&c.exp_nspsytune)&&(C=1),Math.abs(c.msfix)>0&&(C=c.msfix),c.msfix=C;for(var D=0;D<e.npart_l;D++)e.s3ind[D][1]>e.npart_l-1&&(e.s3ind[D][1]=e.npart_l-1);var E=576*e.mode_gr/t;if(e.ATH.decay=Math.pow(10,-1.2*E),e.ATH.adjust=.01,e.ATH.adjustLimit=1,c.ATHtype!=-1){var A,F=c.out_samplerate/Q.BLKSIZE,G=0;for(A=0,f=0;f<Q.BLKSIZE/2;++f)A+=F,e.ATH.eql_w[f]=1/Math.pow(10,this.ATHformula(A,c)/10),G+=e.ATH.eql_w[f];for(G=1/G,f=Q.BLKSIZE/2;--f>=0;)e.ATH.eql_w[f]*=G}for(var D=u=0;D<e.npart_s;++D)for(f=0;f<e.numlines_s[D];++f)++u;for(var D=u=0;D<e.npart_l;++D)for(f=0;f<e.numlines_l[D];++f)++u;for(u=0,f=0;f<e.npart_l;f++){var A=t*(u+e.numlines_l[f]/2)/(1*Q.BLKSIZE);e.mld_cb_l[f]=za(A),u+=e.numlines_l[f]}for(;f<Q.CBANDS;++f)e.mld_cb_l[f]=1;for(u=0,f=0;f<e.npart_s;f++){var A=t*(u+e.numlines_s[f]/2)/(1*Q.BLKSIZE_s);e.mld_cb_s[f]=za(A),u+=e.numlines_s[f]}for(;f<Q.CBANDS;++f)e.mld_cb_s[f]=1;return 0},this.ATHformula=function(a,b){var c;switch(b.ATHtype){case 0:c=Aa(a,9);break;case 1:c=Aa(a,-1);break;case 2:c=Aa(a,0);break;case 3:c=Aa(a,1)+6;break;case 4:c=Aa(a,b.ATHcurve);break;default:c=Aa(a,0)}return c}}function Y(){function v(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=d(Q.SBMAX_l),this.bo_s_weight=d(Q.SBMAX_s)}function w(){this.lowerlimit=0}function y(a,b){this.lowpass=b}function B(a){var b;return a.class_id=z,b=a.internal_flags=new V,a.mode=r.NOT_SET,a.original=1,a.in_samplerate=44100,a.num_channels=2,a.num_samples=-1,a.bWriteVbrTag=!0,a.quality=-1,a.short_blocks=null,b.subblock_gain=-1,a.lowpassfreq=0,a.highpassfreq=0,a.lowpasswidth=-1,a.highpasswidth=-1,a.VBR=o.vbr_off,a.VBR_q=4,a.ATHcurve=-1,a.VBR_mean_bitrate_kbps=128,a.VBR_min_bitrate_kbps=0,a.VBR_max_bitrate_kbps=0,a.VBR_hard_min=0,b.VBR_min_bitrate=1,b.VBR_max_bitrate=13,a.quant_comp=-1,a.quant_comp_short=-1,a.msfix=-1,b.resample_ratio=1,b.OldValue[0]=180,b.OldValue[1]=180,b.CurrentStep[0]=4,b.CurrentStep[1]=4,b.masking_lower=1,b.nsPsy.attackthre=-1,b.nsPsy.attackthre_s=-1,a.scale=-1,a.athaa_type=-1,a.ATHtype=-1,a.athaa_loudapprox=-1,a.athaa_sensitivity=0,a.useTemporal=null,a.interChRatio=-1,b.mf_samples_to_encode=Q.ENCDELAY+Q.POSTDELAY,a.encoder_padding=0,b.mf_size=Q.ENCDELAY-Q.MDCTDELAY,a.findReplayGain=!1,a.decode_on_the_fly=!1,b.decode_on_the_fly=!1,b.findReplayGain=!1,b.findPeakSample=!1,b.RadioGain=0,b.AudiophileGain=0,b.noclipGainChange=0,b.noclipScale=-1,a.preset=0,a.write_id3tag_automatic=!0,0}function C(a){return a>1?0:a<=0?1:Math.cos(Math.PI/2*a)}function D(a,b){var c=44100;return b>=48e3?c=48e3:b>=44100?c=44100:b>=32e3?c=32e3:b>=24e3?c=24e3:b>=22050?c=22050:b>=16e3?c=16e3:b>=12e3?c=12e3:b>=11025?c=11025:b>=8e3&&(c=8e3),a==-1?c:(a<=15960&&(c=44100),a<=15250&&(c=32e3),a<=11220&&(c=24e3),a<=9970&&(c=22050),a<=7230&&(c=16e3),a<=5420&&(c=12e3),a<=4510&&(c=11025),a<=3970&&(c=8e3),b<c?b>44100?48e3:b>32e3?44100:b>24e3?32e3:b>22050?24e3:b>16e3?22050:b>12e3?16e3:b>11025?12e3:b>8e3?11025:8e3:c)}function I(a,b){switch(a){case 44100:return b.version=1,0;case 48e3:return b.version=1,1;case 32e3:return b.version=1,2;case 22050:return b.version=0,0;case 24e3:return b.version=0,1;case 16e3:return b.version=0,2;case 11025:return b.version=0,0;case 12e3:return b.version=0,1;case 8e3:return b.version=0,2;default:return b.version=0,-1}}function J(a,b,c){c<16e3&&(b=2);for(var d=A.bitrate_table[b][1],e=2;e<=14;e++)A.bitrate_table[b][e]>0&&Math.abs(A.bitrate_table[b][e]-a)<Math.abs(d-a)&&(d=A.bitrate_table[b][e]);return d}function K(a,b,c){c<16e3&&(b=2);for(var d=0;d<=14;d++)if(A.bitrate_table[b][d]>0&&A.bitrate_table[b][d]==a)return d;return-1}function L(b,c){var d=[new y(8,2e3),new y(16,3700),new y(24,3900),new y(32,5500),new y(40,7e3),new y(48,7500),new y(56,1e4),new y(64,11e3),new y(80,13500),new y(96,15100),new y(112,15600),new y(128,17e3),new y(160,17500),new y(192,18600),new y(224,19400),new y(256,19700),new y(320,20500)],e=a.nearestBitrateFullIndex(c);b.lowerlimit=d[e].lowpass}function M(a){var b=a.internal_flags,c=32,d=-1;if(b.lowpass1>0){for(var e=999,f=0;f<=31;f++){var g=f/31;g>=b.lowpass2&&(c=Math.min(c,f)),b.lowpass1<g&&g<b.lowpass2&&(e=Math.min(e,f))}999==e?b.lowpass1=(c-.75)/31:b.lowpass1=(e-.75)/31,b.lowpass2=c/31}if(b.highpass2>0&&b.highpass2<.9*(.75/31)&&(b.highpass1=0,b.highpass2=0,k.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),b.highpass2>0){for(var h=-1,f=0;f<=31;f++){var g=f/31;g<=b.highpass1&&(d=Math.max(d,f)),b.highpass1<g&&g<b.highpass2&&(h=Math.max(h,f))}b.highpass1=d/31,h==-1?b.highpass2=(d+.75)/31:b.highpass2=(h+.75)/31}for(var f=0;f<32;f++){var i,j,g=f/31;i=b.highpass2>b.highpass1?C((b.highpass2-g)/(b.highpass2-b.highpass1+1e-20)):1,j=b.lowpass2>b.lowpass1?C((g-b.lowpass1)/(b.lowpass2-b.lowpass1+1e-20)):1,b.amp_filter[f]=i*j}}function N(a){var b=a.internal_flags;switch(a.quality){default:case 9:b.psymodel=0,b.noise_shaping=0,b.noise_shaping_amp=0,b.noise_shaping_stop=0,b.use_best_huffman=0,b.full_outer_loop=0;break;case 8:a.quality=7;case 7:b.psymodel=1,b.noise_shaping=0,b.noise_shaping_amp=0,b.noise_shaping_stop=0,b.use_best_huffman=0,b.full_outer_loop=0;break;case 6:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=0,b.noise_shaping_stop=0,b.subblock_gain==-1&&(b.subblock_gain=1),b.use_best_huffman=0,b.full_outer_loop=0;break;case 5:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=0,b.noise_shaping_stop=0,b.subblock_gain==-1&&(b.subblock_gain=1),b.use_best_huffman=0,b.full_outer_loop=0;break;case 4:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=0,b.noise_shaping_stop=0,b.subblock_gain==-1&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;
break;case 3:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),b.noise_shaping_amp=1,b.noise_shaping_stop=1,b.subblock_gain==-1&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;break;case 2:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),0==b.substep_shaping&&(b.substep_shaping=2),b.noise_shaping_amp=1,b.noise_shaping_stop=1,b.subblock_gain==-1&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;break;case 1:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),0==b.substep_shaping&&(b.substep_shaping=2),b.noise_shaping_amp=2,b.noise_shaping_stop=1,b.subblock_gain==-1&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0;break;case 0:b.psymodel=1,0==b.noise_shaping&&(b.noise_shaping=1),0==b.substep_shaping&&(b.substep_shaping=2),b.noise_shaping_amp=2,b.noise_shaping_stop=1,b.subblock_gain==-1&&(b.subblock_gain=1),b.use_best_huffman=1,b.full_outer_loop=0}}function O(a){var b=a.internal_flags;a.frameNum=0,a.write_id3tag_automatic&&s.id3tag_write_v2(a),b.bitrate_stereoMode_Hist=g([16,5]),b.bitrate_blockType_Hist=g([16,6]),b.PeakSample=0,a.bWriteVbrTag&&p.InitVbrTag(a)}function P(a,b){(null==a.in_buffer_0||a.in_buffer_nsamples<b)&&(a.in_buffer_0=d(b),a.in_buffer_1=d(b),a.in_buffer_nsamples=b)}function R(a){var b=Q.BLKSIZE+a.framesize-Q.FFTOFFSET;return b=Math.max(b,512+a.framesize-32)}function S(a,b,c,d,g,h,i){var l,m,n,o,p,j=a.internal_flags,k=0,q=[null,null],r=[null,null];if(j.Class_ID!=z)return-3;if(0==d)return 0;if(p=f.copy_buffer(j,g,h,i,0),p<0)return p;if(h+=p,k+=p,r[0]=b,r[1]=c,x.NEQ(a.scale,0)&&x.NEQ(a.scale,1))for(m=0;m<d;++m)r[0][m]*=a.scale,2==j.channels_out&&(r[1][m]*=a.scale);if(x.NEQ(a.scale_left,0)&&x.NEQ(a.scale_left,1))for(m=0;m<d;++m)r[0][m]*=a.scale_left;if(x.NEQ(a.scale_right,0)&&x.NEQ(a.scale_right,1))for(m=0;m<d;++m)r[1][m]*=a.scale_right;if(2==a.num_channels&&1==j.channels_out)for(m=0;m<d;++m)r[0][m]=.5*(r[0][m]+r[1][m]),r[1][m]=0;o=R(a),q[0]=j.mfbuf[0],q[1]=j.mfbuf[1];for(var s=0;d>0;){var t=[null,null],v=0,w=0;t[0]=r[0],t[1]=r[1];var y=new U;if(aa(a,q,t,s,d,y),v=y.n_in,w=y.n_out,j.findReplayGain&&!j.decode_on_the_fly&&e.AnalyzeSamples(j.rgdata,q[0],j.mf_size,q[1],j.mf_size,w,j.channels_out)==u.GAIN_ANALYSIS_ERROR)return-6;if(d-=v,s+=v,2==j.channels_out,j.mf_size+=w,j.mf_samples_to_encode<1&&(j.mf_samples_to_encode=Q.ENCDELAY+Q.POSTDELAY),j.mf_samples_to_encode+=w,j.mf_size>=o){var A=i-k;if(0==i&&(A=0),l=T(a,q[0],q[1],g,h,A),l<0)return l;for(h+=l,k+=l,j.mf_size-=a.framesize,j.mf_samples_to_encode-=a.framesize,n=0;n<j.channels_out;n++)for(m=0;m<j.mf_size;m++)q[n][m]=q[n][m+a.framesize]}}return k}function T(b,c,d,e,f,g){var h=a.enc.lame_encode_mp3_frame(b,c,d,e,f,g);return b.frameNum++,h}function U(){this.n_in=0,this.n_out=0}function W(){this.num_used=0}function Z(a,b){return 0!=b?Z(b,a%b):a}function $(a,b,c){var d=Math.PI*b;a/=c,a<0&&(a=0),a>1&&(a=1);var e=a-.5,f=.42-.5*Math.cos(2*a*Math.PI)+.08*Math.cos(4*a*Math.PI);return Math.abs(e)<1e-9?d/Math.PI:f*Math.sin(c*d*e)/(Math.PI*c*e)}function _(a,b,c,e,f,g,h,i,j){var l,n,k=a.internal_flags,m=0,o=a.out_samplerate/Z(a.out_samplerate,a.in_samplerate);o>V.BPC&&(o=V.BPC);var p=Math.abs(k.resample_ratio-Math.floor(.5+k.resample_ratio))<1e-4?1:0,q=1/k.resample_ratio;q>1&&(q=1);var r=31;0==r%2&&--r,r+=p;var s=r+1;if(0==k.fill_buffer_resample_init){for(k.inbuf_old[0]=d(s),k.inbuf_old[1]=d(s),l=0;l<=2*o;++l)k.blackfilt[l]=d(s);for(k.itime[0]=0,k.itime[1]=0,m=0;m<=2*o;m++){var t=0,u=(m-o)/(2*o);for(l=0;l<=r;l++)t+=k.blackfilt[m][l]=$(l-u,q,r);for(l=0;l<=r;l++)k.blackfilt[m][l]/=t}k.fill_buffer_resample_init=1}var v=k.inbuf_old[j];for(n=0;n<e;n++){var w,x;if(w=n*k.resample_ratio,m=0|Math.floor(w-k.itime[j]),r+m-r/2>=h)break;var u=w-k.itime[j]-(m+.5*(r%2));x=0|Math.floor(2*u*o+o+.5);var y=0;for(l=0;l<=r;++l){var A,z=l+m-r/2;A=z<0?v[s+z]:f[g+z],y+=A*k.blackfilt[x][l]}b[c+n]=y}if(i.num_used=Math.min(h,r+m-r/2),k.itime[j]+=i.num_used-n*k.resample_ratio,i.num_used>=s)for(l=0;l<s;l++)v[l]=f[g+i.num_used+l-s];else{var B=s-i.num_used;for(l=0;l<B;++l)v[l]=v[l+i.num_used];for(m=0;l<s;++l,++m)v[l]=f[g+m]}return n}function aa(a,b,c,d,e,f){var g=a.internal_flags;if(g.resample_ratio<.9999||g.resample_ratio>1.0001)for(var h=0;h<g.channels_out;h++){var i=new W;f.n_out=_(a,b[h],g.mf_size,a.framesize,c[h],d,e,i,h),f.n_in=i.num_used}else{f.n_out=Math.min(a.framesize,e),f.n_in=f.n_out;for(var j=0;j<f.n_out;++j)b[0][g.mf_size+j]=c[0][d+j],2==g.channels_out&&(b[1][g.mf_size+j]=c[1][d+j])}}var a=this,b=131072;Y.V9=410,Y.V8=420,Y.V7=430,Y.V6=440,Y.V5=450,Y.V4=460,Y.V3=470,Y.V2=480,Y.V1=490,Y.V0=500,Y.R3MIX=1e3,Y.STANDARD=1001,Y.EXTREME=1002,Y.INSANE=1003,Y.STANDARD_FAST=1004,Y.EXTREME_FAST=1005,Y.MEDIUM=1006,Y.MEDIUM_FAST=1007;var c=16384+b;Y.LAME_MAXMP3BUFFER=c;var e,f,i,j,l,p,q,s,t,n=new X;this.enc=new Q,this.setModules=function(a,b,c,d,g,h,k,m,o){e=a,f=b,i=c,j=d,l=g,p=h,q=k,s=m,t=o,this.enc.setModules(f,n,j,p)};var z=4294479419;this.lame_init=function(){var a=new E,b=B(a);return 0!=b?null:(a.lame_allocated_gfp=1,a)},this.nearestBitrateFullIndex=function(a){var b=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],c=0,d=0,e=0,f=0;f=b[16],e=16,d=b[16],c=16;for(var g=0;g<16;g++)if(Math.max(a,b[g+1])!=a){f=b[g+1],e=g+1,d=b[g],c=g;break}return f-a>a-d?c:e},this.lame_init_params=function(a){var b=a.internal_flags;if(b.Class_ID=0,null==b.ATH&&(b.ATH=new F),null==b.PSY&&(b.PSY=new v),null==b.rgdata&&(b.rgdata=new G),b.channels_in=a.num_channels,1==b.channels_in&&(a.mode=r.MONO),b.channels_out=a.mode==r.MONO?1:2,b.mode_ext=Q.MPG_MD_MS_LR,a.mode==r.MONO&&(a.force_ms=!1),a.VBR==o.vbr_off&&128!=a.VBR_mean_bitrate_kbps&&0==a.brate&&(a.brate=a.VBR_mean_bitrate_kbps),a.VBR==o.vbr_off||a.VBR==o.vbr_mtrh||a.VBR==o.vbr_mt||(a.free_format=!1),a.VBR==o.vbr_off&&0==a.brate&&x.EQ(a.compression_ratio,0)&&(a.compression_ratio=11.025),a.VBR==o.vbr_off&&a.compression_ratio>0&&(0==a.out_samplerate&&(a.out_samplerate=map2MP3Frequency(int(.97*a.in_samplerate))),a.brate=0|16*a.out_samplerate*b.channels_out/(1e3*a.compression_ratio),b.samplerate_index=I(a.out_samplerate,a),a.free_format||(a.brate=J(a.brate,a.version,a.out_samplerate))),0!=a.out_samplerate&&(a.out_samplerate<16e3?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,64)):a.out_samplerate<32e3?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,160)):(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,32),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320))),0==a.lowpassfreq){var c=16e3;switch(a.VBR){case o.vbr_off:var d=new w;L(d,a.brate),c=d.lowerlimit;break;case o.vbr_abr:var d=new w;L(d,a.VBR_mean_bitrate_kbps),c=d.lowerlimit;break;case o.vbr_rh:var g=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=a.VBR_q&&a.VBR_q<=9){var h=g[a.VBR_q],k=g[a.VBR_q+1],p=a.VBR_q_frac;c=linear_int(h,k,p)}else c=19500;break;default:var g=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=a.VBR_q&&a.VBR_q<=9){var h=g[a.VBR_q],k=g[a.VBR_q+1],p=a.VBR_q_frac;c=linear_int(h,k,p)}else c=19500}a.mode!=r.MONO||a.VBR!=o.vbr_off&&a.VBR!=o.vbr_abr||(c*=1.5),a.lowpassfreq=0|c}if(0==a.out_samplerate&&(2*a.lowpassfreq>a.in_samplerate&&(a.lowpassfreq=a.in_samplerate/2),a.out_samplerate=D(0|a.lowpassfreq,a.in_samplerate)),a.lowpassfreq=Math.min(20500,a.lowpassfreq),a.lowpassfreq=Math.min(a.out_samplerate/2,a.lowpassfreq),a.VBR==o.vbr_off&&(a.compression_ratio=16*a.out_samplerate*b.channels_out/(1e3*a.brate)),a.VBR==o.vbr_abr&&(a.compression_ratio=16*a.out_samplerate*b.channels_out/(1e3*a.VBR_mean_bitrate_kbps)),a.bWriteVbrTag||(a.findReplayGain=!1,a.decode_on_the_fly=!1,b.findPeakSample=!1),b.findReplayGain=a.findReplayGain,b.decode_on_the_fly=a.decode_on_the_fly,b.decode_on_the_fly&&(b.findPeakSample=!0),b.findReplayGain&&e.InitGainAnalysis(b.rgdata,a.out_samplerate)==u.INIT_GAIN_ANALYSIS_ERROR)return a.internal_flags=null,-6;switch(b.decode_on_the_fly&&!a.decode_only&&(null!=b.hip&&t.hip_decode_exit(b.hip),b.hip=t.hip_decode_init()),b.mode_gr=a.out_samplerate<=24e3?1:2,a.framesize=576*b.mode_gr,a.encoder_delay=Q.ENCDELAY,b.resample_ratio=a.in_samplerate/a.out_samplerate,a.VBR){case o.vbr_mt:case o.vbr_rh:case o.vbr_mtrh:var q=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];a.compression_ratio=q[a.VBR_q];break;case o.vbr_abr:a.compression_ratio=16*a.out_samplerate*b.channels_out/(1e3*a.VBR_mean_bitrate_kbps);break;default:a.compression_ratio=16*a.out_samplerate*b.channels_out/(1e3*a.brate)}if(a.mode==r.NOT_SET&&(a.mode=r.JOINT_STEREO),a.highpassfreq>0?(b.highpass1=2*a.highpassfreq,a.highpasswidth>=0?b.highpass2=2*(a.highpassfreq+a.highpasswidth):b.highpass2=2*a.highpassfreq,b.highpass1/=a.out_samplerate,b.highpass2/=a.out_samplerate):(b.highpass1=0,b.highpass2=0),a.lowpassfreq>0?(b.lowpass2=2*a.lowpassfreq,a.lowpasswidth>=0?(b.lowpass1=2*(a.lowpassfreq-a.lowpasswidth),b.lowpass1<0&&(b.lowpass1=0)):b.lowpass1=2*a.lowpassfreq,b.lowpass1/=a.out_samplerate,b.lowpass2/=a.out_samplerate):(b.lowpass1=0,b.lowpass2=0),M(a),b.samplerate_index=I(a.out_samplerate,a),b.samplerate_index<0)return a.internal_flags=null,-1;if(a.VBR==o.vbr_off){if(a.free_format)b.bitrate_index=0;else if(a.brate=J(a.brate,a.version,a.out_samplerate),b.bitrate_index=K(a.brate,a.version,a.out_samplerate),b.bitrate_index<=0)return a.internal_flags=null,-1}else b.bitrate_index=1;a.analysis&&(a.bWriteVbrTag=!1),null!=b.pinfo&&(a.bWriteVbrTag=!1),f.init_bit_stream_w(b);for(var s=b.samplerate_index+3*a.version+6*(a.out_samplerate<16e3?1:0),y=0;y<Q.SBMAX_l+1;y++)b.scalefac_band.l[y]=j.sfBandIndex[s].l[y];for(var y=0;y<Q.PSFB21+1;y++){var B=(b.scalefac_band.l[22]-b.scalefac_band.l[21])/Q.PSFB21,C=b.scalefac_band.l[21]+y*B;b.scalefac_band.psfb21[y]=C}b.scalefac_band.psfb21[Q.PSFB21]=576;for(var y=0;y<Q.SBMAX_s+1;y++)b.scalefac_band.s[y]=j.sfBandIndex[s].s[y];for(var y=0;y<Q.PSFB12+1;y++){var B=(b.scalefac_band.s[13]-b.scalefac_band.s[12])/Q.PSFB12,C=b.scalefac_band.s[12]+y*B;b.scalefac_band.psfb12[y]=C}b.scalefac_band.psfb12[Q.PSFB12]=192,1==a.version?b.sideinfo_len=1==b.channels_out?21:36:b.sideinfo_len=1==b.channels_out?13:21,a.error_protection&&(b.sideinfo_len+=2),O(a),b.Class_ID=z;var E;for(E=0;E<19;E++)b.nsPsy.pefirbuf[E]=700*b.mode_gr*b.channels_out;switch(a.ATHtype==-1&&(a.ATHtype=4),a.VBR){case o.vbr_mt:a.VBR=o.vbr_mtrh;case o.vbr_mtrh:null==a.useTemporal&&(a.useTemporal=!1),i.apply_preset(a,500-10*a.VBR_q,0),a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),a.quality<5&&(a.quality=0),a.quality>5&&(a.quality=5),b.PSY.mask_adjust=a.maskingadjust,b.PSY.mask_adjust_short=a.maskingadjust_short,a.experimentalY?b.sfb21_extra=!1:b.sfb21_extra=a.out_samplerate>44e3,b.iteration_loop=new VBRNewIterationLoop(l);break;case o.vbr_rh:i.apply_preset(a,500-10*a.VBR_q,0),b.PSY.mask_adjust=a.maskingadjust,b.PSY.mask_adjust_short=a.maskingadjust_short,a.experimentalY?b.sfb21_extra=!1:b.sfb21_extra=a.out_samplerate>44e3,a.quality>6&&(a.quality=6),a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),b.iteration_loop=new VBROldIterationLoop(l);break;default:var P;b.sfb21_extra=!1,a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),P=a.VBR,P==o.vbr_off&&(a.VBR_mean_bitrate_kbps=a.brate),i.apply_preset(a,a.VBR_mean_bitrate_kbps,0),a.VBR=P,b.PSY.mask_adjust=a.maskingadjust,b.PSY.mask_adjust_short=a.maskingadjust_short,P==o.vbr_off?b.iteration_loop=new H(l):b.iteration_loop=new ABRIterationLoop(l)}if(a.VBR!=o.vbr_off){if(b.VBR_min_bitrate=1,b.VBR_max_bitrate=14,a.out_samplerate<16e3&&(b.VBR_max_bitrate=8),0!=a.VBR_min_bitrate_kbps&&(a.VBR_min_bitrate_kbps=J(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),b.VBR_min_bitrate=K(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),b.VBR_min_bitrate<0))return-1;if(0!=a.VBR_max_bitrate_kbps&&(a.VBR_max_bitrate_kbps=J(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),b.VBR_max_bitrate=K(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),b.VBR_max_bitrate<0))return-1;a.VBR_min_bitrate_kbps=A.bitrate_table[a.version][b.VBR_min_bitrate],a.VBR_max_bitrate_kbps=A.bitrate_table[a.version][b.VBR_max_bitrate],a.VBR_mean_bitrate_kbps=Math.min(A.bitrate_table[a.version][b.VBR_max_bitrate],a.VBR_mean_bitrate_kbps),a.VBR_mean_bitrate_kbps=Math.max(A.bitrate_table[a.version][b.VBR_min_bitrate],a.VBR_mean_bitrate_kbps)}return a.tune&&(b.PSY.mask_adjust+=a.tune_value_a,b.PSY.mask_adjust_short+=a.tune_value_a),N(a),a.athaa_type<0?b.ATH.useAdjust=3:b.ATH.useAdjust=a.athaa_type,b.ATH.aaSensitivityP=Math.pow(10,a.athaa_sensitivity/-10),null==a.short_blocks&&(a.short_blocks=m.short_block_allowed),a.short_blocks!=m.short_block_allowed||a.mode!=r.JOINT_STEREO&&a.mode!=r.STEREO||(a.short_blocks=m.short_block_coupled),a.quant_comp<0&&(a.quant_comp=1),a.quant_comp_short<0&&(a.quant_comp_short=0),a.msfix<0&&(a.msfix=0),a.exp_nspsytune=1|a.exp_nspsytune,a.internal_flags.nsPsy.attackthre<0&&(a.internal_flags.nsPsy.attackthre=X.NSATTACKTHRE),a.internal_flags.nsPsy.attackthre_s<0&&(a.internal_flags.nsPsy.attackthre_s=X.NSATTACKTHRE_S),a.scale<0&&(a.scale=1),a.ATHtype<0&&(a.ATHtype=4),a.ATHcurve<0&&(a.ATHcurve=4),a.athaa_loudapprox<0&&(a.athaa_loudapprox=2),a.interChRatio<0&&(a.interChRatio=0),null==a.useTemporal&&(a.useTemporal=!0),b.slot_lag=b.frac_SpF=0,a.VBR==o.vbr_off&&(b.slot_lag=b.frac_SpF=72e3*(a.version+1)*a.brate%a.out_samplerate|0),j.iteration_init(a),n.psymodel_init(a),0},this.lame_encode_flush=function(a,b,c,d){var j,k,l,m,e=a.internal_flags,g=h([2,1152]),i=0,n=e.mf_samples_to_encode-Q.POSTDELAY,o=R(a);if(e.mf_samples_to_encode<1)return 0;for(j=0,a.in_samplerate!=a.out_samplerate&&(n+=16*a.out_samplerate/a.in_samplerate),l=a.framesize-n%a.framesize,l<576&&(l+=a.framesize),a.encoder_padding=l,m=(n+l)/a.framesize;m>0&&i>=0;){var p=o-e.mf_size,q=a.frameNum;p*=a.in_samplerate,p/=a.out_samplerate,p>1152&&(p=1152),p<1&&(p=1),k=d-j,0==d&&(k=0),i=this.lame_encode_buffer(a,g[0],g[1],p,b,c,k),c+=i,j+=i,m-=q!=a.frameNum?1:0}if(e.mf_samples_to_encode=0,i<0)return i;if(k=d-j,0==d&&(k=0),f.flush_bitstream(a),i=f.copy_buffer(e,b,c,k,1),i<0)return i;if(c+=i,j+=i,k=d-j,0==d&&(k=0),a.write_id3tag_automatic){if(s.id3tag_write_v1(a),i=f.copy_buffer(e,b,c,k,0),i<0)return i;j+=i}return j},this.lame_encode_buffer=function(a,b,c,d,e,f,g){var h=a.internal_flags,i=[null,null];if(h.Class_ID!=z)return-3;if(0==d)return 0;P(h,d),i[0]=h.in_buffer_0,i[1]=h.in_buffer_1;for(var j=0;j<d;j++)i[0][j]=b[j],h.channels_in>1&&(i[1][j]=c[j]);return S(a,i[0],i[1],d,e,f,g)}}function Z(){var a,b;this.setModules=function(c,d){a=c,b=d}}function $(){var a,b,c;this.setModules=function(d,e,f){a=d,b=e,c=f}}function _(){}function aa(){var a,b;this.setModules=function(c,d){a=c,b=d}}function ba(b,c,d){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),b=1,c=44100,d=128);var e=new Y,f=new Z,g=new u,h=new x,i=new t,j=new J,k=new N,l=new y,m=new s,n=new aa,o=new v,p=new w,q=new $,z=new _;e.setModules(g,h,i,j,k,l,m,n,z),h.setModules(g,z,m,l),n.setModules(h,m),i.setModules(e),k.setModules(h,o,j,p),j.setModules(p,o,e.enc.psy),o.setModules(h),p.setModules(j),l.setModules(e,h,m),f.setModules(q,z),q.setModules(m,n,i);var A=e.lame_init();A.num_channels=b,A.in_samplerate=c,A.brate=d,A.mode=r.STEREO,A.quality=3,A.bWriteVbrTag=!1,A.disable_reservoir=!0,A.write_id3tag_automatic=!1;var C=(e.lame_init_params(A),1152),D=0|1.25*C+7200,E=a(D);this.encodeBuffer=function(c,d){1==b&&(d=c),c.length>C&&(C=c.length,D=0|1.25*C+7200,E=a(D));var f=e.lame_encode_buffer(A,c,d,c.length,E,0,D);return new Int8Array(E.subarray(0,f))},this.flush=function(){var a=e.lame_encode_flush(A,E,0,D);return new Int8Array(E.subarray(0,a))}}function ca(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function da(a){return a.charCodeAt(0)<<24|a.charCodeAt(1)<<16|a.charCodeAt(2)<<8|a.charCodeAt(3)}var j={};j.fill=function(a,b,c,d){if(2==arguments.length)for(var e=0;e<a.length;e++)a[e]=arguments[1];else for(var e=b;e<c;e++)a[e]=d};var k={};k.arraycopy=function(a,b,c,d,e){for(var f=b+e;b<f;)c[d++]=a[b++]};var l={};l.SQRT2=1.4142135623730951,l.FAST_LOG10=function(a){return Math.log10(a)},l.FAST_LOG10_X=function(a,b){return Math.log10(a)*b},m.short_block_allowed=new m(0),m.short_block_coupled=new m(1),m.short_block_dispensed=new m(2),m.short_block_forced=new m(3);var n={};n.MAX_VALUE=3.4028235e38,o.vbr_off=new o(0),o.vbr_mt=new o(1),o.vbr_rh=new o(2),o.vbr_abr=new o(3),o.vbr_mtrh=new o(4),o.vbr_default=o.vbr_mtrh;r.STEREO=new r(0),r.JOINT_STEREO=new r(1),r.DUAL_CHANNEL=new r(2),r.MONO=new r(3),r.NOT_SET=new r(4),u.STEPS_per_dB=100,u.MAX_dB=120,u.GAIN_NOT_ENOUGH_SAMPLES=-24601,u.GAIN_ANALYSIS_ERROR=0,u.GAIN_ANALYSIS_OK=1,u.INIT_GAIN_ANALYSIS_ERROR=0,u.INIT_GAIN_ANALYSIS_OK=1,u.YULE_ORDER=10,u.MAX_ORDER=u.YULE_ORDER,u.MAX_SAMP_FREQ=48e3,u.RMS_WINDOW_TIME_NUMERATOR=1,u.RMS_WINDOW_TIME_DENOMINATOR=20,u.MAX_SAMPLES_PER_WINDOW=u.MAX_SAMP_FREQ*u.RMS_WINDOW_TIME_NUMERATOR/u.RMS_WINDOW_TIME_DENOMINATOR+1,x.EQ=function(a,b){return Math.abs(a)>Math.abs(b)?Math.abs(a-b)<=1e-6*Math.abs(a):Math.abs(a-b)<=1e-6*Math.abs(b)},x.NEQ=function(a,b){return!x.EQ(a,b)},y.NUMTOCENTRIES=100,y.MAXFRAMESIZE=2880;var A={};A.t1HB=[1,1,1,0],A.t2HB=[1,2,1,3,1,1,3,2,0],A.t3HB=[3,2,1,1,1,1,3,2,0],A.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],A.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],A.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],A.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],A.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],A.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],A.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],A.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],A.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],A.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],A.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],A.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],A.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],A.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],A.t1l=[1,4,3,5],A.t2l=[1,4,7,4,5,7,6,7,8],A.t3l=[2,3,7,4,4,7,6,7,8],A.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],A.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],A.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],A.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],A.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],A.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],A.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],A.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],A.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],A.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],A.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],A.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],A.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],A.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],A.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],A.ht=[new z(0,0,null,null),new z(2,0,A.t1HB,A.t1l),new z(3,0,A.t2HB,A.t2l),new z(3,0,A.t3HB,A.t3l),new z(0,0,null,null),new z(4,0,A.t5HB,A.t5l),new z(4,0,A.t6HB,A.t6l),new z(6,0,A.t7HB,A.t7l),new z(6,0,A.t8HB,A.t8l),new z(6,0,A.t9HB,A.t9l),new z(8,0,A.t10HB,A.t10l),new z(8,0,A.t11HB,A.t11l),new z(8,0,A.t12HB,A.t12l),new z(16,0,A.t13HB,A.t13l),new z(0,0,null,A.t16_5l),new z(16,0,A.t15HB,A.t15l),new z(1,1,A.t16HB,A.t16l),new z(2,3,A.t16HB,A.t16l),new z(3,7,A.t16HB,A.t16l),new z(4,15,A.t16HB,A.t16l),new z(6,63,A.t16HB,A.t16l),new z(8,255,A.t16HB,A.t16l),new z(10,1023,A.t16HB,A.t16l),new z(13,8191,A.t16HB,A.t16l),new z(4,15,A.t24HB,A.t24l),new z(5,31,A.t24HB,A.t24l),new z(6,63,A.t24HB,A.t24l),new z(7,127,A.t24HB,A.t24l),new z(8,255,A.t24HB,A.t24l),new z(9,511,A.t24HB,A.t24l),new z(11,2047,A.t24HB,A.t24l),new z(13,8191,A.t24HB,A.t24l),new z(0,0,A.t32HB,A.t32l),new z(0,0,A.t33HB,A.t33l)],A.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],A.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],A.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],A.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],A.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],A.scfsi_band=[0,6,11,16,21],J.Q_MAX=257,J.Q_MAX2=116,J.LARGE_BITS=1e5,J.IXMAX_VAL=8206;var M={};M.SFBMAX=3*Q.SBMAX_s,Q.ENCDELAY=576,Q.POSTDELAY=1152,Q.MDCTDELAY=48,Q.FFTOFFSET=224+Q.MDCTDELAY,Q.DECDELAY=528,Q.SBLIMIT=32,Q.CBANDS=64,Q.SBPSY_l=21,Q.SBPSY_s=12,Q.SBMAX_l=22,Q.SBMAX_s=13,Q.PSFB21=6,Q.PSFB12=6,Q.BLKSIZE=1024,Q.HBLKSIZE=Q.BLKSIZE/2+1,Q.BLKSIZE_s=256,Q.HBLKSIZE_s=Q.BLKSIZE_s/2+1,Q.NORM_TYPE=0,Q.START_TYPE=1,Q.SHORT_TYPE=2,Q.STOP_TYPE=3,Q.MPG_MD_LR_LR=0,Q.MPG_MD_LR_I=1,Q.MPG_MD_MS_LR=2,Q.MPG_MD_MS_I=3,Q.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3.898045e-17,.0467745*5,.50455,.756825,.187098*5],V.MFSIZE=3456+Q.ENCDELAY-Q.MDCTDELAY,V.MAX_HEADER_BUF=256,V.MAX_BITS_PER_CHANNEL=4095,V.MAX_BITS_PER_GRANULE=7680,V.BPC=320,ca.RIFF=da("RIFF"),ca.WAVE=da("WAVE"),ca.fmt_=da("fmt "),ca.data=da("data"),ca.readHeader=function(a){var b=new ca,c=a.getUint32(0,!1);if(ca.RIFF==c){a.getUint32(4,!0);if(ca.WAVE==a.getUint32(8,!1)&&ca.fmt_==a.getUint32(12,!1)){var e=a.getUint32(16,!0),f=20;switch(e){case 16:case 18:b.channels=a.getUint16(f+2,!0),b.sampleRate=a.getUint32(f+4,!0);break;default:throw"extended fmt chunk not implemented"}f+=e;for(var g=ca.data,h=0;g!=c&&(c=a.getUint32(f,!1),h=a.getUint32(f+4,!0),g!=c);)f+=h+8;return b.dataLen=h,b.dataOffset=f+8,b}}},M.SFBMAX=3*Q.SBMAX_s,lamejs.Mp3Encoder=ba,lamejs.WavHeader=ca}lamejs();